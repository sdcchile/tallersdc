<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 11 Caso de estudio | Guía para el Control de Divulgación Estadística en Microdatos</title>
  <meta name="description" content="Este es un documento central para el trabajo de Control a la Divulgación Estadística de Microdatos en el Instituto Nacional de Estadísticas de Chile." />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 11 Caso de estudio | Guía para el Control de Divulgación Estadística en Microdatos" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://www.ine.gob.cl/Imagenes/Logo_INE2.png" />
  <meta property="og:description" content="Este es un documento central para el trabajo de Control a la Divulgación Estadística de Microdatos en el Instituto Nacional de Estadísticas de Chile." />
  <meta name="github-repo" content="sdcchile/tallersdc/" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 11 Caso de estudio | Guía para el Control de Divulgación Estadística en Microdatos" />
  
  <meta name="twitter:description" content="Este es un documento central para el trabajo de Control a la Divulgación Estadística de Microdatos en el Instituto Nacional de Estadísticas de Chile." />
  <meta name="twitter:image" content="https://www.ine.gob.cl/Imagenes/Logo_INE2.png" />

<meta name="author" content="Subdepartamento de Investigación Estadística" />


<meta name="date" content="2024-02-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <link rel="apple-touch-icon-precomposed" sizes="120x120" href="Imagenes/Logo_INE2.png" />
  <link rel="shortcut icon" href="Imagenes/Logo_INE2.png" type="image/x-icon" />
<link rel="prev" href="proceso-control-a-la-divulgación-estadística-sdc-ine-2021.html"/>
<link rel="next" href="taller-sdc-video.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="Imagenes/Logo_INE2.png"></a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prefacio</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#autores-de-esta-guía"><i class="fa fa-check"></i><b>1.1</b> Autores de esta guía</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#reconocimientos"><i class="fa fa-check"></i><b>1.2</b> Reconocimientos</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#citar-este-documento"><i class="fa fa-check"></i><b>1.3</b> Citar este documento</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introducción.html"><a href="introducción.html"><i class="fa fa-check"></i><b>2</b> Introducción</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introducción.html"><a href="introducción.html#estableciendo-una-base-de-conocimiento"><i class="fa fa-check"></i><b>2.1</b> Estableciendo una base de conocimiento</a></li>
<li class="chapter" data-level="2.2" data-path="introducción.html"><a href="introducción.html#propósito-de-esta-guía"><i class="fa fa-check"></i><b>2.2</b> Propósito de esta guía</a></li>
<li class="chapter" data-level="2.3" data-path="introducción.html"><a href="introducción.html#esquema-de-esta-guía"><i class="fa fa-check"></i><b>2.3</b> Esquema de esta guía</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="acrónimos-y-glosario.html"><a href="acrónimos-y-glosario.html"><i class="fa fa-check"></i><b>3</b> Acrónimos y glosario</a>
<ul>
<li class="chapter" data-level="3.1" data-path="acrónimos-y-glosario.html"><a href="acrónimos-y-glosario.html#acrónimos"><i class="fa fa-check"></i><b>3.1</b> Acrónimos</a></li>
<li class="chapter" data-level="3.2" data-path="acrónimos-y-glosario.html"><a href="acrónimos-y-glosario.html#glosario"><i class="fa fa-check"></i><b>3.2</b> Glosario</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="tipos-de-liberación-de-datos.html"><a href="tipos-de-liberación-de-datos.html"><i class="fa fa-check"></i><b>4</b> Tipos de liberación de datos</a>
<ul>
<li class="chapter" data-level="4.1" data-path="tipos-de-liberación-de-datos.html"><a href="tipos-de-liberación-de-datos.html#condiciones-para-la-liberación-de-datos-bajo-versión-puf"><i class="fa fa-check"></i><b>4.1</b> Condiciones para la liberación de datos bajo versión PUF</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="proceso-sdc-una-introducción.html"><a href="proceso-sdc-una-introducción.html"><i class="fa fa-check"></i><b>5</b> Proceso SDC: Una introducción</a>
<ul>
<li class="chapter" data-level="5.1" data-path="proceso-sdc-una-introducción.html"><a href="proceso-sdc-una-introducción.html#necesidad-por-control-de-divulgación-estadística-proceso-sdc"><i class="fa fa-check"></i><b>5.1</b> Necesidad por control de divulgación estadística (proceso SDC)</a></li>
<li class="chapter" data-level="5.2" data-path="proceso-sdc-una-introducción.html"><a href="proceso-sdc-una-introducción.html#balance-riesgo-utilidad-en-el-proceso-sdc"><i class="fa fa-check"></i><b>5.2</b> Balance riesgo-utilidad en el proceso SDC</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="introducción-a-sdcmicro.html"><a href="introducción-a-sdcmicro.html"><i class="fa fa-check"></i><b>6</b> Introducción a sdcMicro</a>
<ul>
<li class="chapter" data-level="6.1" data-path="introducción-a-sdcmicro.html"><a href="introducción-a-sdcmicro.html#introducción-1"><i class="fa fa-check"></i><b>6.1</b> Introducción</a></li>
<li class="chapter" data-level="6.2" data-path="introducción-a-sdcmicro.html"><a href="introducción-a-sdcmicro.html#instalación-de-r-sdcmicro-y-otros-paquetes"><i class="fa fa-check"></i><b>6.2</b> Instalación de <code>R</code>, <code>sdcMicro</code> y otros paquetes</a></li>
<li class="chapter" data-level="6.3" data-path="introducción-a-sdcmicro.html"><a href="introducción-a-sdcmicro.html#leer-funciones-en-r"><i class="fa fa-check"></i><b>6.3</b> Leer funciones en <code>R</code></a></li>
<li class="chapter" data-level="6.4" data-path="introducción-a-sdcmicro.html"><a href="introducción-a-sdcmicro.html#valores-faltantes"><i class="fa fa-check"></i><b>6.4</b> Valores faltantes</a></li>
<li class="chapter" data-level="6.5" data-path="introducción-a-sdcmicro.html"><a href="introducción-a-sdcmicro.html#clases-en-r"><i class="fa fa-check"></i><b>6.5</b> Clases en <code>R</code></a></li>
<li class="chapter" data-level="6.6" data-path="introducción-a-sdcmicro.html"><a href="introducción-a-sdcmicro.html#objetos-de-la-clase-sdcmicroobj"><i class="fa fa-check"></i><b>6.6</b> Objetos de la clase <code>sdcMicroObj</code></a></li>
<li class="chapter" data-level="6.7" data-path="introducción-a-sdcmicro.html"><a href="introducción-a-sdcmicro.html#estructura-del-hogar"><i class="fa fa-check"></i><b>6.7</b> Estructura del hogar</a></li>
<li class="chapter" data-level="6.8" data-path="introducción-a-sdcmicro.html"><a href="introducción-a-sdcmicro.html#tiempo-de-cómputo"><i class="fa fa-check"></i><b>6.8</b> Tiempo de cómputo</a></li>
<li class="chapter" data-level="6.9" data-path="introducción-a-sdcmicro.html"><a href="introducción-a-sdcmicro.html#errores-comunes"><i class="fa fa-check"></i><b>6.9</b> Errores comunes</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="medición-de-riesgos.html"><a href="medición-de-riesgos.html"><i class="fa fa-check"></i><b>7</b> Medición de riesgos</a>
<ul>
<li class="chapter" data-level="7.1" data-path="medición-de-riesgos.html"><a href="medición-de-riesgos.html#tipos-de-divulgación"><i class="fa fa-check"></i><b>7.1</b> Tipos de divulgación</a></li>
<li class="chapter" data-level="7.2" data-path="medición-de-riesgos.html"><a href="medición-de-riesgos.html#clasificación-de-variables"><i class="fa fa-check"></i><b>7.2</b> Clasificación de variables</a></li>
<li class="chapter" data-level="7.3" data-path="medición-de-riesgos.html"><a href="medición-de-riesgos.html#escenarios-de-divulgación"><i class="fa fa-check"></i><b>7.3</b> Escenarios de divulgación</a></li>
<li class="chapter" data-level="7.4" data-path="medición-de-riesgos.html"><a href="medición-de-riesgos.html#niveles-de-riesgo"><i class="fa fa-check"></i><b>7.4</b> Niveles de riesgo</a></li>
<li class="chapter" data-level="7.5" data-path="medición-de-riesgos.html"><a href="medición-de-riesgos.html#riesgo-individual"><i class="fa fa-check"></i><b>7.5</b> Riesgo individual</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="medición-de-riesgos.html"><a href="medición-de-riesgos.html#identificadores-indirectos-categóricos-y-recuentos-de-frecuencia"><i class="fa fa-check"></i><b>7.5.1</b> Identificadores indirectos categóricos y recuentos de frecuencia</a></li>
<li class="chapter" data-level="7.5.2" data-path="medición-de-riesgos.html"><a href="medición-de-riesgos.html#k-anonimato"><i class="fa fa-check"></i><b>7.5.2</b> k-anonimato</a></li>
<li class="chapter" data-level="7.5.3" data-path="medición-de-riesgos.html"><a href="medición-de-riesgos.html#l-diversity"><i class="fa fa-check"></i><b>7.5.3</b> l-diversity</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="medición-de-riesgos.html"><a href="medición-de-riesgos.html#medidas-de-riesgo-para-variables-continuas"><i class="fa fa-check"></i><b>7.6</b> Medidas de riesgo para variables continuas</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="medición-de-riesgos.html"><a href="medición-de-riesgos.html#vinculación-de-registros-o-coincidencia-de-registros"><i class="fa fa-check"></i><b>7.6.1</b> Vinculación de registros (o coincidencia de registros)</a></li>
<li class="chapter" data-level="7.6.2" data-path="medición-de-riesgos.html"><a href="medición-de-riesgos.html#medida-de-intervalo"><i class="fa fa-check"></i><b>7.6.2</b> Medida de intervalo</a></li>
<li class="chapter" data-level="7.6.3" data-path="medición-de-riesgos.html"><a href="medición-de-riesgos.html#detección-de-valores-atípicos"><i class="fa fa-check"></i><b>7.6.3</b> Detección de valores atípicos</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="medición-de-riesgos.html"><a href="medición-de-riesgos.html#riesgo-global"><i class="fa fa-check"></i><b>7.7</b> Riesgo global</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="medición-de-riesgos.html"><a href="medición-de-riesgos.html#media-de-las-medidas-de-riesgo-individuales"><i class="fa fa-check"></i><b>7.7.1</b> Media de las medidas de riesgo individuales</a></li>
<li class="chapter" data-level="7.7.2" data-path="medición-de-riesgos.html"><a href="medición-de-riesgos.html#recuento-de-personas-con-riesgos-superiores-a-un-cierto-umbral"><i class="fa fa-check"></i><b>7.7.2</b> Recuento de personas con riesgos superiores a un cierto umbral</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="medición-de-riesgos.html"><a href="medición-de-riesgos.html#riesgo-jerárquico-o-del-hogar"><i class="fa fa-check"></i><b>7.8</b> Riesgo jerárquico (o del hogar)</a></li>
<li class="chapter" data-level="7.9" data-path="medición-de-riesgos.html"><a href="medición-de-riesgos.html#referencias"><i class="fa fa-check"></i><b>7.9</b> Referencias</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="métodos-sdc.html"><a href="métodos-sdc.html"><i class="fa fa-check"></i><b>8</b> Métodos SDC</a>
<ul>
<li class="chapter" data-level="8.1" data-path="métodos-sdc.html"><a href="métodos-sdc.html#clasificación-de-los-métodos-sdc"><i class="fa fa-check"></i><b>8.1</b> Clasificación de los métodos SDC</a></li>
<li class="chapter" data-level="8.2" data-path="métodos-sdc.html"><a href="métodos-sdc.html#métodos-no-perturbativos"><i class="fa fa-check"></i><b>8.2</b> Métodos no perturbativos</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="métodos-sdc.html"><a href="métodos-sdc.html#recodificación"><i class="fa fa-check"></i><b>8.2.1</b> Recodificación</a></li>
<li class="chapter" data-level="8.2.2" data-path="métodos-sdc.html"><a href="métodos-sdc.html#sup-loc"><i class="fa fa-check"></i><b>8.2.2</b> Supresión local</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="métodos-sdc.html"><a href="métodos-sdc.html#métodos-perturbativos"><i class="fa fa-check"></i><b>8.3</b> Métodos perturbativos</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="métodos-sdc.html"><a href="métodos-sdc.html#pram-método-de-post-aleatorización"><i class="fa fa-check"></i><b>8.3.1</b> PRAM (Método de Post-Aleatorización)</a></li>
<li class="chapter" data-level="8.3.2" data-path="métodos-sdc.html"><a href="métodos-sdc.html#microagregación"><i class="fa fa-check"></i><b>8.3.2</b> Microagregación</a></li>
<li class="chapter" data-level="8.3.3" data-path="métodos-sdc.html"><a href="métodos-sdc.html#adición-de-ruido"><i class="fa fa-check"></i><b>8.3.3</b> Adición de ruido</a></li>
<li class="chapter" data-level="8.3.4" data-path="métodos-sdc.html"><a href="métodos-sdc.html#rank-swapping-intercambio-de-rangos"><i class="fa fa-check"></i><b>8.3.4</b> Rank swapping (Intercambio de rangos)</a></li>
<li class="chapter" data-level="8.3.5" data-path="métodos-sdc.html"><a href="métodos-sdc.html#shuffling-barajado"><i class="fa fa-check"></i><b>8.3.5</b> Shuffling (Barajado)</a></li>
<li class="chapter" data-level="8.3.6" data-path="métodos-sdc.html"><a href="métodos-sdc.html#comparación-de-pram-rank-swapping-y-shuffling"><i class="fa fa-check"></i><b>8.3.6</b> Comparación de PRAM, Rank swapping y Shuffling</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="métodos-sdc.html"><a href="métodos-sdc.html#anonimización-del-identificador-indirecto-de-tamaño-del-hogar"><i class="fa fa-check"></i><b>8.4</b> Anonimización del identificador indirecto de tamaño del hogar</a></li>
<li class="chapter" data-level="8.5" data-path="métodos-sdc.html"><a href="métodos-sdc.html#resumen-de-métodos-sdc"><i class="fa fa-check"></i><b>8.5</b> Resumen de métodos SDC</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="medición-de-la-utilidad-y-la-pérdida-de-información.html"><a href="medición-de-la-utilidad-y-la-pérdida-de-información.html"><i class="fa fa-check"></i><b>9</b> Medición de la utilidad y la pérdida de información</a>
<ul>
<li class="chapter" data-level="9.1" data-path="medición-de-la-utilidad-y-la-pérdida-de-información.html"><a href="medición-de-la-utilidad-y-la-pérdida-de-información.html#medidas-generales-de-utilidad-para-variables-continuas-y-categóricas"><i class="fa fa-check"></i><b>9.1</b> Medidas generales de utilidad para variables continuas y categóricas</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="medición-de-la-utilidad-y-la-pérdida-de-información.html"><a href="medición-de-la-utilidad-y-la-pérdida-de-información.html#variables-categóricas"><i class="fa fa-check"></i><b>9.1.1</b> Variables categóricas</a></li>
<li class="chapter" data-level="9.1.2" data-path="medición-de-la-utilidad-y-la-pérdida-de-información.html"><a href="medición-de-la-utilidad-y-la-pérdida-de-información.html#variables-continuas"><i class="fa fa-check"></i><b>9.1.2</b> Variables continuas</a></li>
<li class="chapter" data-level="9.1.3" data-path="medición-de-la-utilidad-y-la-pérdida-de-información.html"><a href="medición-de-la-utilidad-y-la-pérdida-de-información.html#medidas-de-utilidad-basadas-en-las-necesidades-del-usuario-final"><i class="fa fa-check"></i><b>9.1.3</b> Medidas de utilidad basadas en las necesidades del usuario final</a></li>
<li class="chapter" data-level="9.1.4" data-path="medición-de-la-utilidad-y-la-pérdida-de-información.html"><a href="medición-de-la-utilidad-y-la-pérdida-de-información.html#regresión"><i class="fa fa-check"></i><b>9.1.4</b> Regresión</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="medición-de-la-utilidad-y-la-pérdida-de-información.html"><a href="medición-de-la-utilidad-y-la-pérdida-de-información.html#evaluación-de-la-utilidad-de-los-datos-con-la-ayuda-de-visualizaciones-de-datos-en-r"><i class="fa fa-check"></i><b>9.2</b> Evaluación de la utilidad de los datos con la ayuda de visualizaciones de datos (en <code>R</code>)</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="medición-de-la-utilidad-y-la-pérdida-de-información.html"><a href="medición-de-la-utilidad-y-la-pérdida-de-información.html#elección-de-la-medida-de-utilidad"><i class="fa fa-check"></i><b>9.2.1</b> Elección de la medida de utilidad</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="proceso-control-a-la-divulgación-estadística-sdc-ine-2021.html"><a href="proceso-control-a-la-divulgación-estadística-sdc-ine-2021.html"><i class="fa fa-check"></i><b>10</b> Proceso Control a la Divulgación Estadística (SDC) INE 2021</a>
<ul>
<li class="chapter" data-level="10.1" data-path="proceso-control-a-la-divulgación-estadística-sdc-ine-2021.html"><a href="proceso-control-a-la-divulgación-estadística-sdc-ine-2021.html#introducción-2"><i class="fa fa-check"></i><b>10.1</b> Introducción</a></li>
<li class="chapter" data-level="10.2" data-path="proceso-control-a-la-divulgación-estadística-sdc-ine-2021.html"><a href="proceso-control-a-la-divulgación-estadística-sdc-ine-2021.html#etapa-6.4.1-definiciones-previas-al-proceso-de-anonimización"><i class="fa fa-check"></i><b>10.2</b> Etapa 6.4.1: Definiciones previas al proceso de anonimización</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="proceso-control-a-la-divulgación-estadística-sdc-ine-2021.html"><a href="proceso-control-a-la-divulgación-estadística-sdc-ine-2021.html#definiciones-previas"><i class="fa fa-check"></i><b>10.2.1</b> Definiciones previas</a></li>
<li class="chapter" data-level="10.2.2" data-path="proceso-control-a-la-divulgación-estadística-sdc-ine-2021.html"><a href="proceso-control-a-la-divulgación-estadística-sdc-ine-2021.html#determinación-de-la-necesidad-de-protección-de-la-confidencialidad"><i class="fa fa-check"></i><b>10.2.2</b> Determinación de la necesidad de protección de la confidencialidad</a></li>
<li class="chapter" data-level="10.2.3" data-path="proceso-control-a-la-divulgación-estadística-sdc-ine-2021.html"><a href="proceso-control-a-la-divulgación-estadística-sdc-ine-2021.html#definición-de-las-características-de-las-bases-de-datos-a-preservar"><i class="fa fa-check"></i><b>10.2.3</b> Definición de las características de las bases de datos a preservar</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="proceso-control-a-la-divulgación-estadística-sdc-ine-2021.html"><a href="proceso-control-a-la-divulgación-estadística-sdc-ine-2021.html#etapa-6.4.2-preparación-y-exploración-de-datos"><i class="fa fa-check"></i><b>10.3</b> Etapa 6.4.2: Preparación y exploración de datos</a></li>
<li class="chapter" data-level="10.4" data-path="proceso-control-a-la-divulgación-estadística-sdc-ine-2021.html"><a href="proceso-control-a-la-divulgación-estadística-sdc-ine-2021.html#etapa-6.4.3-medición-y-evaluación-de-riesgos-de-divulgación"><i class="fa fa-check"></i><b>10.4</b> Etapa 6.4.3: Medición y evaluación de riesgos de divulgación</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="proceso-control-a-la-divulgación-estadística-sdc-ine-2021.html"><a href="proceso-control-a-la-divulgación-estadística-sdc-ine-2021.html#definición-de-escenarios-de-divulgación-y-selección-de-identificadores-indirectos-cuasi-identificadores-o-variables-clave"><i class="fa fa-check"></i><b>10.4.1</b> Definición de escenarios de divulgación y selección de identificadores indirectos (cuasi-identificadores o variables clave)</a></li>
<li class="chapter" data-level="10.4.2" data-path="proceso-control-a-la-divulgación-estadística-sdc-ine-2021.html"><a href="proceso-control-a-la-divulgación-estadística-sdc-ine-2021.html#medición-y-evaluación-de-riesgos"><i class="fa fa-check"></i><b>10.4.2</b> Medición y evaluación de riesgos</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="proceso-control-a-la-divulgación-estadística-sdc-ine-2021.html"><a href="proceso-control-a-la-divulgación-estadística-sdc-ine-2021.html#etapa-6.4.4.1-selección-y-aplicación-de-métodos-sdc"><i class="fa fa-check"></i><b>10.5</b> Etapa 6.4.4.1: Selección y aplicación de métodos SDC</a></li>
<li class="chapter" data-level="10.6" data-path="proceso-control-a-la-divulgación-estadística-sdc-ine-2021.html"><a href="proceso-control-a-la-divulgación-estadística-sdc-ine-2021.html#etapa-6.4.4.2-evaluación-de-proceso-sdc"><i class="fa fa-check"></i><b>10.6</b> Etapa 6.4.4.2: Evaluación de proceso SDC</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="proceso-control-a-la-divulgación-estadística-sdc-ine-2021.html"><a href="proceso-control-a-la-divulgación-estadística-sdc-ine-2021.html#vuelva-a-medir-el-riesgo"><i class="fa fa-check"></i><b>10.6.1</b> Vuelva a medir el riesgo</a></li>
<li class="chapter" data-level="10.6.2" data-path="proceso-control-a-la-divulgación-estadística-sdc-ine-2021.html"><a href="proceso-control-a-la-divulgación-estadística-sdc-ine-2021.html#mida-la-utilidad"><i class="fa fa-check"></i><b>10.6.2</b> Mida la utilidad</a></li>
<li class="chapter" data-level="10.6.3" data-path="proceso-control-a-la-divulgación-estadística-sdc-ine-2021.html"><a href="proceso-control-a-la-divulgación-estadística-sdc-ine-2021.html#evaluación-de-reglas-de-validación-y-consistencia"><i class="fa fa-check"></i><b>10.6.3</b> Evaluación de reglas de validación y consistencia</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="proceso-control-a-la-divulgación-estadística-sdc-ine-2021.html"><a href="proceso-control-a-la-divulgación-estadística-sdc-ine-2021.html#etapa-6.4.5-generar-reportes-y-liberar-datos"><i class="fa fa-check"></i><b>10.7</b> Etapa 6.4.5: Generar reportes y liberar datos</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="caso-de-estudio.html"><a href="caso-de-estudio.html"><i class="fa fa-check"></i><b>11</b> Caso de estudio</a>
<ul>
<li class="chapter" data-level="11.1" data-path="caso-de-estudio.html"><a href="caso-de-estudio.html#paso-uno-definiciones-previas-al-proceso-de-anonimización"><i class="fa fa-check"></i><b>11.1</b> Paso Uno: Definiciones previas al proceso de anonimización</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="caso-de-estudio.html"><a href="caso-de-estudio.html#definición-del-equipo-de-trabajo"><i class="fa fa-check"></i><b>11.1.1</b> Definición del equipo de trabajo</a></li>
<li class="chapter" data-level="11.1.2" data-path="caso-de-estudio.html"><a href="caso-de-estudio.html#insumos-yo-productos-necesarios-para-la-ejecución-del-proceso"><i class="fa fa-check"></i><b>11.1.2</b> Insumos y/o productos necesarios para la ejecución del proceso</a></li>
<li class="chapter" data-level="11.1.3" data-path="caso-de-estudio.html"><a href="caso-de-estudio.html#determinación-de-necesidades-de-protección-de-confidencialidad"><i class="fa fa-check"></i><b>11.1.3</b> Determinación de necesidades de protección de confidencialidad</a></li>
<li class="chapter" data-level="11.1.4" data-path="caso-de-estudio.html"><a href="caso-de-estudio.html#propiedades-estadísticas-a-preservar"><i class="fa fa-check"></i><b>11.1.4</b> Propiedades estadísticas a preservar</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="caso-de-estudio.html"><a href="caso-de-estudio.html#paso-dos-preparar-y-explorar-datos-originales"><i class="fa fa-check"></i><b>11.2</b> Paso Dos: Preparar y explorar datos originales</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="caso-de-estudio.html"><a href="caso-de-estudio.html#preparación-de-datos"><i class="fa fa-check"></i><b>11.2.1</b> Preparación de datos</a></li>
<li class="chapter" data-level="11.2.2" data-path="caso-de-estudio.html"><a href="caso-de-estudio.html#exploración-del-conjunto-de-datos"><i class="fa fa-check"></i><b>11.2.2</b> Exploración del conjunto de datos</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="caso-de-estudio.html"><a href="caso-de-estudio.html#paso-tres-medición-y-evaluación-del-riesgo-de-divulgación"><i class="fa fa-check"></i><b>11.3</b> Paso Tres: Medición y evaluación del riesgo de divulgación</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="caso-de-estudio.html"><a href="caso-de-estudio.html#definición-de-escenarios-de-divulgación"><i class="fa fa-check"></i><b>11.3.1</b> Definición de escenarios de divulgación</a></li>
<li class="chapter" data-level="11.3.2" data-path="caso-de-estudio.html"><a href="caso-de-estudio.html#medición-de-riesgos-de-divulgación"><i class="fa fa-check"></i><b>11.3.2</b> Medición de riesgos de divulgación</a></li>
<li class="chapter" data-level="11.3.3" data-path="caso-de-estudio.html"><a href="caso-de-estudio.html#evaluación-de-riesgos-de-divulgación"><i class="fa fa-check"></i><b>11.3.3</b> Evaluación de riesgos de divulgación</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="caso-de-estudio.html"><a href="caso-de-estudio.html#paso-cuatro-selección-y-aplicación-de-métodos-sdc"><i class="fa fa-check"></i><b>11.4</b> Paso Cuatro: Selección y aplicación de métodos SDC</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="caso-de-estudio.html"><a href="caso-de-estudio.html#primer-conjunto-de-métodos-sdc"><i class="fa fa-check"></i><b>11.4.1</b> Primer conjunto de métodos SDC</a></li>
<li class="chapter" data-level="11.4.2" data-path="caso-de-estudio.html"><a href="caso-de-estudio.html#re-medición-del-riesgo-para-primer-conjunto-de-métodos"><i class="fa fa-check"></i><b>11.4.2</b> Re-medición del riesgo para primer conjunto de métodos</a></li>
<li class="chapter" data-level="11.4.3" data-path="caso-de-estudio.html"><a href="caso-de-estudio.html#segundo-conjunto-de-métodos-sdc"><i class="fa fa-check"></i><b>11.4.3</b> Segundo conjunto de métodos SDC</a></li>
<li class="chapter" data-level="11.4.4" data-path="caso-de-estudio.html"><a href="caso-de-estudio.html#re-medición-del-riesgo-para-segundo-conjunto-de-métodos"><i class="fa fa-check"></i><b>11.4.4</b> Re-medición del riesgo para segundo conjunto de métodos</a></li>
<li class="chapter" data-level="11.4.5" data-path="caso-de-estudio.html"><a href="caso-de-estudio.html#tercer-conjunto-de-métodos-sdc"><i class="fa fa-check"></i><b>11.4.5</b> Tercer conjunto de métodos SDC</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="caso-de-estudio.html"><a href="caso-de-estudio.html#paso-cinco-evaluar-proceso-sdc"><i class="fa fa-check"></i><b>11.5</b> Paso Cinco: Evaluar proceso SDC</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="caso-de-estudio.html"><a href="caso-de-estudio.html#re-medición-del-riesgo"><i class="fa fa-check"></i><b>11.5.1</b> Re-medición del riesgo</a></li>
<li class="chapter" data-level="11.5.2" data-path="caso-de-estudio.html"><a href="caso-de-estudio.html#evaluar-proceso-sdc---volver-a-medir-utilidad"><i class="fa fa-check"></i><b>11.5.2</b> Evaluar proceso SDC - Volver a medir utilidad</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="caso-de-estudio.html"><a href="caso-de-estudio.html#paso-seis-generar-reportes-y-liberar-datos"><i class="fa fa-check"></i><b>11.6</b> Paso Seis: Generar Reportes y Liberar Datos</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="caso-de-estudio.html"><a href="caso-de-estudio.html#reportes"><i class="fa fa-check"></i><b>11.6.1</b> Reportes</a></li>
<li class="chapter" data-level="11.6.2" data-path="caso-de-estudio.html"><a href="caso-de-estudio.html#liberación-de-datos"><i class="fa fa-check"></i><b>11.6.2</b> Liberación de datos</a></li>
<li class="chapter" data-level="11.6.3" data-path="caso-de-estudio.html"><a href="caso-de-estudio.html#anexo-tablas-de-indicadores-con-desagregaciones"><i class="fa fa-check"></i><b>11.6.3</b> Anexo : Tablas de indicadores con desagregaciones</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="taller-sdc-video.html"><a href="taller-sdc-video.html"><i class="fa fa-check"></i><b>12</b> Taller SDC Video</a></li>
<li class="chapter" data-level="" data-path="referencias-1.html"><a href="referencias-1.html"><i class="fa fa-check"></i>Referencias</a></li>
<li class="divider"></li>
<li><a href="https://github.com/sdcchile/tallersdc/blob/main/" target="blank">Publicado con bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Guía para el Control de Divulgación Estadística en Microdatos</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="caso-de-estudio" class="section level1 hasAnchor" number="11">
<h1><span class="header-section-number">Capítulo 11</span> Caso de estudio<a href="caso-de-estudio.html#caso-de-estudio" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>El objetivo del siguiente proceso de anonimización es ilustrar el proceso SDC establecido en la GUÍA PARA EL CONTROL DE DIVULGACIÓN ESTADÍSTICA EN MICRODATOS propuesta por la Mesa de Anonimización INE. Los datos utilizados corresponden a una base de datos sintética que se basa en el diseño de la 17a ENUSC 2020 <span class="citation">(<a href="#ref-manualbdenusc" role="doc-biblioref">Instituto Nacional de Estadísticas de Chile 2021a</a>)</span>.</p>
<p>El proceso SDC aquí implementado pretender generar un archivo de datos PUF (del inglés, <em>Public Use File</em>), que pueda ponerse a disposición de forma pública y para cualquier usuario que lo requiera. Para ello, el proceso SDC aplicado apunta al logro de los umbrales de riesgo establecido por la GUÍA PARA EL CONTROL DE DIVULGACIÓN ESTADÍSTICA EN MICRODATOS para encuestas de hogares <span class="citation">(<a href="#ref-manualsdcine" role="doc-biblioref">Instituto Nacional de Estadísticas de Chile 2021b</a>)</span>. Simultáneamente, el ejercicio busca mantener la utilidad de los datos, intentando minimizar la intervención de los mismos para que los usuarios puedan replicar las estadísticas priorizadas por esta encuesta.</p>
<p>Los umbrales de riesgo establecidos son los siguientes:</p>
<p><strong>RIESGO GLOBAL</strong></p>
<ul>
<li>Riesgo global inferior al 10%</li>
</ul>
<p><strong>RIESGOS INDIVIDUALES</strong></p>
<ul>
<li>Hasta 20% de observaciones con riesgo individual mayor al 1%</li>
<li>Hasta 15% de observaciones con riesgo individual mayor al 5%</li>
<li>0% de observaciones con riesgo individual mayor al 25%</li>
</ul>
<p><strong>K-ANONIMATO</strong></p>
<ul>
<li>0% de observaciones violando k = 2</li>
<li>Hasta 5% de observaciones violando k = 3</li>
<li>Hasta 10% de observaciones violando k = 5</li>
</ul>
<blockquote>
<p><strong>Nota sobre el cálculo del K-ANONIMATO</strong>:
A pesar de que en el ejemplo actual se realiza el cálculo de k-anonimato con la función <code>Kanon_violations()</code>, se recomienda seguir el estándar del INE, que consiste en calcular el k-anonimato sin ponderadores utilizando el comando <code>print(sdcObject)</code>. En este contexto, ‘sdcObject’ representa el objeto sobre el cual es necesario evaluar el riesgo.</p>
</blockquote>
<p>A continuación, la guía presenta paso a paso como proceder con este conjunto de datos para lograr el cumplimiento de estos umbrales de riesgo.</p>
<div id="paso-uno-definiciones-previas-al-proceso-de-anonimización" class="section level2 hasAnchor" number="11.1">
<h2><span class="header-section-number">11.1</span> Paso Uno: Definiciones previas al proceso de anonimización<a href="caso-de-estudio.html#paso-uno-definiciones-previas-al-proceso-de-anonimización" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="definición-del-equipo-de-trabajo" class="section level3 hasAnchor" number="11.1.1">
<h3><span class="header-section-number">11.1.1</span> Definición del equipo de trabajo<a href="caso-de-estudio.html#definición-del-equipo-de-trabajo" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>En esta primera etapa, se define el equipo de trabajo, el cual debe estar compuesto al menos por un encargado temático, encargado de los criterios para la selección de variables claves y definición de escenarios, y un analista de anonimización, encargando de la implementación de la misma a través de un <em>script</em> como el aquí expuesto.</p>
</div>
<div id="insumos-yo-productos-necesarios-para-la-ejecución-del-proceso" class="section level3 hasAnchor" number="11.1.2">
<h3><span class="header-section-number">11.1.2</span> Insumos y/o productos necesarios para la ejecución del proceso<a href="caso-de-estudio.html#insumos-yo-productos-necesarios-para-la-ejecución-del-proceso" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>En esta etapa se describe la metodología del producto estadístico, la revisión temática de la base de datos, su caracterización y clasificación de variables, la infraestructura con que se cuenta para el proceso, entre otros elementos que se especifican en el documento adjunto.</p>
<div id="archivo-de-base-de-datos" class="section level4 hasAnchor" number="11.1.2.1">
<h4><span class="header-section-number">11.1.2.1</span> Archivo de Base de datos<a href="caso-de-estudio.html#archivo-de-base-de-datos" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Antes de cargar los datos, declaramos el directorio de trabajo donde se ubican los archivos con que trabajaremos.</p>
<div class="example">
<p><span id="exm:bloque1nbm" class="example"><strong>Bloque 11.1  </strong></span>Indicar el directorio de trabajo</p>
</div>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="caso-de-estudio.html#cb124-1" aria-hidden="true" tabindex="-1"></a>yourdirectory<span class="ot">&lt;-</span><span class="st">&quot;/simulacion&quot;</span> </span>
<span id="cb124-2"><a href="caso-de-estudio.html#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(yourdirectory)</span></code></pre></div>
<p>Se trabaja con la base bruta de la ENUSC, que contiene todas las variables previo a la innominación (en este caso es una base de datos sintética).</p>
<div class="example">
<p><span id="exm:bloque2nbm" class="example"><strong>Bloque 11.2  </strong></span>Indicar el nombre del archivo de datos</p>
</div>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="caso-de-estudio.html#cb125-1" aria-hidden="true" tabindex="-1"></a>fname <span class="ot">&lt;-</span> <span class="st">&quot;BD_ENUSC_SINTETICA_ETIQUETADA.sav&quot;</span></span>
<span id="cb125-2"><a href="caso-de-estudio.html#cb125-2" aria-hidden="true" tabindex="-1"></a>file <span class="ot">&lt;-</span> haven<span class="sc">::</span><span class="fu">read_sav</span>(fname)</span></code></pre></div>
</div>
<div id="caracterización-de-la-base-de-datos" class="section level4 hasAnchor" number="11.1.2.2">
<h4><span class="header-section-number">11.1.2.2</span> Caracterización de la base de datos<a href="caso-de-estudio.html#caracterización-de-la-base-de-datos" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Primero revisamos las dimensiones del archivo, es decir, cuantos registros y variables contiene. La base contiene 47.344 registros y 73 variables. Luego, revisamos el nombre de las variables contenido en la base de datos para verificar que se ajusta a la base con que se requiere trabajar.</p>
<div class="example">
<p><span id="exm:bloque3nbm" class="example"><strong>Bloque 11.3  </strong></span>Inspeccionar las dimensiones del conjunto de datos y los nombres de las columnas</p>
</div>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="caso-de-estudio.html#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(file)</span></code></pre></div>
<pre><code>## [1] 47344    73</code></pre>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="caso-de-estudio.html#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(file)</span></code></pre></div>
<pre><code>##  [1] &quot;enc_idr&quot;                  &quot;rph_ID&quot;                   &quot;enc_id&quot;                  
##  [4] &quot;enc_region&quot;               &quot;enc_rpc&quot;                  &quot;enc_distrito&quot;            
##  [7] &quot;enc_zona&quot;                 &quot;enc_manzana&quot;              &quot;enc_vivienda&quot;            
## [10] &quot;IDC&quot;                      &quot;enc_letraKish&quot;            &quot;enc_direccion&quot;           
## [13] &quot;enc_numero&quot;               &quot;enc_codfono&quot;              &quot;enc_fono&quot;                
## [16] &quot;enc_Nombre_ID&quot;            &quot;Enc_Fono_ID&quot;              &quot;Enc_Correo_ID&quot;           
## [19] &quot;enc_Nombre_K&quot;             &quot;enc_Edad_K&quot;               &quot;Enc_Fono_K&quot;              
## [22] &quot;Enc_Correo_K&quot;             &quot;FECHA&quot;                    &quot;IH_residencia_habitual&quot;  
## [25] &quot;Hora_inicio_rph&quot;          &quot;rph_numeroLinea&quot;          &quot;rph_nombrepila&quot;          
## [28] &quot;rph_parentesco&quot;           &quot;rph_dianacimiento&quot;        &quot;rph_mesnacimiento&quot;       
## [31] &quot;rph_agnonacimiento&quot;       &quot;rph_edad&quot;                 &quot;rph_sexo&quot;                
## [34] &quot;rph_idgen&quot;                &quot;Kish&quot;                     &quot;rph_pertenencia_indigena&quot;
## [37] &quot;rph_nacionalidad&quot;         &quot;rph_migracion&quot;            &quot;rph_p9&quot;                  
## [40] &quot;rph_p10&quot;                  &quot;rph_p11&quot;                  &quot;rph_p12&quot;                 
## [43] &quot;rph_p13&quot;                  &quot;rph_p14&quot;                  &quot;Hora_termino_rph&quot;        
## [46] &quot;P17&quot;                      &quot;P24&quot;                      &quot;A1_1_1&quot;                  
## [49] &quot;A1_1_1_N_Veces&quot;           &quot;B1_1_1&quot;                   &quot;B1_1_1_N_Veces&quot;          
## [52] &quot;C1_1_1&quot;                   &quot;C1_1_1_N_Veces&quot;           &quot;D1_1_1&quot;                  
## [55] &quot;D1_1_1_N_Veces&quot;           &quot;E1_1_1&quot;                   &quot;E1_1_1_N_Veces&quot;          
## [58] &quot;F1_1_1&quot;                   &quot;G1_1_1&quot;                   &quot;G1_1_1_N_Veces&quot;          
## [61] &quot;H1_1_1&quot;                   &quot;H1_1_1_N_Veces&quot;           &quot;VA_DC&quot;                   
## [64] &quot;VP_DC&quot;                    &quot;DEN_AGREG&quot;                &quot;RVA_DC&quot;                  
## [67] &quot;Hora_inicio_cc&quot;           &quot;Hora_termino_cc&quot;          &quot;Fact_Pers&quot;               
## [70] &quot;Fact_Hog&quot;                 &quot;VarStrat&quot;                 &quot;Conglomerado&quot;            
## [73] &quot;Fact_Ind&quot;</code></pre>
<p>Es importante señalar que la base de datos se compone de variables de caracterización de los hogares y las personas (módulo de Registro de Personas en el Hogar o RPH) y variables temáticas de la encuesta referidas a percepción de inseguridad y victimización.</p>
<p>Adicionalmente, la base de datos contiene pesos muestrales, que deben ser considerados durante la anonimización. Para el nivel hogar se utiliza Fact_Hog, mientras que para el nivel persona se utiliza Fact_Ind.</p>
<p>Además, la base de datos cuenta con variables de Conglomerado y VarStrat, que serán utilizadas para declarar el diseño complejo y evaluar la utilidad de los datos antes y después del tratamiento de los mismos.</p>
<p>El archivo <code>Diccionario de Variables.xlsx</code> contiene la descripción de las variables contenidas en la base de datos.</p>
</div>
<div id="clasificación-de-variables-1" class="section level4 hasAnchor" number="11.1.2.3">
<h4><span class="header-section-number">11.1.2.3</span> Clasificación de variables<a href="caso-de-estudio.html#clasificación-de-variables-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Las potenciales variables clave, que podría permitir una re-identificación, se ubican en el módulo de Registro de Personas en el Hogar (RPH), ya que permiten dar cuenta de atributos de las personas y hogares, como también en la portada de la encuesta, donde se encuentran las variables de ubicación geográfica. Estas últimas coinciden en parte con la base de datos de Hoja de Ruta, no obstante esta base no se publica.</p>
</div>
<div id="librerías-requeridas" class="section level4 hasAnchor" number="11.1.2.4">
<h4><span class="header-section-number">11.1.2.4</span> Librerías requeridas<a href="caso-de-estudio.html#librerías-requeridas" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Se cargan las librerías requeridas para el proceso. En caso de que no estén instaladas, deberá instalarlas con la función <code>install.packages()</code> como se muestra en el siguiente ejemplo:</p>
<div class="example">
<p><span id="exm:bloque4nbm" class="example"><strong>Bloque 11.4  </strong></span>Ejemplo de instalación de librería</p>
</div>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="caso-de-estudio.html#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;nombre_libreria&quot;</span>) </span></code></pre></div>
<p>Luego, cargamos las librerías:</p>
<div class="example">
<p><span id="exm:bloque5nbm" class="example"><strong>Bloque 11.5  </strong></span>Cargar librerías</p>
</div>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="caso-de-estudio.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sdcMicro)  <span class="co"># paquete sdcMicro con funciones para el proceso SDC</span></span>
<span id="cb131-2"><a href="caso-de-estudio.html#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survey)    <span class="co"># para diseño complejo</span></span>
<span id="cb131-3"><a href="caso-de-estudio.html#cb131-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(calidad)   <span class="co"># evaluación de calidad de las estimaciones</span></span>
<span id="cb131-4"><a href="caso-de-estudio.html#cb131-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># herramientas para manipulación de datos</span></span>
<span id="cb131-5"><a href="caso-de-estudio.html#cb131-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openxlsx)  <span class="co"># lectura/escritura de archivos xlsx</span></span>
<span id="cb131-6"><a href="caso-de-estudio.html#cb131-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr) <span class="co"># procesamiento de textos</span></span></code></pre></div>
</div>
</div>
<div id="determinación-de-necesidades-de-protección-de-confidencialidad" class="section level3 hasAnchor" number="11.1.3">
<h3><span class="header-section-number">11.1.3</span> Determinación de necesidades de protección de confidencialidad<a href="caso-de-estudio.html#determinación-de-necesidades-de-protección-de-confidencialidad" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>En esta actividad se describen el marco normativo y convenios a tener en cuenta para la anonimización, las unidades estadísticas contenidas en la base de datos, las variables sensibles contenidas en la base de datos, y el diagnóstico de necesidad de protección de confidencialidad.</p>
<div id="unidades-estadísticas" class="section level4 hasAnchor" number="11.1.3.1">
<h4><span class="header-section-number">11.1.3.1</span> Unidades estadísticas<a href="caso-de-estudio.html#unidades-estadísticas" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Se verifica la cantidad de viviendas y de personas registradas en la base de datos. Para ello, se mide la cantidad de valores únicos del folio de viviendas (<code>enc_idr</code>) y el folio de personas (<code>rph_ID</code>).</p>
<p><strong>Viviendas:</strong> 18.766
<strong>Personas:</strong> 47.344</p>
<div class="example">
<p><span id="exm:bloque6nbm" class="example"><strong>Bloque 11.6  </strong></span>Contar la cantidad de folios a nivel de viviendas y personas</p>
</div>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="caso-de-estudio.html#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(file<span class="sc">$</span>enc_idr))</span></code></pre></div>
<pre><code>## [1] 18766</code></pre>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="caso-de-estudio.html#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(file<span class="sc">$</span>rph_ID))</span></code></pre></div>
<pre><code>## [1] 47344</code></pre>
<p>De este modo, se da cuenta de la cantidad de unidades estadísticas y de la estructura jerárquica de la base de datos.</p>
</div>
<div id="variables-sensibles" class="section level4 hasAnchor" number="11.1.3.2">
<h4><span class="header-section-number">11.1.3.2</span> variables sensibles<a href="caso-de-estudio.html#variables-sensibles" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Se establecen como variables sensibles aquellas referidas a la tenencia de armas (P17), a elementos de seguridad en la vivienda (P24), y acerca de denuncia de delitos (DEN_AGREG).</p>
<div class="example">
<p><span id="exm:bloque7nbm" class="example"><strong>Bloque 11.7  </strong></span>Guardar variables sensibles en un vector de texto</p>
</div>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="caso-de-estudio.html#cb136-1" aria-hidden="true" tabindex="-1"></a>sensibles <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;P17&#39;</span>,</span>
<span id="cb136-2"><a href="caso-de-estudio.html#cb136-2" aria-hidden="true" tabindex="-1"></a>               <span class="st">&#39;P24&#39;</span>,</span>
<span id="cb136-3"><a href="caso-de-estudio.html#cb136-3" aria-hidden="true" tabindex="-1"></a>               <span class="st">&#39;DEN_AGREG&#39;</span>)</span></code></pre></div>
<p>Se verifica que las variables sensibles están presentes en la base de datos. Se espera que esta función devuelva el valor <em>TRUE</em>.</p>
<div class="example">
<p><span id="exm:bloque8nbm" class="example"><strong>Bloque 11.8  </strong></span>Verificar presencia de variables sensibles</p>
</div>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="caso-de-estudio.html#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(sensibles <span class="sc">%in%</span> <span class="fu">names</span>(file))</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="diagnóstico-de-necesidad-de-protección-de-confidencialidad" class="section level4 hasAnchor" number="11.1.3.3">
<h4><span class="header-section-number">11.1.3.3</span> Diagnóstico de necesidad de protección de confidencialidad<a href="caso-de-estudio.html#diagnóstico-de-necesidad-de-protección-de-confidencialidad" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Dado que las variables sensibles se encuentran presentes en el archivo de datos, corresponde aplicar el proceso SDC para asegurar la anonimización de los datos.</p>
</div>
</div>
<div id="propiedades-estadísticas-a-preservar" class="section level3 hasAnchor" number="11.1.4">
<h3><span class="header-section-number">11.1.4</span> Propiedades estadísticas a preservar<a href="caso-de-estudio.html#propiedades-estadísticas-a-preservar" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="usos-claves-de-los-datos" class="section level4 hasAnchor" number="11.1.4.1">
<h4><span class="header-section-number">11.1.4.1</span> Usos claves de los datos<a href="caso-de-estudio.html#usos-claves-de-los-datos" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Se espera que los datos mantengan las siguientes propiedades:</p>
<ul>
<li><p>Se debe poder reproducir los indicadores principales de la encuesta con precisión, por lo que idealmente no deben modificarse, con un máximo de diferencia en la estimación no mayor a un punto porcentual (diferencia en términos absolutos, dado que las estimaciones de ENUSC son de proporción).</p></li>
<li><p>Además, se deben mantener las variables de desagregación de tabulados de la encuesta, siendo estas sexo y región. Es decir, no deben observarse valores perdidos en estas variables.</p></li>
</ul>
<p>Dado que las variables temáticas no corresponden a potenciales variables clave, se descuenta la posibilidad de modificar dichas variables, asegurando mantener sus propiedades estadísticas.</p>
<p>Por ende, el foco debe estar en mantener las relaciones entre las variables de desagregación que podrían ser modificadas como sexo y región, y las variables de los indicadores principales.</p>
<p>Un dato frecuentemente solicitado por transparencia es la variable comuna. Si bien el diseño muestral de ENUSC no permite realizar estimaciones a ese nivel de desagregación, esta variable es de todos modos de interés para los usuarios para análisis a nivel descriptivo y referencial. En este sentido, es pertinente evaluar la posibilidad de mantener esta variable en la base de datos anonimizada.</p>
<p>Por otro lado, la variable de edad en versiones anteriores de la ENUSC se publicaba con todos los valores de la variable (semi-continua), siendo ahora publicada como tramos etarios. Dado que usuarios del mundo académico y otros investigadores dan uso a esta variable, es también de interés analizar la posibilidad de mantenerla como semi-continua</p>
</div>
<div id="indicadores-priorizados" class="section level4 hasAnchor" number="11.1.4.2">
<h4><span class="header-section-number">11.1.4.2</span> Indicadores priorizados<a href="caso-de-estudio.html#indicadores-priorizados" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Los indicadores priorizados corresponden a:</p>
<p><strong>Victimización Agregada de Delitos Consumados</strong>
Calculado en base a la variable VA_DC, por lo que la base de datos anonimizada debe permitir calcular este indicador a nivel nacional y regional (corresponde a hogares, por lo que no es desagregable por sexo).</p>
<p><strong>Victimización Personal de Delitos Consumados</strong>
Calculado en base a la variable VP_DC, por lo que la base de datos anonimizada debe permitir calcular este indicador a nivel nacional, regional y según sexo.</p>
<p>Finalmente, dado que la variable de edad es de interés para el análisis de cómo distintos grupos etarios se ven afectados por la delincuencia, es de interés que la relación entre la variable de edad y la variable de victimización personal se mantenga. Esto se evaluará a través de un modelo de regresión logística simple.</p>
</div>
<div id="medición-de-utilidad" class="section level4 hasAnchor" number="11.1.4.3">
<h4><span class="header-section-number">11.1.4.3</span> Medición de utilidad<a href="caso-de-estudio.html#medición-de-utilidad" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="reproducción-de-estimaciones-y-desagregaciones" class="section level5 hasAnchor" number="11.1.4.3.1">
<h5><span class="header-section-number">11.1.4.3.1</span> Reproducción de estimaciones y desagregaciones<a href="caso-de-estudio.html#reproducción-de-estimaciones-y-desagregaciones" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Dado que las variables de sexo, región y de los indicadores principales no serán modificadas se espera que estas mantengan las propiedades estadísticas de la base de datos original o no tratada con la mayor fidelidad posible. Partiendo del supuesto de que estas variables no serán modificadas, sino que el proceso SDC se aplicará sobre otras variables (principalmente otras variables del RPH), solo podría verse alteradas las estimaciones en caso de supresión de registros.</p>
<p>En este sentido, se espera que las estimaciones no difieran de la estimación original en más de un punto porcentual, en tanto diferencia en términos absolutos (todos los indicadores de ENUSC son de proporción).</p>
<p>A continuación, se presentan las estimaciones de la ENUSC utilizando el paquete de calidad de las estimaciones desarrollado en el INE, ya que también se espera que se mantengan los estándares de calidad de las estimaciones.</p>
<p>Ahora, se trabaja con un conjunto que contiene solo a los informantes que respondieron la encuesta (<em>file_kish</em>), descartando al resto de los integrantes del hogar. Esto es un paso necesario para poder declarar el diseño complejo de la encuesta.</p>
<p>Se establece el diseño complejo para personas y para hogares:</p>
<div class="example">
<p><span id="exm:bloque9nbm" class="example"><strong>Bloque 11.9  </strong></span>Declarar el diseño complejo</p>
</div>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="caso-de-estudio.html#cb139-1" aria-hidden="true" tabindex="-1"></a>file_kish <span class="ot">&lt;-</span> file[file<span class="sc">$</span>Kish  <span class="sc">%in%</span> <span class="dv">1</span>,]</span>
<span id="cb139-2"><a href="caso-de-estudio.html#cb139-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-3"><a href="caso-de-estudio.html#cb139-3" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">survey.lonely.psu =</span> <span class="st">&quot;certainty&quot;</span>)</span>
<span id="cb139-4"><a href="caso-de-estudio.html#cb139-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-5"><a href="caso-de-estudio.html#cb139-5" aria-hidden="true" tabindex="-1"></a>dc_pers <span class="ot">&lt;-</span> <span class="fu">svydesign</span>(<span class="at">ids =</span> <span class="sc">~</span>Conglomerado, </span>
<span id="cb139-6"><a href="caso-de-estudio.html#cb139-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">strata =</span> <span class="sc">~</span>VarStrat, </span>
<span id="cb139-7"><a href="caso-de-estudio.html#cb139-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> file_kish,</span>
<span id="cb139-8"><a href="caso-de-estudio.html#cb139-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">weights =</span> <span class="sc">~</span>Fact_Pers)</span>
<span id="cb139-9"><a href="caso-de-estudio.html#cb139-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-10"><a href="caso-de-estudio.html#cb139-10" aria-hidden="true" tabindex="-1"></a>dc_hog <span class="ot">&lt;-</span> <span class="fu">svydesign</span>(<span class="at">ids =</span> <span class="sc">~</span>Conglomerado, </span>
<span id="cb139-11"><a href="caso-de-estudio.html#cb139-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">strata =</span> <span class="sc">~</span>VarStrat, </span>
<span id="cb139-12"><a href="caso-de-estudio.html#cb139-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> file_kish,</span>
<span id="cb139-13"><a href="caso-de-estudio.html#cb139-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">weights =</span> <span class="sc">~</span>Fact_Hog)</span></code></pre></div>
<p>Luego, realizamos las estimaciones desagregadas por región y sexo, guardando las tablas para posterior evaluación de la utilidad de los datos.</p>
<p>Victimización agregada de delitos consumados, desagregado por región:</p>
<div class="example">
<p><span id="exm:bloque10nbm" class="example"><strong>Bloque 11.10  </strong></span>Estimar Victimización Agregada a nivel regional, con estandar de calidad INE</p>
</div>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="caso-de-estudio.html#cb140-1" aria-hidden="true" tabindex="-1"></a>insumos_prop <span class="ot">&lt;-</span> <span class="fu">create_prop</span>(<span class="at">var =</span> <span class="st">&#39;VA_DC&#39;</span>, </span>
<span id="cb140-2"><a href="caso-de-estudio.html#cb140-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">domains =</span> <span class="st">&#39;enc_region&#39;</span>, </span>
<span id="cb140-3"><a href="caso-de-estudio.html#cb140-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">design =</span>  dc_hog)</span>
<span id="cb140-4"><a href="caso-de-estudio.html#cb140-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-5"><a href="caso-de-estudio.html#cb140-5" aria-hidden="true" tabindex="-1"></a>VA_DC_REG_PRE <span class="ot">&lt;-</span> <span class="fu">assess</span>(insumos_prop)</span>
<span id="cb140-6"><a href="caso-de-estudio.html#cb140-6" aria-hidden="true" tabindex="-1"></a>VA_DC_REG_PRE[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]</span></code></pre></div>
<pre><code>##    enc_region      stat         se   df    n         cv
## 1           1 0.5180939 0.01656239 1117 1283 0.03196793
## 2           2 0.4986086 0.02015781  701  834 0.04042813
## 3           3 0.5025207 0.01687235 1048 1224 0.03357544
## 4           4 0.5096128 0.01963187  763  892 0.03852312
## 5           5 0.5046148 0.01265927 1821 2106 0.02508700
## 6           6 0.4937284 0.01719661 1017 1169 0.03483011
## 7           7 0.5193102 0.01797112  920 1067 0.03460576
## 8           8 0.5170244 0.01427234 1474 1724 0.02760477
## 9           9 0.5070849 0.01951509  753  889 0.03848486
## 10         10 0.5261810 0.01672262 1085 1251 0.03178111
## 11         11 0.5240267 0.01849898  903 1066 0.03530160
## 12         12 0.5167737 0.01889486  796  932 0.03656313
## 13         13 0.5084057 0.02151621  604  731 0.04232094
## 14         14 0.5096388 0.01751652  975 1135 0.03437047
## 15         15 0.5026934 0.01590767 1191 1365 0.03164488
## 16         16 0.4899313 0.01751388  929 1098 0.03574763</code></pre>
<p>Victimización personal de delitos consumados, desagregado por sexo:</p>
<div class="example">
<p><span id="exm:bloque11nbm" class="example"><strong>Bloque 11.11  </strong></span>Estimar Victimización Personal según sexo, con estandar de calidad INE</p>
</div>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="caso-de-estudio.html#cb142-1" aria-hidden="true" tabindex="-1"></a>insumos_prop <span class="ot">&lt;-</span> <span class="fu">create_prop</span>(<span class="at">var =</span> <span class="st">&#39;VP_DC&#39;</span>, </span>
<span id="cb142-2"><a href="caso-de-estudio.html#cb142-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">domains =</span> <span class="st">&#39;rph_sexo&#39;</span>, </span>
<span id="cb142-3"><a href="caso-de-estudio.html#cb142-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">design =</span>  dc_pers</span>
<span id="cb142-4"><a href="caso-de-estudio.html#cb142-4" aria-hidden="true" tabindex="-1"></a>                                )</span>
<span id="cb142-5"><a href="caso-de-estudio.html#cb142-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-6"><a href="caso-de-estudio.html#cb142-6" aria-hidden="true" tabindex="-1"></a>VP_DC_SEXO_PRE <span class="ot">&lt;-</span> <span class="fu">assess</span>(insumos_prop)</span>
<span id="cb142-7"><a href="caso-de-estudio.html#cb142-7" aria-hidden="true" tabindex="-1"></a>VP_DC_SEXO_PRE[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]</span></code></pre></div>
<pre><code>##   rph_sexo      stat          se   df    n         cv
## 1        1 0.2526373 0.005327597 6721 9439 0.02108793
## 2        2 0.2447268 0.005269227 6590 9327 0.02153106</code></pre>
<p>Victimización personal de delitos consumados, desagregado por región:</p>
<div class="example">
<p><span id="exm:bloque12nbm" class="example"><strong>Bloque 11.12  </strong></span>Estimar Victimización Personal a nivel regional, con estandar de calidad INE</p>
</div>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="caso-de-estudio.html#cb144-1" aria-hidden="true" tabindex="-1"></a>insumos_prop <span class="ot">&lt;-</span> <span class="fu">create_prop</span>(<span class="at">var =</span> <span class="st">&#39;VP_DC&#39;</span>, </span>
<span id="cb144-2"><a href="caso-de-estudio.html#cb144-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">domains =</span> <span class="st">&#39;enc_region&#39;</span>, </span>
<span id="cb144-3"><a href="caso-de-estudio.html#cb144-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">design =</span>  dc_pers)</span>
<span id="cb144-4"><a href="caso-de-estudio.html#cb144-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-5"><a href="caso-de-estudio.html#cb144-5" aria-hidden="true" tabindex="-1"></a>VP_DC_REG_PRE <span class="ot">&lt;-</span> <span class="fu">assess</span>(insumos_prop)</span>
<span id="cb144-6"><a href="caso-de-estudio.html#cb144-6" aria-hidden="true" tabindex="-1"></a>VP_DC_REG_PRE[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]</span></code></pre></div>
<pre><code>##    enc_region      stat         se   df    n         cv
## 1           1 0.2568172 0.01420410 1117 1283 0.05530824
## 2           2 0.2313854 0.01700058  701  834 0.07347300
## 3           3 0.2379758 0.01447234 1048 1224 0.06081436
## 4           4 0.2475154 0.01704076  763  892 0.06884725
## 5           5 0.2422258 0.01087581 1821 2106 0.04489945
## 6           6 0.2521763 0.01503618 1017 1169 0.05962565
## 7           7 0.2685464 0.01612499  920 1067 0.06004546
## 8           8 0.2611829 0.01250193 1474 1724 0.04786657
## 9           9 0.2412502 0.01739434  753  889 0.07210085
## 10         10 0.2361271 0.01413669 1085 1251 0.05986900
## 11         11 0.2773473 0.01612302  903 1066 0.05813297
## 12         12 0.2396374 0.01618739  796  932 0.06754952
## 13         13 0.2462710 0.01884833  604  731 0.07653493
## 14         14 0.2527983 0.01529804  975 1135 0.06051481
## 15         15 0.2404411 0.01327941 1191 1365 0.05522937
## 16         16 0.2431671 0.01512454  929 1098 0.06219815</code></pre>
<p>Victimización personal de delitos consumados, desagregado por sexo y región:</p>
<div class="example">
<p><span id="exm:bloque13nbm" class="example"><strong>Bloque 11.13  </strong></span>Estimar Victimización Personal a nivel regional y según sexo, con estandar de calidad INE</p>
</div>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="caso-de-estudio.html#cb146-1" aria-hidden="true" tabindex="-1"></a>insumos_prop <span class="ot">&lt;-</span> <span class="fu">create_prop</span>(<span class="at">var =</span> <span class="st">&#39;VP_DC&#39;</span>, </span>
<span id="cb146-2"><a href="caso-de-estudio.html#cb146-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">domains =</span> <span class="st">&#39;rph_sexo+enc_region&#39;</span>, </span>
<span id="cb146-3"><a href="caso-de-estudio.html#cb146-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">design =</span>  dc_pers)</span>
<span id="cb146-4"><a href="caso-de-estudio.html#cb146-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-5"><a href="caso-de-estudio.html#cb146-5" aria-hidden="true" tabindex="-1"></a>VP_DC_REG_SEXO_PRE <span class="ot">&lt;-</span> <span class="fu">assess</span>(insumos_prop)</span>
<span id="cb146-6"><a href="caso-de-estudio.html#cb146-6" aria-hidden="true" tabindex="-1"></a>VP_DC_REG_SEXO_PRE[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]</span></code></pre></div>
<pre><code>##    rph_sexo enc_region      stat         se  df    n
## 1         1          1 0.2612492 0.01993875 541  660
## 2         2          1 0.2522270 0.02020040 508  623
## 3         1          2 0.2138315 0.02274576 317  428
## 4         2          2 0.2493531 0.02527904 304  406
## 5         1          3 0.2392046 0.02068420 485  600
## 6         2          3 0.2367133 0.02041682 501  624
## 7         1          4 0.2571475 0.02439808 340  440
## 8         2          4 0.2388935 0.02367246 342  452
## 9         1          5 0.2582590 0.01563089 921 1067
## 10        2          5 0.2261775 0.01500918 889 1039
## 11        1          6 0.2557568 0.02147664 472  582
## 12        2          6 0.2486357 0.02088754 469  587
## 13        1          7 0.2751938 0.02324332 429  540
## 14        2          7 0.2616656 0.02226621 412  527
## 15        1          8 0.2826785 0.01822327 688  829
## 16        2          8 0.2408143 0.01715973 746  895
## 17        1          9 0.2479841 0.02381286 359  467
## 18        2          9 0.2333432 0.02543398 316  422
## 19        1         10 0.2458082 0.01995371 521  639
## 20        2         10 0.2262334 0.01988504 492  612
## 21        1         11 0.2660547 0.02254731 422  531
## 22        2         11 0.2894683 0.02341303 418  535
## 23        1         12 0.2383125 0.02254203 365  475
## 24        2         12 0.2410698 0.02307637 352  457
## 25        1         13 0.2515748 0.02693269 252  356
## 26        2         13 0.2411737 0.02646547 273  375
## 27        1         14 0.2533536 0.02087620 490  598
## 28        2         14 0.2521585 0.02282616 414  537
## 29        1         15 0.2408291 0.01870310 565  686
## 30        2         15 0.2400561 0.01891161 562  679
## 31        1         16 0.2262722 0.02063687 425  541
## 32        2         16 0.2592696 0.02167361 442  557</code></pre>
<p>Se espera que la base de datos anonimizada mantenga las propiedades aquí expuestas, por lo que se almacenan en objetos para su posterior comparación con los datos tratados.</p>
<p>Por otro lado, dado que queremos mantener la utilidad de los datos en relación con edad, se mide la relación entre la variable edad y la variable VP_DC, lo cual se debería mantener en caso que se deba recodificar la edad en tramos.</p>
</div>
<div id="relación-entre-variable-de-edad-y-victimización-personal" class="section level5 hasAnchor" number="11.1.4.3.2">
<h5><span class="header-section-number">11.1.4.3.2</span> Relación entre variable de edad y victimización personal<a href="caso-de-estudio.html#relación-entre-variable-de-edad-y-victimización-personal" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Se genera un modelo <em>logit</em> con la variable de Victimización Personal como dependiente y con la variable de edad como regresor. Se espera que los resultados aquí obtenidos sean similares con los datos tratados, lo que se evaluará al final del proceso de anonimización.</p>
<p><strong>Carga de datos</strong></p>
<p>Primero, se cargan los datos, y se filtran dejando solo al informante Kish.</p>
<div class="example">
<p><span id="exm:bloque14nbm" class="example"><strong>Bloque 11.14  </strong></span>Generar dataframe para modelo</p>
</div>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="caso-de-estudio.html#cb148-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> file[file<span class="sc">$</span>Kish <span class="sc">%in%</span> <span class="dv">1</span>,]</span></code></pre></div>
<p><strong>Dividir datos en <em>training</em> y <em>testing</em> sets</strong></p>
<p>Luego, se dividen los datos en sets de training y testing.</p>
<div class="example">
<p><span id="exm:bloque15nbm" class="example"><strong>Bloque 11.15  </strong></span>Dividir datos en <em>training</em> y <em>testing</em> sets</p>
</div>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="caso-de-estudio.html#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caTools)</span>
<span id="cb149-2"><a href="caso-de-estudio.html#cb149-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2022</span>)</span>
<span id="cb149-3"><a href="caso-de-estudio.html#cb149-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-4"><a href="caso-de-estudio.html#cb149-4" aria-hidden="true" tabindex="-1"></a>ids_train <span class="ot">&lt;-</span> <span class="fu">sample</span>(data<span class="sc">$</span>rph_ID, <span class="fu">nrow</span>(data)<span class="sc">/</span><span class="dv">3</span><span class="sc">*</span><span class="dv">2</span>)</span>
<span id="cb149-5"><a href="caso-de-estudio.html#cb149-5" aria-hidden="true" tabindex="-1"></a>training<span class="ot">&lt;-</span> sjlabelled<span class="sc">::</span><span class="fu">remove_all_labels</span>(data[data<span class="sc">$</span>rph_ID <span class="sc">%in%</span> ids_train,])</span>
<span id="cb149-6"><a href="caso-de-estudio.html#cb149-6" aria-hidden="true" tabindex="-1"></a>testing<span class="ot">&lt;-</span> sjlabelled<span class="sc">::</span><span class="fu">remove_all_labels</span>(data[<span class="sc">!</span>data<span class="sc">$</span>rph_ID <span class="sc">%in%</span> ids_train,])</span></code></pre></div>
<p><strong>Construir modelo</strong></p>
<p>Luego, construimos el modelo utilizando la función <code>glm()</code>.</p>
<div class="example">
<p><span id="exm:bloque16nbm" class="example"><strong>Bloque 11.16  </strong></span>Construir modelo</p>
</div>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="caso-de-estudio.html#cb150-1" aria-hidden="true" tabindex="-1"></a>modelo<span class="ot">&lt;-</span><span class="fu">glm</span>(VP_DC<span class="sc">~</span>rph_edad, </span>
<span id="cb150-2"><a href="caso-de-estudio.html#cb150-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">data=</span>training, </span>
<span id="cb150-3"><a href="caso-de-estudio.html#cb150-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb150-4"><a href="caso-de-estudio.html#cb150-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = VP_DC ~ rph_edad, family = &quot;binomial&quot;, data = training)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -0.8025  -0.7661  -0.7320  -0.6980   1.7502  
## 
## Coefficients:
##               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -1.3401916  0.0525124  -25.52  &lt; 2e-16 ***
## rph_edad     0.0034786  0.0007714    4.51  6.5e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 13933  on 12509  degrees of freedom
## Residual deviance: 13912  on 12508  degrees of freedom
## AIC: 13916
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p><strong>Validación de modelo</strong></p>
<p>Luego aplicamos el test de Hosmer Lemeshow para validar el modelo.</p>
<div class="example">
<p><span id="exm:bloque17nbm" class="example"><strong>Bloque 11.17  </strong></span>Validación de modelo</p>
</div>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="caso-de-estudio.html#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ResourceSelection)</span></code></pre></div>
<pre><code>## ResourceSelection 0.3-6   2023-06-27</code></pre>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="caso-de-estudio.html#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hoslem.test</span>(modelo<span class="sc">$</span>y,<span class="fu">fitted</span>(modelo),<span class="at">g=</span><span class="dv">10</span>) <span class="co"># Test de Hosmer Lemeshow</span></span></code></pre></div>
<pre><code>## 
##  Hosmer and Lemeshow goodness of fit (GOF) test
## 
## data:  modelo$y, fitted(modelo)
## X-squared = 255.13, df = 8, p-value &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="caso-de-estudio.html#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span></code></pre></div>
<pre><code>## Type &#39;citation(&quot;pROC&quot;)&#39; for a citation.</code></pre>
<pre><code>## 
## Attaching package: &#39;pROC&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     cov, smooth, var</code></pre>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="caso-de-estudio.html#cb160-1" aria-hidden="true" tabindex="-1"></a>indiceC.trainig<span class="ot">&lt;-</span><span class="fu">roc</span>(modelo<span class="sc">$</span>y,<span class="fu">fitted</span>(modelo))     <span class="co"># Curva ROC</span></span></code></pre></div>
<pre><code>## Setting levels: control = 0, case = 1</code></pre>
<pre><code>## Setting direction: controls &lt; cases</code></pre>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="caso-de-estudio.html#cb163-1" aria-hidden="true" tabindex="-1"></a>indiceC.trainig</span></code></pre></div>
<pre><code>## 
## Call:
## roc.default(response = modelo$y, predictor = fitted(modelo))
## 
## Data: fitted(modelo) in 9444 controls (modelo$y 0) &lt; 3066 cases (modelo$y 1).
## Area under the curve: 0.5272</code></pre>
<p><strong>Punto de corte óptimo</strong></p>
<p>Se calcula el punto de corte óptimo utilizando la función <code>coords()</code>.</p>
<div class="example">
<p><span id="exm:bloque18nbm" class="example"><strong>Bloque 11.18  </strong></span>Calcular punto de corte óptimo</p>
</div>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="caso-de-estudio.html#cb165-1" aria-hidden="true" tabindex="-1"></a>ptocorteop.training<span class="ot">&lt;-</span><span class="fu">coords</span>(indiceC.trainig,<span class="at">x=</span><span class="st">&quot;best&quot;</span>,</span>
<span id="cb165-2"><a href="caso-de-estudio.html#cb165-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">input=</span><span class="st">&quot;threshold&quot;</span>,</span>
<span id="cb165-3"><a href="caso-de-estudio.html#cb165-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">best.method=</span><span class="st">&quot;youden&quot;</span>)</span>
<span id="cb165-4"><a href="caso-de-estudio.html#cb165-4" aria-hidden="true" tabindex="-1"></a>ptocorteop.training</span></code></pre></div>
<pre><code>##   threshold specificity sensitivity
## 1  0.270795   0.9431385   0.1457926</code></pre>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="caso-de-estudio.html#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ROCR)</span>
<span id="cb167-2"><a href="caso-de-estudio.html#cb167-2" aria-hidden="true" tabindex="-1"></a>ROC.training<span class="ot">&lt;-</span><span class="fu">performance</span>(<span class="at">prediction.obj =</span> <span class="fu">prediction</span>(<span class="at">predictions =</span> <span class="fu">fitted</span>(modelo),</span>
<span id="cb167-3"><a href="caso-de-estudio.html#cb167-3" aria-hidden="true" tabindex="-1"></a>                                                      <span class="at">labels =</span> <span class="fu">as.factor</span>(modelo<span class="sc">$</span>y)),</span>
<span id="cb167-4"><a href="caso-de-estudio.html#cb167-4" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;tpr&quot;</span>,</span>
<span id="cb167-5"><a href="caso-de-estudio.html#cb167-5" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;fpr&quot;</span>)</span></code></pre></div>
<p>Luego, visualizamos el punto de corte óptimo utilizando la función <code>plot()</code>.</p>
<div class="example">
<p><span id="exm:bloque19nbm" class="example"><strong>Bloque 11.19  </strong></span>Visualizar punto de corte óptimo</p>
</div>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="caso-de-estudio.html#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ROC.training, <span class="at">colorize=</span><span class="cn">TRUE</span>, <span class="at">print.cutoffs.at=</span><span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="at">by=</span><span class="fl">0.1</span>))</span>
<span id="cb168-2"><a href="caso-de-estudio.html#cb168-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span><span class="dv">0</span>,<span class="at">b=</span><span class="dv">1</span>)</span>
<span id="cb168-3"><a href="caso-de-estudio.html#cb168-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>ptocorteop.training<span class="sc">$</span>threshold,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-94"></span>
<img src="bookdown-demo_files/figure-html/unnamed-chunk-94-1.png" alt="Punto de corte óptimo con datos no tratados" width="90%" />
<p class="caption">
Figura 11.1: Punto de corte óptimo con datos no tratados
</p>
</div>
<p><strong>Predicciones y matriz de confusión</strong></p>
<p>Se realizan predicciones y se genera una matriz de confusión.</p>
<div class="example">
<p><span id="exm:bloque20nbm" class="example"><strong>Bloque 11.20  </strong></span>Predicciones y matriz de confusión</p>
</div>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="caso-de-estudio.html#cb169-1" aria-hidden="true" tabindex="-1"></a>pred.training<span class="ot">&lt;-</span><span class="fu">predict</span>(modelo, <span class="at">data=</span>training, <span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span>
<span id="cb169-2"><a href="caso-de-estudio.html#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="at">ActualValue=</span>training<span class="sc">$</span>VP_DC, </span>
<span id="cb169-3"><a href="caso-de-estudio.html#cb169-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">PredictValue=</span>pred.training<span class="sc">&gt;</span>ptocorteop.training<span class="sc">$</span>threshold)</span></code></pre></div>
<pre><code>##            PredictValue
## ActualValue FALSE TRUE
##           0  8907  537
##           1  2619  447</code></pre>
<p>A continuación, se continua la evaluación del modelo con datos de prueba.</p>
<p><strong>Validación de modelo (con datos de prueba)</strong></p>
<p>Aplicamos nuevamente la validación con el test de Hosmer Lemeshow, esta vez con los datos de prueba.</p>
<div class="example">
<p><span id="exm:bloque21nbm" class="example"><strong>Bloque 11.21  </strong></span>Validación de modelo con datos de prueba</p>
</div>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="caso-de-estudio.html#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hoslem.test</span>(testing<span class="sc">$</span>VP_DC,<span class="fu">predict</span>(modelo,<span class="at">newdata=</span>testing,<span class="at">type=</span><span class="st">&quot;response&quot;</span>),<span class="at">g=</span><span class="dv">5</span>)   <span class="co"># Test de Hosmer Lemeshow</span></span></code></pre></div>
<pre><code>## 
##  Hosmer and Lemeshow goodness of fit (GOF) test
## 
## data:  testing$VP_DC, predict(modelo, newdata = testing, type = &quot;response&quot;)
## X-squared = 60.369, df = 3, p-value = 4.903e-13</code></pre>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="caso-de-estudio.html#cb173-1" aria-hidden="true" tabindex="-1"></a>indiceC.testing<span class="ot">=</span><span class="fu">roc</span>(testing<span class="sc">$</span>VP_DC,<span class="fu">predict</span>(modelo,<span class="at">newdata=</span>testing,<span class="at">type=</span><span class="st">&quot;response&quot;</span>)) <span class="co"># Curva ROC</span></span></code></pre></div>
<pre><code>## Setting levels: control = 0, case = 1</code></pre>
<pre><code>## Setting direction: controls &lt; cases</code></pre>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="caso-de-estudio.html#cb176-1" aria-hidden="true" tabindex="-1"></a>indiceC.testing</span></code></pre></div>
<pre><code>## 
## Call:
## roc.default(response = testing$VP_DC, predictor = predict(modelo,     newdata = testing, type = &quot;response&quot;))
## 
## Data: predict(modelo, newdata = testing, type = &quot;response&quot;) in 4666 controls (testing$VP_DC 0) &lt; 1590 cases (testing$VP_DC 1).
## Area under the curve: 0.5203</code></pre>
<p><strong>Punto de corte óptimo (con datos de prueba)</strong></p>
<p>Se calcula el punto de corte óptimo utilizando la función <code>coords()</code>.</p>
<div class="example">
<p><span id="exm:bloque22nbm" class="example"><strong>Bloque 11.22  </strong></span>Calcular de corte óptimo con datos de prueba</p>
</div>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="caso-de-estudio.html#cb178-1" aria-hidden="true" tabindex="-1"></a>ptocorteop.testing<span class="ot">&lt;-</span><span class="fu">coords</span>(indiceC.testing,<span class="at">x=</span><span class="st">&quot;best&quot;</span>,<span class="at">input=</span><span class="st">&quot;threshold&quot;</span>,<span class="at">best.method=</span><span class="st">&quot;youden&quot;</span>)</span>
<span id="cb178-2"><a href="caso-de-estudio.html#cb178-2" aria-hidden="true" tabindex="-1"></a>ptocorteop.testing</span></code></pre></div>
<pre><code>##   threshold specificity sensitivity
## 1 0.2633057   0.8317617   0.2440252</code></pre>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="caso-de-estudio.html#cb180-1" aria-hidden="true" tabindex="-1"></a>ROC.testing<span class="ot">&lt;-</span><span class="fu">performance</span>(<span class="fu">prediction</span>(<span class="fu">predict</span>(modelo,<span class="at">newdata=</span>testing,<span class="at">type=</span><span class="st">&quot;response&quot;</span>),</span>
<span id="cb180-2"><a href="caso-de-estudio.html#cb180-2" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">as.factor</span>(testing<span class="sc">$</span>VP_DC)),<span class="st">&quot;tpr&quot;</span>,<span class="st">&quot;fpr&quot;</span>)</span></code></pre></div>
<p>Luego, visualizamos el punto de corte óptimo utilizando la función <code>plot()</code>.</p>
<div class="example">
<p><span id="exm:bloque23nbm" class="example"><strong>Bloque 11.23  </strong></span>Visualizar de corte óptimo con datos de prueba</p>
</div>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="caso-de-estudio.html#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ROC.testing, <span class="at">colorize=</span><span class="cn">TRUE</span>, <span class="at">print.cutoffs.at=</span><span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="at">by=</span><span class="fl">0.1</span>))</span>
<span id="cb181-2"><a href="caso-de-estudio.html#cb181-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span><span class="dv">0</span>,<span class="at">b=</span><span class="dv">1</span>)</span>
<span id="cb181-3"><a href="caso-de-estudio.html#cb181-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>ptocorteop.testing<span class="sc">$</span>threshold,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-98"></span>
<img src="bookdown-demo_files/figure-html/unnamed-chunk-98-1.png" alt="Punto de corte óptimo con datos de prueba a partir de datos no tratados" width="90%" />
<p class="caption">
Figura 11.2: Punto de corte óptimo con datos de prueba a partir de datos no tratados
</p>
</div>
<p><strong>Predicciones y matriz de confusión (con datos de prueba)</strong></p>
<p>Se realizan predicciones y se genera una matriz de confusión.</p>
<div class="example">
<p><span id="exm:bloque24nbm" class="example"><strong>Bloque 11.24  </strong></span>Predicciones y matriz de confusión con datos de prueba</p>
</div>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="caso-de-estudio.html#cb182-1" aria-hidden="true" tabindex="-1"></a>pred.testing<span class="ot">&lt;-</span><span class="fu">predict</span>(modelo, testing, <span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span>
<span id="cb182-2"><a href="caso-de-estudio.html#cb182-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="at">ActualValue=</span>testing<span class="sc">$</span>VP_DC, <span class="at">PredictValue=</span>pred.testing<span class="sc">&gt;</span>ptocorteop.testing<span class="sc">$</span>threshold)</span></code></pre></div>
<pre><code>##            PredictValue
## ActualValue FALSE TRUE
##           0  3881  785
##           1  1202  388</code></pre>
<p><strong>Comparar área bajo la curva, umbral, sensibilidad y especificidad</strong></p>
<p>Finalmente, comparamos el área bajo la curva, umbral, sensibilidad y especificidad, a partir de los resultados del modelo con los datos de entrenamiento y con los datos de prueba.</p>
<div class="example">
<p><span id="exm:bloque25nbm" class="example"><strong>Bloque 11.25  </strong></span>Comparar área bajo la curva, umbral, sensibilidad y especificidad</p>
</div>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="caso-de-estudio.html#cb184-1" aria-hidden="true" tabindex="-1"></a>auc    <span class="ot">&lt;-</span>indiceC.trainig<span class="sc">$</span>auc              <span class="sc">-</span> indiceC.testing<span class="sc">$</span>auc</span>
<span id="cb184-2"><a href="caso-de-estudio.html#cb184-2" aria-hidden="true" tabindex="-1"></a>corte  <span class="ot">&lt;-</span>ptocorteop.training<span class="sc">$</span>threshold    <span class="sc">-</span> ptocorteop.testing<span class="sc">$</span>threshold</span>
<span id="cb184-3"><a href="caso-de-estudio.html#cb184-3" aria-hidden="true" tabindex="-1"></a>sens   <span class="ot">&lt;-</span> ptocorteop.training<span class="sc">$</span>sensitivity <span class="sc">-</span> ptocorteop.testing<span class="sc">$</span>sensitivity</span>
<span id="cb184-4"><a href="caso-de-estudio.html#cb184-4" aria-hidden="true" tabindex="-1"></a>spe    <span class="ot">&lt;-</span> ptocorteop.training<span class="sc">$</span>specificity <span class="sc">-</span> ptocorteop.testing<span class="sc">$</span>specificity</span></code></pre></div>
</div>
</div>
</div>
</div>
<div id="paso-dos-preparar-y-explorar-datos-originales" class="section level2 hasAnchor" number="11.2">
<h2><span class="header-section-number">11.2</span> Paso Dos: Preparar y explorar datos originales<a href="caso-de-estudio.html#paso-dos-preparar-y-explorar-datos-originales" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="preparación-de-datos" class="section level3 hasAnchor" number="11.2.1">
<h3><span class="header-section-number">11.2.1</span> Preparación de datos<a href="caso-de-estudio.html#preparación-de-datos" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="integración-de-datos" class="section level4 hasAnchor" number="11.2.1.1">
<h4><span class="header-section-number">11.2.1.1</span> Integración de datos<a href="caso-de-estudio.html#integración-de-datos" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>La base de datos ENUSC ya se encuentra integrada y no se combina con ninguna otra base producida para este producto estadístico.</p>
</div>
<div id="eliminación-de-identificadores-directos" class="section level4 hasAnchor" number="11.2.1.2">
<h4><span class="header-section-number">11.2.1.2</span> Eliminación de identificadores directos<a href="caso-de-estudio.html#eliminación-de-identificadores-directos" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Se registra nombres de identificadores directos y otras variables internas del proyecto que no son publicadas.</p>
<div class="example">
<p><span id="exm:bloque26nbm" class="example"><strong>Bloque 11.26  </strong></span>Almacenar indicadores directos y otras variables excluidas en un vector de texto</p>
</div>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="caso-de-estudio.html#cb185-1" aria-hidden="true" tabindex="-1"></a>identificadores_directos <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;enc_id&#39;</span>,<span class="st">&#39;enc_distrito&#39;</span>,</span>
<span id="cb185-2"><a href="caso-de-estudio.html#cb185-2" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&#39;enc_zona&#39;</span>,<span class="st">&#39;enc_manzana&#39;</span>,<span class="st">&#39;enc_vivienda&#39;</span>,<span class="st">&#39;FECHA&#39;</span>,</span>
<span id="cb185-3"><a href="caso-de-estudio.html#cb185-3" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&#39;enc_Nombre_ID&#39;</span>,</span>
<span id="cb185-4"><a href="caso-de-estudio.html#cb185-4" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&#39;enc_Nombre_K&#39;</span>,<span class="st">&#39;enc_Edad_K&#39;</span>,</span>
<span id="cb185-5"><a href="caso-de-estudio.html#cb185-5" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&#39;rph_dianacimiento&#39;</span>,<span class="st">&#39;rph_mesnacimiento&#39;</span>,</span>
<span id="cb185-6"><a href="caso-de-estudio.html#cb185-6" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&#39;rph_agnonacimiento&#39;</span>,</span>
<span id="cb185-7"><a href="caso-de-estudio.html#cb185-7" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&#39;rph_nombrepila&#39;</span>,<span class="st">&#39;Hora_inicio_rph&#39;</span>,</span>
<span id="cb185-8"><a href="caso-de-estudio.html#cb185-8" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&#39;Hora_termino_rph&#39;</span>,<span class="st">&#39;Hora_inicio_cc&#39;</span>,<span class="st">&#39;Hora_termino_cc&#39;</span>,</span>
<span id="cb185-9"><a href="caso-de-estudio.html#cb185-9" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&#39;IDC&#39;</span>,<span class="st">&#39;enc_letraKish&#39;</span>,</span>
<span id="cb185-10"><a href="caso-de-estudio.html#cb185-10" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&#39;enc_direccion&#39;</span>,<span class="st">&#39;enc_numero&#39;</span>,<span class="st">&#39;enc_codfono&#39;</span>,</span>
<span id="cb185-11"><a href="caso-de-estudio.html#cb185-11" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&#39;enc_fono&#39;</span>,<span class="st">&#39;Enc_Fono_ID&#39;</span>,<span class="st">&#39;Enc_Correo_ID&#39;</span>,</span>
<span id="cb185-12"><a href="caso-de-estudio.html#cb185-12" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&#39;Enc_Fono_K&#39;</span>,<span class="st">&#39;Enc_Correo_K&#39;</span>)</span>
<span id="cb185-13"><a href="caso-de-estudio.html#cb185-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-14"><a href="caso-de-estudio.html#cb185-14" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(identificadores_directos <span class="sc">%in%</span> <span class="fu">names</span>(file))</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>Luego, se quitan estas variables de la base de datos.</p>
<div class="example">
<p><span id="exm:bloque27nbm" class="example"><strong>Bloque 11.27  </strong></span>Filtrar columnas excluidas</p>
</div>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="caso-de-estudio.html#cb187-1" aria-hidden="true" tabindex="-1"></a>file <span class="ot">&lt;-</span> file[,<span class="sc">!</span><span class="fu">names</span>(file) <span class="sc">%in%</span> identificadores_directos]</span></code></pre></div>
<p>También, se quitan las variables de cadena con registros de observaciones, que tampoco corresponde publicar (en caso de que las hubiera). Estas corresponden a variables de texto que registran observaciones de terreno del encuestador y relatos de los delitos brindados por los informantes, información utilizada para el procesamiento de la base de datos, pero que no se consideran para su publicación.</p>
<div class="example">
<p><span id="exm:bloque28nbm" class="example"><strong>Bloque 11.28  </strong></span>Filtrar columnas de texto y observaciones de terreno</p>
</div>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="caso-de-estudio.html#cb188-1" aria-hidden="true" tabindex="-1"></a>file <span class="ot">&lt;-</span> file[,<span class="sc">!</span><span class="fu">str_detect</span>(<span class="fu">names</span>(file),<span class="st">&#39;^Obs|Obs$&#39;</span>)]</span></code></pre></div>
</div>
<div id="selección-de-variables" class="section level4 hasAnchor" number="11.2.1.3">
<h4><span class="header-section-number">11.2.1.3</span> Selección de Variables<a href="caso-de-estudio.html#selección-de-variables" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>En principio, todas las variables restantes son pertinentes de publicar, en la medida que se cumplan los requerimientos de anonimización de los datos.</p>
<p>Para efectos de los análisis siguientes y para la medición del riesgo, solo se considerará el siguiente listado de variables, que se considera que pueden ser utilizadas como variables clave para la re-identificación de los informantes. Todas estas corresponden a variables de ubicación o del RPH.</p>
<!-- PONER TÍTULOS -->
<table>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead>
<tr class="header">
<th>Variable</th>
<th>Etiqueta</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>enc_rpc</td>
<td>Identificador de comuna</td>
</tr>
<tr class="even">
<td>enc_region</td>
<td>Identificador de región</td>
</tr>
<tr class="odd">
<td>IH_residencia_habitual</td>
<td>Número de residentes habituales</td>
</tr>
<tr class="even">
<td>rph_edad</td>
<td>Edad</td>
</tr>
<tr class="odd">
<td>rph_sexo</td>
<td>Sexo</td>
</tr>
<tr class="even">
<td>rph_idgen</td>
<td>Identidad de Género</td>
</tr>
<tr class="odd">
<td>rph_pertenencia_indigena</td>
<td>Pertenencia a pueblos indígenas</td>
</tr>
<tr class="even">
<td>rph_nacionalidad</td>
<td>Nacionalidad</td>
</tr>
<tr class="odd">
<td>rph_p14</td>
<td>Razón para no buscar un empleo o iniciar una actividad por cuenta propia</td>
</tr>
</tbody>
</table>
<p>El resto de las variables que no son clave, pero se consideran para la publicación, se mantienen en el archivo de datos (variables temáticas sobre percepción de inseguridad y victimización).</p>
</div>
<div id="consolidación-de-variables" class="section level4 hasAnchor" number="11.2.1.4">
<h4><span class="header-section-number">11.2.1.4</span> Consolidación de variables<a href="caso-de-estudio.html#consolidación-de-variables" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>De las variables recién descritas, la variable comuna se encuentra anidada en la variable de región, por lo que hay redundancia al mantener ambas. Dado que comuna (enc_rpc) tiene mayor nivel de información, se utilizará primero esta variable para los siguientes análisis y la medición de riesgo, incluyendo región solo en caso de que sea necesario retirar la variable de comuna.</p>
<p>A continuación, se transforman y consolidan variables para poder aplicar adecuadamente los análisis.</p>
<p>Primero, las variables de comparte gastos y número de grupos se excluyen del análisis, ya que son redundantes con la cantidad de residentes habituales y cantidad de hogares, siendo utilizadas solo estas últimas dos.</p>
<p>Se fusionan categorías trans y otros, dado que son poco frecuentes.</p>
<div class="example">
<p><span id="exm:bloque29nbm" class="example"><strong>Bloque 11.29  </strong></span>Consolidar categorías de identidad de género y sus valores perdidos</p>
</div>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="caso-de-estudio.html#cb189-1" aria-hidden="true" tabindex="-1"></a>file<span class="sc">$</span>rph_idgen[file<span class="sc">$</span>rph_idgen <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)] <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb189-2"><a href="caso-de-estudio.html#cb189-2" aria-hidden="true" tabindex="-1"></a>file<span class="sc">$</span>rph_idgen[file<span class="sc">$</span>rph_idgen <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">88</span>,<span class="dv">99</span>,<span class="dv">96</span>)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span></code></pre></div>
<p>Se recodifican perdidos en diversas variables clave.</p>
<div class="example">
<p><span id="exm:bloque30nbm" class="example"><strong>Bloque 11.30  </strong></span>Recodificar valores perdidos de pertenencia indígena</p>
</div>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="caso-de-estudio.html#cb190-1" aria-hidden="true" tabindex="-1"></a>file<span class="sc">$</span>rph_pertenencia_indigena[file<span class="sc">$</span>rph_pertenencia_indigena <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">88</span>,<span class="dv">99</span>,<span class="dv">96</span>)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb190-2"><a href="caso-de-estudio.html#cb190-2" aria-hidden="true" tabindex="-1"></a>file<span class="sc">$</span>rph_nacionalidad[file<span class="sc">$</span>rph_nacionalidad <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">88</span>,<span class="dv">99</span>,<span class="dv">96</span>)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb190-3"><a href="caso-de-estudio.html#cb190-3" aria-hidden="true" tabindex="-1"></a>file<span class="sc">$</span>rph_p14[file<span class="sc">$</span>rph_p14 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">88</span>,<span class="dv">99</span>,<span class="dv">96</span>)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span></code></pre></div>
<p>Consolidamos variable de situación ocupacional, ya que de otro modo tiene muchos valores perdidos por flujo, y apuntan a una sola clasificación con tres categorías que es lo más relevante.</p>
<div class="example">
<p><span id="exm:bloque31nbm" class="example"><strong>Bloque 11.31  </strong></span>Consolidar situación ocupacional</p>
</div>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="caso-de-estudio.html#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generamos variable vacía</span></span>
<span id="cb191-2"><a href="caso-de-estudio.html#cb191-2" aria-hidden="true" tabindex="-1"></a>file<span class="sc">$</span>rph_situacion_ocupacional <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb191-3"><a href="caso-de-estudio.html#cb191-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-4"><a href="caso-de-estudio.html#cb191-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Ocupados</span></span>
<span id="cb191-5"><a href="caso-de-estudio.html#cb191-5" aria-hidden="true" tabindex="-1"></a>file<span class="sc">$</span>rph_situacion_ocupacional[file<span class="sc">$</span>rph_p9 <span class="sc">%in%</span> <span class="dv">1</span> <span class="sc">|</span> file<span class="sc">$</span>rph_p10 <span class="sc">%in%</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb191-6"><a href="caso-de-estudio.html#cb191-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-7"><a href="caso-de-estudio.html#cb191-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Desocupados</span></span>
<span id="cb191-8"><a href="caso-de-estudio.html#cb191-8" aria-hidden="true" tabindex="-1"></a>file<span class="sc">$</span>rph_situacion_ocupacional[file<span class="sc">$</span>rph_p12 <span class="sc">%in%</span> <span class="dv">1</span> <span class="sc">&amp;</span> file<span class="sc">$</span>rph_p13 <span class="sc">%in%</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb191-9"><a href="caso-de-estudio.html#cb191-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-10"><a href="caso-de-estudio.html#cb191-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Inactivos</span></span>
<span id="cb191-11"><a href="caso-de-estudio.html#cb191-11" aria-hidden="true" tabindex="-1"></a>file<span class="sc">$</span>rph_situacion_ocupacional[file<span class="sc">$</span>rph_p12 <span class="sc">%in%</span> <span class="dv">2</span> <span class="sc">|</span> file<span class="sc">$</span>rph_p13 <span class="sc">%in%</span> <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb191-12"><a href="caso-de-estudio.html#cb191-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-13"><a href="caso-de-estudio.html#cb191-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Revisamos</span></span>
<span id="cb191-14"><a href="caso-de-estudio.html#cb191-14" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(file<span class="sc">$</span>rph_situacion_ocupacional)</span></code></pre></div>
<pre><code>## 
##     1     2     3 
## 30364  2470  7498</code></pre>
<p>Luego, integramos algunas categorías de inactivos con la condición de inactividad, ya que esto especifica subtipos de los inactivos que pueden ser relevantes para la re-identificación. Se agrupan las categorías que no son claves para re-identificar.</p>
<div class="example">
<p><span id="exm:bloque32nbm" class="example"><strong>Bloque 11.32  </strong></span>Consolidar situación ocupacional con categorías de inactivos.</p>
</div>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="caso-de-estudio.html#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Inactivo - Otros</span></span>
<span id="cb193-2"><a href="caso-de-estudio.html#cb193-2" aria-hidden="true" tabindex="-1"></a>file<span class="sc">$</span>rph_situacion_ocupacional[file<span class="sc">$</span>rph_situacion_ocupacional <span class="sc">%in%</span> <span class="dv">3</span> <span class="sc">&amp;</span></span>
<span id="cb193-3"><a href="caso-de-estudio.html#cb193-3" aria-hidden="true" tabindex="-1"></a>                                 (file<span class="sc">$</span>rph_p14 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">6</span>,<span class="dv">7</span>) <span class="sc">|</span> <span class="fu">is.na</span>(file<span class="sc">$</span>rph_p14))] <span class="ot">&lt;-</span> <span class="dv">3</span> </span>
<span id="cb193-4"><a href="caso-de-estudio.html#cb193-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-5"><a href="caso-de-estudio.html#cb193-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Inactivo - Estudiante</span></span>
<span id="cb193-6"><a href="caso-de-estudio.html#cb193-6" aria-hidden="true" tabindex="-1"></a>file<span class="sc">$</span>rph_situacion_ocupacional[file<span class="sc">$</span>rph_situacion_ocupacional <span class="sc">%in%</span> <span class="dv">3</span> <span class="sc">&amp;</span></span>
<span id="cb193-7"><a href="caso-de-estudio.html#cb193-7" aria-hidden="true" tabindex="-1"></a>                                 file<span class="sc">$</span>rph_p14 <span class="sc">%in%</span> <span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="dv">4</span> </span>
<span id="cb193-8"><a href="caso-de-estudio.html#cb193-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-9"><a href="caso-de-estudio.html#cb193-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Inactivo - Jubilado, pensionado o rentista</span></span>
<span id="cb193-10"><a href="caso-de-estudio.html#cb193-10" aria-hidden="true" tabindex="-1"></a>file<span class="sc">$</span>rph_situacion_ocupacional[file<span class="sc">$</span>rph_situacion_ocupacional <span class="sc">%in%</span> <span class="dv">3</span> <span class="sc">&amp;</span></span>
<span id="cb193-11"><a href="caso-de-estudio.html#cb193-11" aria-hidden="true" tabindex="-1"></a>                                 file<span class="sc">$</span>rph_p14 <span class="sc">%in%</span> <span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="dv">5</span> </span>
<span id="cb193-12"><a href="caso-de-estudio.html#cb193-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-13"><a href="caso-de-estudio.html#cb193-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Inactivo - Motivos de salud permanentes</span></span>
<span id="cb193-14"><a href="caso-de-estudio.html#cb193-14" aria-hidden="true" tabindex="-1"></a>file<span class="sc">$</span>rph_situacion_ocupacional[file<span class="sc">$</span>rph_situacion_ocupacional <span class="sc">%in%</span> <span class="dv">3</span> <span class="sc">&amp;</span></span>
<span id="cb193-15"><a href="caso-de-estudio.html#cb193-15" aria-hidden="true" tabindex="-1"></a>                                 file<span class="sc">$</span>rph_p14 <span class="sc">%in%</span> <span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="dv">6</span> </span>
<span id="cb193-16"><a href="caso-de-estudio.html#cb193-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-17"><a href="caso-de-estudio.html#cb193-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Revisamos</span></span>
<span id="cb193-18"><a href="caso-de-estudio.html#cb193-18" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(file<span class="sc">$</span>rph_situacion_ocupacional)</span></code></pre></div>
<pre><code>## 
##     1     2     3     4     5     6 
## 30364  2470  5358   730   718   692</code></pre>
<p>Finalmente, se convierten las variables categóricas a tipo factor, quitándole el etiquetado de <code>haven</code>, ya que causa problemas con <code>sdcMicro</code>.</p>
<div class="example">
<p><span id="exm:bloque33nbm" class="example"><strong>Bloque 11.33  </strong></span>Convertir variables clave a factor</p>
</div>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="caso-de-estudio.html#cb195-1" aria-hidden="true" tabindex="-1"></a>file<span class="sc">$</span>enc_region <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">as.numeric</span>(file<span class="sc">$</span>enc_region))</span>
<span id="cb195-2"><a href="caso-de-estudio.html#cb195-2" aria-hidden="true" tabindex="-1"></a>file<span class="sc">$</span>enc_rpc <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">as.numeric</span>(file<span class="sc">$</span>enc_rpc))</span>
<span id="cb195-3"><a href="caso-de-estudio.html#cb195-3" aria-hidden="true" tabindex="-1"></a>file<span class="sc">$</span>rph_sexo <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">as.numeric</span>(file<span class="sc">$</span>rph_sexo ))</span>
<span id="cb195-4"><a href="caso-de-estudio.html#cb195-4" aria-hidden="true" tabindex="-1"></a>file<span class="sc">$</span>rph_idgen <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">as.numeric</span>(file<span class="sc">$</span>rph_idgen))</span>
<span id="cb195-5"><a href="caso-de-estudio.html#cb195-5" aria-hidden="true" tabindex="-1"></a>file<span class="sc">$</span>rph_pertenencia_indigena <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">as.numeric</span>(file<span class="sc">$</span>rph_pertenencia_indigena))</span>
<span id="cb195-6"><a href="caso-de-estudio.html#cb195-6" aria-hidden="true" tabindex="-1"></a>file<span class="sc">$</span>rph_nacionalidad <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">as.numeric</span>(file<span class="sc">$</span>rph_nacionalidad))</span>
<span id="cb195-7"><a href="caso-de-estudio.html#cb195-7" aria-hidden="true" tabindex="-1"></a>file<span class="sc">$</span>rph_situacion_ocupacional <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">as.numeric</span>(file<span class="sc">$</span>rph_situacion_ocupacional))</span></code></pre></div>
</div>
</div>
<div id="exploración-del-conjunto-de-datos" class="section level3 hasAnchor" number="11.2.2">
<h3><span class="header-section-number">11.2.2</span> Exploración del conjunto de datos<a href="caso-de-estudio.html#exploración-del-conjunto-de-datos" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Primero, revisamos cuáles variables tenemos en la base de datos en este punto del proceso.</p>
<div class="example">
<p><span id="exm:bloque34nbm" class="example"><strong>Bloque 11.34  </strong></span>Revisar nuevamente variables presente en conjunto de datos</p>
</div>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="caso-de-estudio.html#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(file)</span></code></pre></div>
<pre><code>##  [1] &quot;enc_idr&quot;                   &quot;rph_ID&quot;                    &quot;enc_region&quot;               
##  [4] &quot;enc_rpc&quot;                   &quot;IH_residencia_habitual&quot;    &quot;rph_numeroLinea&quot;          
##  [7] &quot;rph_parentesco&quot;            &quot;rph_edad&quot;                  &quot;rph_sexo&quot;                 
## [10] &quot;rph_idgen&quot;                 &quot;Kish&quot;                      &quot;rph_pertenencia_indigena&quot; 
## [13] &quot;rph_nacionalidad&quot;          &quot;rph_migracion&quot;             &quot;rph_p9&quot;                   
## [16] &quot;rph_p10&quot;                   &quot;rph_p11&quot;                   &quot;rph_p12&quot;                  
## [19] &quot;rph_p13&quot;                   &quot;rph_p14&quot;                   &quot;P17&quot;                      
## [22] &quot;P24&quot;                       &quot;A1_1_1&quot;                    &quot;A1_1_1_N_Veces&quot;           
## [25] &quot;B1_1_1&quot;                    &quot;B1_1_1_N_Veces&quot;            &quot;C1_1_1&quot;                   
## [28] &quot;C1_1_1_N_Veces&quot;            &quot;D1_1_1&quot;                    &quot;D1_1_1_N_Veces&quot;           
## [31] &quot;E1_1_1&quot;                    &quot;E1_1_1_N_Veces&quot;            &quot;F1_1_1&quot;                   
## [34] &quot;G1_1_1&quot;                    &quot;G1_1_1_N_Veces&quot;            &quot;H1_1_1&quot;                   
## [37] &quot;H1_1_1_N_Veces&quot;            &quot;VA_DC&quot;                     &quot;VP_DC&quot;                    
## [40] &quot;DEN_AGREG&quot;                 &quot;RVA_DC&quot;                    &quot;Fact_Pers&quot;                
## [43] &quot;Fact_Hog&quot;                  &quot;VarStrat&quot;                  &quot;Conglomerado&quot;             
## [46] &quot;Fact_Ind&quot;                  &quot;rph_situacion_ocupacional&quot;</code></pre>
<div id="cálculo-de-porcentaje-de-valores-perdidos-en-las-variables" class="section level4 hasAnchor" number="11.2.2.1">
<h4><span class="header-section-number">11.2.2.1</span> Cálculo de porcentaje de valores perdidos en las variables<a href="caso-de-estudio.html#cálculo-de-porcentaje-de-valores-perdidos-en-las-variables" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Luego, calculamos el porcentaje de valores perdidos en las variables, considerando las celdas válidas según flujo de la encuesta (no se cuentan como valores perdidos las celdas vacías por saltos en el cuestionario). Aquellas variables que contengan más de un 50% de celdas perdidas, se excluyen del proceso de anonimización (pero sí deben incluirse en el archivo final de datos).</p>
<p>Se observa que no hay variables clave que tengan valores perdidos.</p>
<div class="example">
<p><span id="exm:bloque35nbm" class="example"><strong>Bloque 11.35  </strong></span>Chequear valores perdidos</p>
</div>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="caso-de-estudio.html#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">is.na</span>(file<span class="sc">$</span>enc_region))</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="caso-de-estudio.html#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">is.na</span>(file<span class="sc">$</span>enc_rpc))</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="caso-de-estudio.html#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">is.na</span>(file<span class="sc">$</span>IH_residencia_habitual))</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="caso-de-estudio.html#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">is.na</span>(file<span class="sc">$</span>rph_sexo))</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="caso-de-estudio.html#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">is.na</span>(file<span class="sc">$</span>rph_edad))</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="caso-de-estudio.html#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">is.na</span>(file<span class="sc">$</span>rph_pertenencia_indigena)) </span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="caso-de-estudio.html#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">is.na</span>(file<span class="sc">$</span>rph_nacionalidad)) </span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="caso-de-estudio.html#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">is.na</span>(file<span class="sc">$</span>rph_situacion_ocupacional[file<span class="sc">$</span>rph_edad <span class="sc">&gt;</span> <span class="dv">14</span>])) </span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<p>Se concluye que todas las variables cumplen con las condiciones para incluirse en el proceso de anonimización.</p>
</div>
<div id="cálculo-de-estadísticas-de-resumen" class="section level4 hasAnchor" number="11.2.2.2">
<h4><span class="header-section-number">11.2.2.2</span> Cálculo de estadísticas de resumen<a href="caso-de-estudio.html#cálculo-de-estadísticas-de-resumen" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Por último, se revisan frecuencias para variables categóricas y estadísticos de resumen para numéricas. Esto permite visualizar que variables tienen categorías infrecuentes, lo que puede ser relevante más adelante para la toma de decisión de cuáles métodos aplicar y sobre cuáles variables.</p>
<div class="example">
<p><span id="exm:bloque36nbm" class="example"><strong>Bloque 11.36  </strong></span>Tablas de frecuencia de variables clave</p>
</div>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="caso-de-estudio.html#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(file<span class="sc">$</span>enc_region)</span></code></pre></div>
<pre><code>## 
##    1    2    3    4    5    6    7    8    9   10   11   12   13   14   15   16 
## 3223 2061 3115 2264 5269 2938 2648 4393 2241 3138 2693 2401 1842 2944 3368 2806</code></pre>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="caso-de-estudio.html#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(file<span class="sc">$</span>enc_rpc)</span></code></pre></div>
<pre><code>## 
##  1101  1102  1103  1104  1105  1106  2101  2102  2103  2104  2105  2106  3101  3102  3103 
##   561   601   522   500   533   506   326   355   350   358   343   329   524   564   493 
##  3104  3105  3106  4101  4102  4103  4104  4105  4106  5101  5102  5103  5104  5105  5106 
##   461   514   559   393   416   342   436   351   326   889   926   890   862   812   890 
##  6101  6102  6103  6104  6105  6106  7101  7102  7103  7104  7105  7106  8101  8102  8103 
##   495   471   455   507   522   488   434   470   395   463   409   477   698   720   774 
##  8104  8105  8106  9101  9102  9103  9104  9105  9106 10101 10102 10103 10104 10105 10106 
##   700   724   777   402   380   337   385   344   393   539   519   495   525   492   568 
## 11101 11102 11103 11104 11105 11106 11107 12101 12102 12103 12104 12105 12106 12107 13101 
##   340   350   380   446   375   432   370   322   302   382   411   340   362   282   251 
## 13102 13103 13104 13105 13106 13107 14101 14102 14103 14104 14105 14106 14107 15101 15102 
##   273   270   234   214   293   307   419   447   410   373   427   444   424   443   483 
## 15103 15104 15105 15106 15107 16101 16102 16103 16104 16105 16106 16107 
##   511   467   544   438   482   448   362   397   351   371   431   446</code></pre>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="caso-de-estudio.html#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(file<span class="sc">$</span>rph_sexo)</span></code></pre></div>
<pre><code>## 
##     1     2 
## 23694 23650</code></pre>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="caso-de-estudio.html#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(file<span class="sc">$</span>rph_idgen)</span></code></pre></div>
<pre><code>## 
##     1     2     3 
## 10116 10030 20186</code></pre>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="caso-de-estudio.html#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(file<span class="sc">$</span>rph_pertenencia_indigena)</span></code></pre></div>
<pre><code>## 
##    1    2    3    4    5    6    7    8    9   10   11 
## 4341 4276 4315 4368 4265 4322 4403 4317 4217 4239 4281</code></pre>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="caso-de-estudio.html#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(file<span class="sc">$</span>rph_nacionalidad)</span></code></pre></div>
<pre><code>## 
##     1     2     3     4     5     6     7     8     9 
## 38923  1049  1010  1060  1025  1048  1035  1125  1069</code></pre>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="caso-de-estudio.html#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(file<span class="sc">$</span>rph_situacion_ocupacional)</span></code></pre></div>
<pre><code>## 
##     1     2     3     4     5     6 
## 30364  2470  5358   730   718   692</code></pre>
<div class="example">
<p><span id="exm:bloque37nbm" class="example"><strong>Bloque 11.37  </strong></span>Estadísticos de resumen de variables clave</p>
</div>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="caso-de-estudio.html#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(file<span class="sc">$</span>IH_residencia_habitual)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   1.000   2.000   3.000   2.942   4.000   4.000</code></pre>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="caso-de-estudio.html#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(file<span class="sc">$</span>rph_edad)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    0.00   25.00   53.00   53.06   80.00  107.00</code></pre>
</div>
</div>
</div>
<div id="paso-tres-medición-y-evaluación-del-riesgo-de-divulgación" class="section level2 hasAnchor" number="11.3">
<h2><span class="header-section-number">11.3</span> Paso Tres: Medición y evaluación del riesgo de divulgación<a href="caso-de-estudio.html#paso-tres-medición-y-evaluación-del-riesgo-de-divulgación" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="definición-de-escenarios-de-divulgación" class="section level3 hasAnchor" number="11.3.1">
<h3><span class="header-section-number">11.3.1</span> Definición de escenarios de divulgación<a href="caso-de-estudio.html#definición-de-escenarios-de-divulgación" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Las variables escogidas en su gran mayoría se encuentran contenidas también en otros productos estadísticos del INE y otras entidades públicas, ya que refieren a variables básicas de ubicación y caracterización sociodemográfica. Se destaca la coincidencia de variables de caracterización de personas de los hogares con CASEN y EPF, como ejemplos de fuentes internas. En el caso de fuentes externas, la ENPG de SENDA se considera una encuesta que contiene variables similares para hacer <em>match</em>.</p>
<p>Por este motivo, se toma un único escenario conservador, en que todas estas variables son potencialmente utilizables en combinación por un intruso, siendo posibles de enlazar a otras base de datos públicas y/o privadas, habilitando una posible re-identificación de registros.</p>
<p>En este sentido, y considerando las variables ya fusionadas/consolidadas, se mantiene el siguiente listado de variables para la medición del riesgo:</p>
<table>
<thead>
<tr class="header">
<th>Variable</th>
<th>Etiqueta</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>enc_rpc</td>
<td>Identificador de comuna</td>
</tr>
<tr class="even">
<td>enc_region</td>
<td>Identificador de región</td>
</tr>
<tr class="odd">
<td>IH_residencia_habitual</td>
<td>Número de residentes habituales</td>
</tr>
<tr class="even">
<td>rph_edad</td>
<td>Edad</td>
</tr>
<tr class="odd">
<td>rph_sexo</td>
<td>Sexo</td>
</tr>
<tr class="even">
<td>rph_idgen</td>
<td>Identidad de género</td>
</tr>
<tr class="odd">
<td>rph_pertenencia_indigena</td>
<td>Pertenencia a pueblos indígenas</td>
</tr>
<tr class="even">
<td>rph_nacionalidad</td>
<td>Nacionalidad</td>
</tr>
<tr class="odd">
<td>rph_situacion_ocupacional</td>
<td>Situación ocupacional</td>
</tr>
</tbody>
</table>
</div>
<div id="medición-de-riesgos-de-divulgación" class="section level3 hasAnchor" number="11.3.2">
<h3><span class="header-section-number">11.3.2</span> Medición de riesgos de divulgación<a href="caso-de-estudio.html#medición-de-riesgos-de-divulgación" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Para medir el riesgo se considerarán las medidas de riesgo global, riesgo individual, <em>l-diversity</em> y k-anonimato,considerando además la estructura jerárquica de la base. Por este motivo, primero se mide el riesgo a nivel de vivienda/hogar, para luego medir a nivel individual.</p>
<div id="medición-de-riesgos-de-divulgación-a-nivel-viviendahogar" class="section level4 hasAnchor" number="11.3.2.1">
<h4><span class="header-section-number">11.3.2.1</span> Medición de riesgos de divulgación a nivel vivienda/hogar<a href="caso-de-estudio.html#medición-de-riesgos-de-divulgación-a-nivel-viviendahogar" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>En los siguientes pasos, se seleccionan las variables del nivel jerárquico superior y se genera el objeto <code>sdcMicro</code> en base al cual se realizan las estimaciones.</p>
<p>Primero, se generan vectores con las variables claves y las variables numéricas en el conjunto de datos (nivel hogar). Luego, opcionalmente se pueden declarar variables para el método PRAM (en este caso se genera un vector vacío ya que no se utilizará el método PRAM).</p>
<div class="example">
<p><span id="exm:bloque38nbm" class="example"><strong>Bloque 11.38  </strong></span>Generar vectores con variables claves categóricas, numéricas y variables PRAM</p>
</div>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="caso-de-estudio.html#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Selección de variables para la anonimización a nivel de hogar</span></span>
<span id="cb232-2"><a href="caso-de-estudio.html#cb232-2" aria-hidden="true" tabindex="-1"></a>selectedKeyVarsHH <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;enc_rpc&quot;</span>)</span>
<span id="cb232-3"><a href="caso-de-estudio.html#cb232-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-4"><a href="caso-de-estudio.html#cb232-4" aria-hidden="true" tabindex="-1"></a><span class="co"># variables numericas</span></span>
<span id="cb232-5"><a href="caso-de-estudio.html#cb232-5" aria-hidden="true" tabindex="-1"></a>numVarsHH <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;IH_residencia_habitual&quot;</span>)</span>
<span id="cb232-6"><a href="caso-de-estudio.html#cb232-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-7"><a href="caso-de-estudio.html#cb232-7" aria-hidden="true" tabindex="-1"></a><span class="co"># No se declaran variables para método PRAM</span></span>
<span id="cb232-8"><a href="caso-de-estudio.html#cb232-8" aria-hidden="true" tabindex="-1"></a>pramVarsHH <span class="ot">&lt;-</span> <span class="fu">c</span>()</span></code></pre></div>
<p>A continuación, se genera un vector con la variable de ponderación de hogares.</p>
<div class="example">
<p><span id="exm:bloque39nbm" class="example"><strong>Bloque 11.39  </strong></span>Asignar variables de ponderación a nivel hogar</p>
</div>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="caso-de-estudio.html#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Se indican las variables de ponderación de hogares</span></span>
<span id="cb233-2"><a href="caso-de-estudio.html#cb233-2" aria-hidden="true" tabindex="-1"></a>weightVarsHH <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Fact_Hog&quot;</span>)</span></code></pre></div>
<p>Ahora, reunimos todas estas variables en un vector denominado <em>HHVars</em></p>
<div class="example">
<p><span id="exm:bloque40nbm" class="example"><strong>Bloque 11.40  </strong></span>Generar vector con variables del nivel hogar</p>
</div>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="caso-de-estudio.html#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Luego se genera un vector con todas las variables del nivel de hogar</span></span>
<span id="cb234-2"><a href="caso-de-estudio.html#cb234-2" aria-hidden="true" tabindex="-1"></a>HHVars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;enc_idr&#39;</span>,selectedKeyVarsHH, pramVarsHH, numVarsHH, weightVarsHH)</span>
<span id="cb234-3"><a href="caso-de-estudio.html#cb234-3" aria-hidden="true" tabindex="-1"></a>variables <span class="ot">&lt;-</span> HHVars</span>
<span id="cb234-4"><a href="caso-de-estudio.html#cb234-4" aria-hidden="true" tabindex="-1"></a>todas_variables <span class="ot">&lt;-</span> <span class="fu">names</span>(file)</span>
<span id="cb234-5"><a href="caso-de-estudio.html#cb234-5" aria-hidden="true" tabindex="-1"></a>HHVars <span class="ot">&lt;-</span> <span class="fu">intersect</span>(todas_variables,variables)</span></code></pre></div>
<p>Luego, generamos un conjunto de datos con solo las columnas y filas que corresponden. En este caso son las variables del nivel hogar y las filas que corresponden al informante Kish, de manera tal que haya un caso por hogar.</p>
<div class="example">
<p><span id="exm:bloque41nbm" class="example"><strong>Bloque 11.41  </strong></span>Filtrar un caso por vivienda</p>
</div>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="caso-de-estudio.html#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creamos un subconjunto de datos de file con hogares y variables HH</span></span>
<span id="cb235-2"><a href="caso-de-estudio.html#cb235-2" aria-hidden="true" tabindex="-1"></a>fileHH <span class="ot">&lt;-</span> file[,HHVars]</span>
<span id="cb235-3"><a href="caso-de-estudio.html#cb235-3" aria-hidden="true" tabindex="-1"></a>fileHH<span class="sc">$</span>Kish <span class="ot">&lt;-</span> file<span class="sc">$</span>Kish</span>
<span id="cb235-4"><a href="caso-de-estudio.html#cb235-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-5"><a href="caso-de-estudio.html#cb235-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Se deja un caso por cada hogar asignado en fileHH</span></span>
<span id="cb235-6"><a href="caso-de-estudio.html#cb235-6" aria-hidden="true" tabindex="-1"></a>fileHH <span class="ot">&lt;-</span> fileHH[fileHH<span class="sc">$</span>Kish <span class="sc">%in%</span> <span class="dv">1</span>,]</span>
<span id="cb235-7"><a href="caso-de-estudio.html#cb235-7" aria-hidden="true" tabindex="-1"></a>fileHH <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">select</span>(fileHH, <span class="sc">-</span>Kish)</span></code></pre></div>
<p>Luego, se verifican las dimensiones del conjunto de datos con la función <code>dim()</code>.</p>
<div class="example">
<p><span id="exm:bloque42nbm" class="example"><strong>Bloque 11.42  </strong></span>Construir e inspeccionar dataframe de hogares</p>
</div>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="caso-de-estudio.html#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Se genera el dataset para medición de riesgo</span></span>
<span id="cb236-2"><a href="caso-de-estudio.html#cb236-2" aria-hidden="true" tabindex="-1"></a>fileHH <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">enc_idr =</span> fileHH<span class="sc">$</span>enc_idr,</span>
<span id="cb236-3"><a href="caso-de-estudio.html#cb236-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">enc_rpc =</span> fileHH<span class="sc">$</span>enc_rpc,</span>
<span id="cb236-4"><a href="caso-de-estudio.html#cb236-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">IH_residencia_habitual =</span> fileHH<span class="sc">$</span>IH_residencia_habitual,</span>
<span id="cb236-5"><a href="caso-de-estudio.html#cb236-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Fact_Hog =</span> fileHH<span class="sc">$</span>Fact_Hog)</span>
<span id="cb236-6"><a href="caso-de-estudio.html#cb236-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-7"><a href="caso-de-estudio.html#cb236-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Se verifican dimensiones del conjunto de datos</span></span>
<span id="cb236-8"><a href="caso-de-estudio.html#cb236-8" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(fileHH)</span></code></pre></div>
<pre><code>## [1] 18766     4</code></pre>
<p>Y se genera el objeto SDC a nivel de hogar.</p>
<div class="example">
<p><span id="exm:bloque43nbm" class="example"><strong>Bloque 11.43  </strong></span>Crear objeto SDC</p>
</div>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="caso-de-estudio.html#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Se crea objeto SDC inicial para variables de nivel de hogar</span></span>
<span id="cb238-2"><a href="caso-de-estudio.html#cb238-2" aria-hidden="true" tabindex="-1"></a>sdcHH <span class="ot">&lt;-</span> <span class="fu">createSdcObj</span>(<span class="at">dat =</span> fileHH, <span class="at">keyVars =</span> selectedKeyVarsHH,</span>
<span id="cb238-3"><a href="caso-de-estudio.html#cb238-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">numVars =</span> numVarsHH, <span class="at">weightVar =</span> weightVarsHH)</span></code></pre></div>
<p>Por último, se guarda en un vector la cantidad de hogares para uso posterior.</p>
<div class="example">
<p><span id="exm:bloque44nbm" class="example"><strong>Bloque 11.44  </strong></span>Almacenar número de hogares</p>
</div>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="caso-de-estudio.html#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Se genera variable con número de hogares</span></span>
<span id="cb239-2"><a href="caso-de-estudio.html#cb239-2" aria-hidden="true" tabindex="-1"></a>numHH <span class="ot">&lt;-</span> <span class="fu">length</span>(fileHH[,<span class="dv">1</span>]) <span class="co"># número de hogares </span></span></code></pre></div>
<p>Primero, revisamos las medidas globales de riesgo. Se observa que no hay hasta el momento observaciones que tengan un riesgo superior que la mayoría de los datos.</p>
<div class="example">
<p><span id="exm:bloque45nbm" class="example"><strong>Bloque 11.45  </strong></span>Medidas globales de riesgo</p>
</div>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="caso-de-estudio.html#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sdcHH, <span class="st">&quot;risk&quot;</span>)</span></code></pre></div>
<pre><code>## Risk measures:
## 
## Number of observations with higher risk than the main part of the data: 0
## Expected number of re-identifications: 0.16 (0.00 %)</code></pre>
<p>Ahora medimos el riesgo de manera individual. Se observan 0 casos con riesgo sobre el 1%.
::: {.example #bloque46nbm}
Riesgo individual
:::</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="caso-de-estudio.html#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Observations with risk above certain threshold (0.01)</span></span>
<span id="cb242-2"><a href="caso-de-estudio.html#cb242-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(fileHH[sdcHH<span class="sc">@</span>risk<span class="sc">$</span>individual[, <span class="st">&quot;risk&quot;</span>] <span class="sc">&gt;</span> <span class="fl">0.01</span>,])</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<p>Revisamos el k-anonimato para los casos ponderados.No hay casos que violen ningún nivel de k-anonimato. Para ello, se usa la función <code>kAnon_violations()</code>, indicando <code>TRUE</code> (<code>T</code>) como argumento para el parámetro de pesos (<code>weighted</code>) y el valor de <code>k</code> a evaluar.</p>
<div class="example">
<p><span id="exm:bloque47nbm" class="example"><strong>Bloque 11.46  </strong></span>K-anonimato</p>
</div>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="caso-de-estudio.html#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sdcHH)</span></code></pre></div>
<pre><code>## Infos on 2/3-Anonymity:
## 
## Number of observations violating
##   - 2-anonymity: 0 (0.000%)
##   - 3-anonymity: 0 (0.000%)
##   - 5-anonymity: 0 (0.000%)
## 
## ----------------------------------------------------------------------</code></pre>
<p>En resumen, se observa que para el nivel hogar los riesgos ya cumplen con los umbrales establecidos por el estándar de anonimización. Por lo que se prosigue analizando el riesgo a nivel de personas.</p>
</div>
<div id="medición-de-riesgos-de-divulgación-a-nivel-persona" class="section level4 hasAnchor" number="11.3.2.2">
<h4><span class="header-section-number">11.3.2.2</span> Medición de riesgos de divulgación a nivel persona<a href="caso-de-estudio.html#medición-de-riesgos-de-divulgación-a-nivel-persona" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>En este siguiente paso, se procede a seleccionar todas las variables de ambos niveles, para crear el objeto <code>sdcMicro</code> considerando la estructura jerárquica hasta el nivel persona.</p>
<div class="example">
<p><span id="exm:bloque48nbm" class="example"><strong>Bloque 11.47  </strong></span>Comandos para construir el objeto SDC a nivel de persona</p>
</div>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="caso-de-estudio.html#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Se indican variables clave (nivel individual)</span></span>
<span id="cb246-2"><a href="caso-de-estudio.html#cb246-2" aria-hidden="true" tabindex="-1"></a>selectedKeyVarsIND <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;enc_rpc&#39;</span>,</span>
<span id="cb246-3"><a href="caso-de-estudio.html#cb246-3" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;rph_edad&#39;</span>,</span>
<span id="cb246-4"><a href="caso-de-estudio.html#cb246-4" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;rph_sexo&#39;</span>,</span>
<span id="cb246-5"><a href="caso-de-estudio.html#cb246-5" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;rph_idgen&#39;</span>,</span>
<span id="cb246-6"><a href="caso-de-estudio.html#cb246-6" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;rph_pertenencia_indigena&#39;</span>, </span>
<span id="cb246-7"><a href="caso-de-estudio.html#cb246-7" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&#39;rph_nacionalidad&#39;</span>,</span>
<span id="cb246-8"><a href="caso-de-estudio.html#cb246-8" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&#39;rph_situacion_ocupacional&#39;</span>) </span>
<span id="cb246-9"><a href="caso-de-estudio.html#cb246-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb246-10"><a href="caso-de-estudio.html#cb246-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Se indica factor de expansión de personas</span></span>
<span id="cb246-11"><a href="caso-de-estudio.html#cb246-11" aria-hidden="true" tabindex="-1"></a>WeightVarIND <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;Fact_Ind&#39;</span>)</span>
<span id="cb246-12"><a href="caso-de-estudio.html#cb246-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb246-13"><a href="caso-de-estudio.html#cb246-13" aria-hidden="true" tabindex="-1"></a><span class="co"># ID Hogares</span></span>
<span id="cb246-14"><a href="caso-de-estudio.html#cb246-14" aria-hidden="true" tabindex="-1"></a>selectedHouseholdID <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;enc_idr&#39;</span>)</span>
<span id="cb246-15"><a href="caso-de-estudio.html#cb246-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb246-16"><a href="caso-de-estudio.html#cb246-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Recombinación de conjuntos de datos HH anónimos y variables de nivel individuales</span></span>
<span id="cb246-17"><a href="caso-de-estudio.html#cb246-17" aria-hidden="true" tabindex="-1"></a>indVars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;enc_idr&quot;</span>, <span class="st">&quot;rph_ID&quot;</span>, selectedKeyVarsIND,WeightVarIND,sensibles) <span class="co"># HID and all non HH variables</span></span>
<span id="cb246-18"><a href="caso-de-estudio.html#cb246-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb246-19"><a href="caso-de-estudio.html#cb246-19" aria-hidden="true" tabindex="-1"></a>fileInd <span class="ot">&lt;-</span> file[indVars] <span class="co"># subset of file without HHVars</span></span>
<span id="cb246-20"><a href="caso-de-estudio.html#cb246-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb246-21"><a href="caso-de-estudio.html#cb246-21" aria-hidden="true" tabindex="-1"></a>fileCombined <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">inner_join</span>(fileInd, <span class="fu">select</span>(fileHH, <span class="sc">-</span>enc_rpc), <span class="at">by=</span> <span class="fu">c</span>(<span class="st">&#39;enc_idr&#39;</span>))</span>
<span id="cb246-22"><a href="caso-de-estudio.html#cb246-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb246-23"><a href="caso-de-estudio.html#cb246-23" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(fileCombined)</span></code></pre></div>
<pre><code>## [1] 47344    15</code></pre>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="caso-de-estudio.html#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Objetos SDC con todas las variables y variables HH tratadas para</span></span>
<span id="cb248-2"><a href="caso-de-estudio.html#cb248-2" aria-hidden="true" tabindex="-1"></a><span class="co"># anonimización de variables de nivel individual</span></span>
<span id="cb248-3"><a href="caso-de-estudio.html#cb248-3" aria-hidden="true" tabindex="-1"></a>sdcCombined <span class="ot">&lt;-</span> <span class="fu">createSdcObj</span>(<span class="at">dat =</span> fileCombined, <span class="at">keyVars =</span> selectedKeyVarsIND,</span>
<span id="cb248-4"><a href="caso-de-estudio.html#cb248-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">hhId =</span> selectedHouseholdID, <span class="at">weightVar =</span> WeightVarIND,</span>
<span id="cb248-5"><a href="caso-de-estudio.html#cb248-5" aria-hidden="true" tabindex="-1"></a>                            <span class="at">sensibleVar =</span> sensibles)</span></code></pre></div>
<p>Primero, revisamos las medidas globales de riesgo. Se observa que existen casos de observaciones con riesgo alto, y también un porcentaje de re-identificaciones esperadas, lo que se acentúa al considerar la estructura jerárquica. No obstante, a nivel global, esta no supera el umbral establecido de no más del 10%.</p>
<div class="example">
<p><span id="exm:bloque49nbm" class="example"><strong>Bloque 11.48  </strong></span>Medidas globales de riesgo</p>
</div>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="caso-de-estudio.html#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sdcCombined, <span class="st">&quot;risk&quot;</span>)</span></code></pre></div>
<pre><code>## Risk measures:
## 
## Number of observations with higher risk than the main part of the data: 3108
## Expected number of re-identifications: 2048.36 (4.33 %)
## 
## Information on hierarchical risk:
## Expected number of re-identifications: 5412.30 (11.43 %)
## ----------------------------------------------------------------------</code></pre>
<p>Ahora medimos el riesgo de manera individual. Para ello, se revisa la cantidad de observaciones con riesgo mayor a cada umbral de riesgo individual. Se observa que casi todos los casos presentan un riesgo superior al 1%, lo que incumple el umbral establecido. Al filtrar por porcentajes de riesgo más alto, se observa aún una cantidad muy alta de observaciones con riesgo altísimo, con 141 observaciones con riesgo superior al 50%.</p>
<div class="example">
<p><span id="exm:bloque50nbm" class="example"><strong>Bloque 11.49  </strong></span>Riesgo individual</p>
</div>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="caso-de-estudio.html#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Observaciones con riesgo individual superior al 1%:</span></span>
<span id="cb251-2"><a href="caso-de-estudio.html#cb251-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(fileCombined[sdcCombined<span class="sc">@</span>risk<span class="sc">$</span>individual[, <span class="st">&quot;risk&quot;</span>] <span class="sc">&gt;</span> <span class="fl">0.01</span>,])</span></code></pre></div>
<pre><code>## [1] 43123</code></pre>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="caso-de-estudio.html#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Observaciones con riesgo individual superior al 5%:</span></span>
<span id="cb253-2"><a href="caso-de-estudio.html#cb253-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(fileCombined[sdcCombined<span class="sc">@</span>risk<span class="sc">$</span>individual[, <span class="st">&quot;risk&quot;</span>] <span class="sc">&gt;</span> <span class="fl">0.05</span>,]) </span></code></pre></div>
<pre><code>## [1] 8862</code></pre>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="caso-de-estudio.html#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Observaciones con riesgo individual superior al 25%:</span></span>
<span id="cb255-2"><a href="caso-de-estudio.html#cb255-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(fileCombined[sdcCombined<span class="sc">@</span>risk<span class="sc">$</span>individual[, <span class="st">&quot;risk&quot;</span>] <span class="sc">&gt;</span> <span class="fl">0.25</span>,]) </span></code></pre></div>
<pre><code>## [1] 812</code></pre>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="caso-de-estudio.html#cb257-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Observaciones con riesgo individual superior al 50%:</span></span>
<span id="cb257-2"><a href="caso-de-estudio.html#cb257-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(fileCombined[sdcCombined<span class="sc">@</span>risk<span class="sc">$</span>individual[, <span class="st">&quot;risk&quot;</span>] <span class="sc">&gt;</span> <span class="fl">0.5</span>,]) </span></code></pre></div>
<pre><code>## [1] 261</code></pre>
<p>Luego, revisamos el k-anonimato para los casos ponderados. Se detectan casi la mitad de los casos incumplen el 2-anonimato a nivel muestral.</p>
<div class="example">
<p><span id="exm:bloque51nbm" class="example"><strong>Bloque 11.50  </strong></span>K-anonimato</p>
</div>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="caso-de-estudio.html#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sdcCombined)</span></code></pre></div>
<pre><code>## Infos on 2/3-Anonymity:
## 
## Number of observations violating
##   - 2-anonymity: 45168 (95.404%)
##   - 3-anonymity: 47222 (99.742%)
##   - 5-anonymity: 47344 (100.000%)
## 
## ----------------------------------------------------------------------</code></pre>
<p>Finalmente, medimos el <em>l-diversity</em>, que es una medida complementaria al k-anonimato. Esta indica cuantos valores de respuesta tienen las variables sensibles para cada combinación de las variables clave. Se espera obtener valores superiores a 1, dado que este valor indica que hay una única respuesta para cada combinación, lo que implica que un intruso podría saber el valor de respuesta a pesar de que se cumplan los umbrales de k-anonimato. En este sentido, esta métrica de riesgo es complementaria y da respaldo a lo evaluado a partir del k-anonimato.</p>
<div class="example">
<p><span id="exm:bloque52nbm" class="example"><strong>Bloque 11.51  </strong></span>L-Diversity</p>
</div>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="caso-de-estudio.html#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generamos el objeto de l-diversity</span></span>
<span id="cb261-2"><a href="caso-de-estudio.html#cb261-2" aria-hidden="true" tabindex="-1"></a>med_riesgo <span class="ot">&lt;-</span> <span class="fu">ldiversity</span>(sdcCombined, <span class="at">ldiv_index =</span> sensibles,</span>
<span id="cb261-3"><a href="caso-de-estudio.html#cb261-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">l_recurs_c =</span> <span class="dv">2</span>, <span class="at">missing =</span> <span class="cn">NA</span>)</span>
<span id="cb261-4"><a href="caso-de-estudio.html#cb261-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-5"><a href="caso-de-estudio.html#cb261-5" aria-hidden="true" tabindex="-1"></a><span class="co"># revisamos las medidas de riesgo de l-diversity</span></span>
<span id="cb261-6"><a href="caso-de-estudio.html#cb261-6" aria-hidden="true" tabindex="-1"></a>med_riesgo<span class="sc">@</span>risk<span class="sc">$</span>ldiversity</span></code></pre></div>
<pre><code>## --------------------------</code></pre>
<pre><code>## L-Diversity Measures</code></pre>
<pre><code>## --------------------------</code></pre>
<pre><code>##  P17_Distinct_Ldiversity P24_Distinct_Ldiversity DEN_AGREG_Distinct_Ldiversity
##  Min.   :1.000           Min.   :1.000           Min.   :1.000                
##  1st Qu.:1.000           1st Qu.:1.000           1st Qu.:1.000                
##  Median :1.000           Median :1.000           Median :1.000                
##  Mean   :1.021           Mean   :1.024           Mean   :1.022                
##  3rd Qu.:1.000           3rd Qu.:1.000           3rd Qu.:1.000                
##  Max.   :3.000           Max.   :3.000           Max.   :3.000</code></pre>
<p>Como se señaló previamente, el valor 1 indica un mínimo nivel de diversidad en las variables sensibles para cada
combinación de variables clave. En este sentido, el que la media y promedio del <em>l-diversity</em> se aproximen a 1 nos indica que tenemos pocas combinaciones, lo que es señal de un mayor riesgo de que el intruso logre llegar al valor de las variables sensibles.</p>
</div>
</div>
<div id="evaluación-de-riesgos-de-divulgación" class="section level3 hasAnchor" number="11.3.3">
<h3><span class="header-section-number">11.3.3</span> Evaluación de riesgos de divulgación<a href="caso-de-estudio.html#evaluación-de-riesgos-de-divulgación" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>CONCLUSIÓN DE LA EVALUACIÓN DE RIESGOS</strong></p>
<p>Dado que, a nivel jerárquico, considerando hasta el nivel de persona, se incumplen los umbrales requeridos por el estándar de anonimización a nivel individual y de k-anonimato, además de que se observa un valor riesgoso en el <em>l-diversity</em>, se confirma la necesidad de aplicar métodos SDC para asegurar la confidencialidad de los datos.</p>
<p>Estos métodos se continúan aplicando sobre el nivel de personas del conjunto de datos, dado que a nivel hogares ya se cumplen los umbrales requeridos.</p>
</div>
</div>
<div id="paso-cuatro-selección-y-aplicación-de-métodos-sdc" class="section level2 hasAnchor" number="11.4">
<h2><span class="header-section-number">11.4</span> Paso Cuatro: Selección y aplicación de métodos SDC<a href="caso-de-estudio.html#paso-cuatro-selección-y-aplicación-de-métodos-sdc" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>En esta sección se aplicarán iterativamente métodos SDC intentando alcanzar los umbrales de riesgo requeridos. Como veremos, al ser un proceso iterativo, también considerará de forma recurrente la re-medición del riesgo, que corresponde en estricto rigor a la primera parte del paso cinco. Esto es necesario para ir evaluando si es necesario aplicar métodos adicionales o distintos.</p>
<div id="primer-conjunto-de-métodos-sdc" class="section level3 hasAnchor" number="11.4.1">
<h3><span class="header-section-number">11.4.1</span> Primer conjunto de métodos SDC<a href="caso-de-estudio.html#primer-conjunto-de-métodos-sdc" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>El primer método a aplicar es la recodificación global para la variable de edad,pasando de semi continua a ordinal. Los tramos etarios escogidos corresponden a una adaptación más desagregada de los tramos etarios utilizados en la publicación de tabulados en versiones anteriores de la encuesta.</p>
<p>Se procede con este método primero dado que, por experiencia de los analistas de la encuesta, es uno de los que tiene mayor impacto en la reducción de riesgos.</p>
<p>Para ello, aplicamos la función <code>globalRecode()</code>. Esta función implementa el método de recodificación global descrito en la guía de anonimización. El método toma cuatro argumentos: el objeto SDC, la columna a recodificar, los límites de los intervalos a generar, y las etiquetas que debe asignar a cada tramo.</p>
<div class="example">
<p><span id="exm:bloque53nbm" class="example"><strong>Bloque 11.52  </strong></span>Recodificar edad</p>
</div>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="caso-de-estudio.html#cb266-1" aria-hidden="true" tabindex="-1"></a>sdcCombined <span class="ot">&lt;-</span> <span class="fu">globalRecode</span>(sdcCombined,</span>
<span id="cb266-2"><a href="caso-de-estudio.html#cb266-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">column =</span> <span class="st">&quot;rph_edad&quot;</span>,</span>
<span id="cb266-3"><a href="caso-de-estudio.html#cb266-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">breaks=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">14</span>,<span class="dv">19</span>,<span class="dv">24</span>,<span class="dv">29</span>,<span class="dv">39</span>,<span class="dv">49</span>,<span class="dv">59</span>,<span class="dv">69</span>,<span class="dv">79</span>,<span class="dv">89</span>,<span class="dv">120</span>),</span>
<span id="cb266-4"><a href="caso-de-estudio.html#cb266-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">labels=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>)</span></code></pre></div>
<p>Alternativamente, se podría simplemente haber ocupado otras funciones de <code>R base</code> o de <code>Tidyverse</code> para recodificar esta variable en tramos, como, por ejemplo, las funciones <code>ifelse()</code> o <code>case_when()</code>. Sin embargo, esta aproximación tiene la desventaja de que requiere generar nuevamente el objeto SDC por completo, por lo que se pierde la trazabilidad de las ediciones realizadas y de la reducción del riesgo desde la línea base inicial. Por este motivo, es que se recomienda usar <code>globalRecode()</code>.</p>
<p>Luego de haber aplicado este método SDC, procedemos a medir el impacto de esta modificación en las medidas de riesgo.</p>
</div>
<div id="re-medición-del-riesgo-para-primer-conjunto-de-métodos" class="section level3 hasAnchor" number="11.4.2">
<h3><span class="header-section-number">11.4.2</span> Re-medición del riesgo para primer conjunto de métodos<a href="caso-de-estudio.html#re-medición-del-riesgo-para-primer-conjunto-de-métodos" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Primero, revisamos las medidas globales de riesgo con los datos tratados. Se observa una mejora en los resultados, llegando nuevamente a umbrales aceptables (&lt;10%). No obstante, es necesario revisar el resto de las métricas, donde se está más lejos de cumplir con los estándares requeridos.</p>
<div class="example">
<p><span id="exm:bloque54nbm" class="example"><strong>Bloque 11.53  </strong></span>Riesgo global</p>
</div>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="caso-de-estudio.html#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sdcCombined, <span class="st">&quot;risk&quot;</span>)</span></code></pre></div>
<pre><code>## Risk measures:
## 
## Number of observations with higher risk than the main part of the data: 
##   in modified data: 2169
##   in original data: 3108
## Expected number of re-identifications: 
##   in modified data: 1488.69 (3.14 %)
##   in original data: 2048.36 (4.33 %)
## 
## Information on hierarchical risk:
## Expected number of re-identifications: 
##   in modified data: 4006.48 (8.46 %)
##   in original data: 5412.30 (11.43 %)
## ----------------------------------------------------------------------</code></pre>
<p>Ahora medimos el riesgo de manera individual. Se observa que 8.759 de los casos tiene un riesgo superior al 1%. Al filtrar por porcentajes de riesgo más alto, se observa aún una cantidad menor de observaciones con riesgo altísimo, con 52 observaciones con riesgo superior al 50%, lo que aún es demasiado alto.</p>
<div class="example">
<p><span id="exm:bloque55nbm" class="example"><strong>Bloque 11.54  </strong></span>Riesgo individual</p>
</div>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="caso-de-estudio.html#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Observaciones con riesgo individual superior al 1%:</span></span>
<span id="cb269-2"><a href="caso-de-estudio.html#cb269-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(fileCombined[sdcCombined<span class="sc">@</span>risk<span class="sc">$</span>individual[, <span class="st">&quot;risk&quot;</span>] <span class="sc">&gt;</span> <span class="fl">0.01</span>,])</span></code></pre></div>
<pre><code>## [1] 30922</code></pre>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="caso-de-estudio.html#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Observaciones con riesgo individual superior al 5%:</span></span>
<span id="cb271-2"><a href="caso-de-estudio.html#cb271-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(fileCombined[sdcCombined<span class="sc">@</span>risk<span class="sc">$</span>individual[, <span class="st">&quot;risk&quot;</span>] <span class="sc">&gt;</span> <span class="fl">0.05</span>,])</span></code></pre></div>
<pre><code>## [1] 6169</code></pre>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="caso-de-estudio.html#cb273-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Observaciones con riesgo individual superior al 25%:</span></span>
<span id="cb273-2"><a href="caso-de-estudio.html#cb273-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(fileCombined[sdcCombined<span class="sc">@</span>risk<span class="sc">$</span>individual[, <span class="st">&quot;risk&quot;</span>] <span class="sc">&gt;</span> <span class="fl">0.25</span>,])</span></code></pre></div>
<pre><code>## [1] 569</code></pre>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="caso-de-estudio.html#cb275-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Observaciones con riesgo individual superior al 50%:</span></span>
<span id="cb275-2"><a href="caso-de-estudio.html#cb275-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(fileCombined[sdcCombined<span class="sc">@</span>risk<span class="sc">$</span>individual[, <span class="st">&quot;risk&quot;</span>] <span class="sc">&gt;</span> <span class="fl">0.5</span>,])</span></code></pre></div>
<pre><code>## [1] 189</code></pre>
<p>Revisamos el k-anonimato para los casos a nivel muestral. Aún se observa un muy alto porcentaje de casos que incumplen el 2-anonimato.</p>
<div class="example">
<p><span id="exm:bloque56nbm" class="example"><strong>Bloque 11.55  </strong></span>K-anonimato</p>
</div>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="caso-de-estudio.html#cb277-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sdcCombined)</span></code></pre></div>
<pre><code>## Infos on 2/3-Anonymity:
## 
## Number of observations violating
##   - 2-anonymity: 31932 (67.447%) | in original data: 45168 (95.404%)
##   - 3-anonymity: 40354 (85.236%) | in original data: 47222 (99.742%)
##   - 5-anonymity: 45431 (95.959%) | in original data: 47344 (100.000%)
## 
## ----------------------------------------------------------------------</code></pre>
<p>Luego medimos el <em>l-diversity</em>, donde observamos mejores valores que se alejan de 1, para las tres variables sensibles.</p>
<div class="example">
<p><span id="exm:bloque57nbm" class="example"><strong>Bloque 11.56  </strong></span>L-diveristy</p>
</div>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="caso-de-estudio.html#cb279-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generamos el objeto de l-diversity</span></span>
<span id="cb279-2"><a href="caso-de-estudio.html#cb279-2" aria-hidden="true" tabindex="-1"></a>med_riesgo <span class="ot">&lt;-</span> <span class="fu">ldiversity</span>(sdcCombined, <span class="at">ldiv_index =</span> sensibles,</span>
<span id="cb279-3"><a href="caso-de-estudio.html#cb279-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">l_recurs_c =</span> <span class="dv">2</span>, <span class="at">missing =</span> <span class="cn">NA</span>)</span>
<span id="cb279-4"><a href="caso-de-estudio.html#cb279-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb279-5"><a href="caso-de-estudio.html#cb279-5" aria-hidden="true" tabindex="-1"></a><span class="co"># revisamos las medidas de riesgo de l-diversity</span></span>
<span id="cb279-6"><a href="caso-de-estudio.html#cb279-6" aria-hidden="true" tabindex="-1"></a>med_riesgo<span class="sc">@</span>risk<span class="sc">$</span>ldiversity</span></code></pre></div>
<pre><code>## --------------------------</code></pre>
<pre><code>## L-Diversity Measures</code></pre>
<pre><code>## --------------------------</code></pre>
<pre><code>##  P17_Distinct_Ldiversity P24_Distinct_Ldiversity DEN_AGREG_Distinct_Ldiversity
##  Min.   :1.000           Min.   :1.000           Min.   :1.000                
##  1st Qu.:1.000           1st Qu.:1.000           1st Qu.:1.000                
##  Median :1.000           Median :1.000           Median :1.000                
##  Mean   :1.219           Mean   :1.252           Mean   :1.229                
##  3rd Qu.:1.000           3rd Qu.:1.000           3rd Qu.:1.000                
##  Max.   :6.000           Max.   :6.000           Max.   :6.000</code></pre>
<p>En conclusión, si bien se cumplen los umbrales a nivel global, los umbrales a nivel individual y el k-anonimato nos indican que se requiere aplicar más métodos SDC para asegurar la anonimización de los datos.</p>
</div>
<div id="segundo-conjunto-de-métodos-sdc" class="section level3 hasAnchor" number="11.4.3">
<h3><span class="header-section-number">11.4.3</span> Segundo conjunto de métodos SDC<a href="caso-de-estudio.html#segundo-conjunto-de-métodos-sdc" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>El hecho de estar aplicando nuevamente el paso 4 nos indica una característica fundamental de los procesos de anonimización, que es que estos son procesos iterativos, donde es necesario ir aplicando métodos progresivamente y monitorear los niveles de riesgo en cada iteración. Como veremos en este ejercicio aplicado, serán varias iteraciones antes de llegar a un resultado satisfactorio de niveles de riesgo.</p>
<p>Retomando el proceso, el segundo método a aplicar es la eliminación de la variable de comuna. En cambio, se incluye la variable de región, ya que deja de ser redundante. Esto, dado que previamente se había retirado en el paso de consolidación de variables puesto que la comuna es una variable anidada en la variable de región.</p>
<p>Los pasos aplicados en el siguiente bloque de código son los mismos que se aplicaron la primera vez que se construyó el objeto <code>sdcCombined</code>. La única diferencia es que se reemplaza la variable <code>enc_rpc</code> por <code>enc_region</code> dentro del vector de variables clave <code>selectedKeyVarsIND</code>.</p>
<div class="example">
<p><span id="exm:bloque58nbm" class="example"><strong>Bloque 11.57  </strong></span>Reconstruir el objeto SDC a nivel persona con variable región</p>
</div>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="caso-de-estudio.html#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Se indican variables clave (nivel individual)</span></span>
<span id="cb284-2"><a href="caso-de-estudio.html#cb284-2" aria-hidden="true" tabindex="-1"></a>selectedKeyVarsIND <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;enc_region&#39;</span>,</span>
<span id="cb284-3"><a href="caso-de-estudio.html#cb284-3" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;rph_edad&#39;</span>,</span>
<span id="cb284-4"><a href="caso-de-estudio.html#cb284-4" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;rph_sexo&#39;</span>,</span>
<span id="cb284-5"><a href="caso-de-estudio.html#cb284-5" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;rph_idgen&#39;</span>,</span>
<span id="cb284-6"><a href="caso-de-estudio.html#cb284-6" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;rph_pertenencia_indigena&#39;</span>, </span>
<span id="cb284-7"><a href="caso-de-estudio.html#cb284-7" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&#39;rph_nacionalidad&#39;</span>,</span>
<span id="cb284-8"><a href="caso-de-estudio.html#cb284-8" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&#39;rph_situacion_ocupacional&#39;</span>) </span>
<span id="cb284-9"><a href="caso-de-estudio.html#cb284-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-10"><a href="caso-de-estudio.html#cb284-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Se indica factor de expansión de personas</span></span>
<span id="cb284-11"><a href="caso-de-estudio.html#cb284-11" aria-hidden="true" tabindex="-1"></a>WeightVarIND <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;Fact_Ind&#39;</span>)</span>
<span id="cb284-12"><a href="caso-de-estudio.html#cb284-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-13"><a href="caso-de-estudio.html#cb284-13" aria-hidden="true" tabindex="-1"></a><span class="co"># ID Hogares</span></span>
<span id="cb284-14"><a href="caso-de-estudio.html#cb284-14" aria-hidden="true" tabindex="-1"></a>selectedHouseholdID <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;enc_idr&#39;</span>)</span>
<span id="cb284-15"><a href="caso-de-estudio.html#cb284-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-16"><a href="caso-de-estudio.html#cb284-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Recombinación de conjuntos de datos HH anónimos y variables de nivel individuales</span></span>
<span id="cb284-17"><a href="caso-de-estudio.html#cb284-17" aria-hidden="true" tabindex="-1"></a>indVars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;enc_idr&quot;</span>, <span class="st">&quot;rph_ID&quot;</span>, selectedKeyVarsIND,WeightVarIND,sensibles) <span class="co"># HID and all non HH variables</span></span>
<span id="cb284-18"><a href="caso-de-estudio.html#cb284-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-19"><a href="caso-de-estudio.html#cb284-19" aria-hidden="true" tabindex="-1"></a>fileInd <span class="ot">&lt;-</span> file[indVars] <span class="co"># subset of file without HHVars</span></span>
<span id="cb284-20"><a href="caso-de-estudio.html#cb284-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-21"><a href="caso-de-estudio.html#cb284-21" aria-hidden="true" tabindex="-1"></a>fileCombined <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">inner_join</span>(fileInd, <span class="fu">select</span>(fileHH, <span class="sc">-</span>enc_rpc), <span class="at">by=</span> <span class="fu">c</span>(<span class="st">&#39;enc_idr&#39;</span>))</span>
<span id="cb284-22"><a href="caso-de-estudio.html#cb284-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-23"><a href="caso-de-estudio.html#cb284-23" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(fileCombined)</span></code></pre></div>
<pre><code>## [1] 47344    15</code></pre>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="caso-de-estudio.html#cb286-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Objetos SDC con todas las variables y variables HH tratadas para</span></span>
<span id="cb286-2"><a href="caso-de-estudio.html#cb286-2" aria-hidden="true" tabindex="-1"></a><span class="co"># anonimización de variables de nivel individual</span></span>
<span id="cb286-3"><a href="caso-de-estudio.html#cb286-3" aria-hidden="true" tabindex="-1"></a>sdcCombined <span class="ot">&lt;-</span> <span class="fu">createSdcObj</span>(<span class="at">dat =</span> fileCombined, <span class="at">keyVars =</span> selectedKeyVarsIND,</span>
<span id="cb286-4"><a href="caso-de-estudio.html#cb286-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">hhId =</span> selectedHouseholdID, <span class="at">weightVar =</span> WeightVarIND,</span>
<span id="cb286-5"><a href="caso-de-estudio.html#cb286-5" aria-hidden="true" tabindex="-1"></a>                            <span class="at">sensibleVar =</span> sensibles)</span></code></pre></div>
<p>Además, como en este caso fue necesario crear nuevamente el objeto SDC, hay que aplicar nuevamente la recodificación de la variable edad con la función <code>globalRecode()</code>.</p>
<div class="example">
<p><span id="exm:bloque59nbm" class="example"><strong>Bloque 11.58  </strong></span>Recodificar edad nuevamente</p>
</div>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="caso-de-estudio.html#cb287-1" aria-hidden="true" tabindex="-1"></a>sdcCombined <span class="ot">&lt;-</span> <span class="fu">globalRecode</span>(sdcCombined,</span>
<span id="cb287-2"><a href="caso-de-estudio.html#cb287-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">column =</span> <span class="st">&quot;rph_edad&quot;</span>,</span>
<span id="cb287-3"><a href="caso-de-estudio.html#cb287-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">breaks=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">14</span>,<span class="dv">19</span>,<span class="dv">24</span>,<span class="dv">29</span>,<span class="dv">39</span>,<span class="dv">49</span>,<span class="dv">59</span>,<span class="dv">69</span>,<span class="dv">79</span>,<span class="dv">89</span>,<span class="dv">120</span>),</span>
<span id="cb287-4"><a href="caso-de-estudio.html#cb287-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">labels=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>)</span></code></pre></div>
</div>
<div id="re-medición-del-riesgo-para-segundo-conjunto-de-métodos" class="section level3 hasAnchor" number="11.4.4">
<h3><span class="header-section-number">11.4.4</span> Re-medición del riesgo para segundo conjunto de métodos<a href="caso-de-estudio.html#re-medición-del-riesgo-para-segundo-conjunto-de-métodos" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Nuevamente, revisamos las medidas globales de riesgo. Se observa que a nivel global obtenemos valores aceptables de riesgo, ya que se habían logrado en la primera iteración.</p>
<div class="example">
<p><span id="exm:bloque60nbm" class="example"><strong>Bloque 11.59  </strong></span>Riesgo global</p>
</div>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="caso-de-estudio.html#cb288-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sdcCombined, <span class="st">&quot;risk&quot;</span>)</span></code></pre></div>
<pre><code>## Risk measures:
## 
## Number of observations with higher risk than the main part of the data: 
##   in modified data: 1035
##   in original data: 2471
## Expected number of re-identifications: 
##   in modified data: 762.14 (1.61 %)
##   in original data: 1683.54 (3.56 %)
## 
## Information on hierarchical risk:
## Expected number of re-identifications: 
##   in modified data: 2216.99 (4.68 %)
##   in original data: 4524.60 (9.56 %)
## ----------------------------------------------------------------------</code></pre>
<p>Ahora medimos el riesgo de manera individual. Se observa que 2.902 de los casos presentan un riesgo superior al 1%, lo que aún cumple el umbral establecido, que indica el 20% de los casos. Por otro lado, se observa que 517 de las personas presentan un riesgo mayor al 5%, lo que cumple con el umbral (no más de 15%). Por otro lado, se observa que 50 y un 17 de los casos tienen riesgos superiores al 25% y 50%, respectivamente. Esto incumple con los umbrales establecidos ya que se espera que no haya observaciones con estos niveles de riesgo.</p>
<div class="example">
<p><span id="exm:bloque61nbm" class="example"><strong>Bloque 11.60  </strong></span>Riesgo individual</p>
</div>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="caso-de-estudio.html#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Observaciones con riesgo individual superior al 1%:</span></span>
<span id="cb290-2"><a href="caso-de-estudio.html#cb290-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(fileCombined[sdcCombined<span class="sc">@</span>risk<span class="sc">$</span>individual[, <span class="st">&quot;risk&quot;</span>] <span class="sc">&gt;</span> <span class="fl">0.01</span>,])</span></code></pre></div>
<pre><code>## [1] 15463</code></pre>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="caso-de-estudio.html#cb292-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Observaciones con riesgo individual superior al 5%:</span></span>
<span id="cb292-2"><a href="caso-de-estudio.html#cb292-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(fileCombined[sdcCombined<span class="sc">@</span>risk<span class="sc">$</span>individual[, <span class="st">&quot;risk&quot;</span>] <span class="sc">&gt;</span> <span class="fl">0.05</span>,])</span></code></pre></div>
<pre><code>## [1] 3000</code></pre>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="caso-de-estudio.html#cb294-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Observaciones con riesgo individual superior al 25%:</span></span>
<span id="cb294-2"><a href="caso-de-estudio.html#cb294-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(fileCombined[sdcCombined<span class="sc">@</span>risk<span class="sc">$</span>individual[, <span class="st">&quot;risk&quot;</span>] <span class="sc">&gt;</span> <span class="fl">0.25</span>,])</span></code></pre></div>
<pre><code>## [1] 286</code></pre>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="caso-de-estudio.html#cb296-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Observaciones con riesgo individual superior al 50%:</span></span>
<span id="cb296-2"><a href="caso-de-estudio.html#cb296-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(fileCombined[sdcCombined<span class="sc">@</span>risk<span class="sc">$</span>individual[, <span class="st">&quot;risk&quot;</span>] <span class="sc">&gt;</span> <span class="fl">0.5</span>,])</span></code></pre></div>
<pre><code>## [1] 92</code></pre>
<p>Revisamos el k-anonimato para los casos no ponderados, es decir a nivel muestral. Aún hay 2.886 casos que incumplen el 2-anonimato.</p>
<div class="example">
<p><span id="exm:bloque62nbm" class="example"><strong>Bloque 11.61  </strong></span>K-anonimato</p>
</div>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="caso-de-estudio.html#cb298-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sdcCombined)</span></code></pre></div>
<pre><code>## Infos on 2/3-Anonymity:
## 
## Number of observations violating
##   - 2-anonymity: 15773 (33.316%) | in original data: 36576 (77.256%)
##   - 3-anonymity: 22691 (47.928%) | in original data: 44316 (93.604%)
##   - 5-anonymity: 31934 (67.451%) | in original data: 47047 (99.373%)
## 
## ----------------------------------------------------------------------</code></pre>
<p>Luego medimos el <em>l-diversity</em>. Se observa una importante mejora en el <em>l-diversity</em>, al observarse ahora una diversidad de 30 en promedio para las distintas combinaciones de variables clave en relación con las variables sensibles.</p>
<div class="example">
<p><span id="exm:bloque63nbm" class="example"><strong>Bloque 11.62  </strong></span>L-diversity</p>
</div>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="caso-de-estudio.html#cb300-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generamos el objeto de l-diversity</span></span>
<span id="cb300-2"><a href="caso-de-estudio.html#cb300-2" aria-hidden="true" tabindex="-1"></a>med_riesgo <span class="ot">&lt;-</span> <span class="fu">ldiversity</span>(sdcCombined, <span class="at">ldiv_index =</span> sensibles,</span>
<span id="cb300-3"><a href="caso-de-estudio.html#cb300-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">l_recurs_c =</span> <span class="dv">2</span>, <span class="at">missing =</span> <span class="cn">NA</span>)</span>
<span id="cb300-4"><a href="caso-de-estudio.html#cb300-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb300-5"><a href="caso-de-estudio.html#cb300-5" aria-hidden="true" tabindex="-1"></a><span class="co"># revisamos las medidas de riesgo de l-diversity</span></span>
<span id="cb300-6"><a href="caso-de-estudio.html#cb300-6" aria-hidden="true" tabindex="-1"></a>med_riesgo<span class="sc">@</span>risk<span class="sc">$</span>ldiversity</span></code></pre></div>
<pre><code>## --------------------------</code></pre>
<pre><code>## L-Diversity Measures</code></pre>
<pre><code>## --------------------------</code></pre>
<pre><code>##  P17_Distinct_Ldiversity P24_Distinct_Ldiversity DEN_AGREG_Distinct_Ldiversity
##  Min.   : 1.0            Min.   : 1.0            Min.   : 1.00                
##  1st Qu.: 1.0            1st Qu.: 1.0            1st Qu.: 1.00                
##  Median : 1.0            Median : 2.0            Median : 1.00                
##  Mean   : 2.2            Mean   : 2.4            Mean   : 2.27                
##  3rd Qu.: 3.0            3rd Qu.: 3.0            3rd Qu.: 3.00                
##  Max.   :13.0            Max.   :14.0            Max.   :13.00</code></pre>
<p>En suma, debido a que persiste cierto grado de riesgos individuales e incumplimiento de k-anonimato aún se requiere seguir aplicando métodos SDC.</p>
</div>
<div id="tercer-conjunto-de-métodos-sdc" class="section level3 hasAnchor" number="11.4.5">
<h3><span class="header-section-number">11.4.5</span> Tercer conjunto de métodos SDC<a href="caso-de-estudio.html#tercer-conjunto-de-métodos-sdc" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Como tercera iteración, se aplican varios métodos para poder reducir los riesgos individuales y el incumplimiento de 2-anonimato, que son las métricas que han presentado mayor dificultad para disminuir.</p>
<p>Primero, se recodifican globalmente las variables de pertenencia indígena y nacionalidad. Para esto se ocupa una función distinta, <code>groupAndRename()</code>, que permite también recodificar variables categóricas. También se fusionan categorías de situación laboral, lo que equivale a posteriormente eliminar la variable de razón de inactividad de la base de datos. Esto porque esta variable corresponde a una consolidación de variables (revisar paso 2.1.4).</p>
<div class="example">
<p><span id="exm:bloque64nbm" class="example"><strong>Bloque 11.63  </strong></span>Recodificar de variables</p>
</div>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="caso-de-estudio.html#cb305-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Recodificamos pertenencia indígena</span></span>
<span id="cb305-2"><a href="caso-de-estudio.html#cb305-2" aria-hidden="true" tabindex="-1"></a>sdcCombined <span class="ot">&lt;-</span> <span class="fu">groupAndRename</span>(sdcCombined, <span class="at">var=</span><span class="st">&quot;rph_pertenencia_indigena&quot;</span>,</span>
<span id="cb305-3"><a href="caso-de-estudio.html#cb305-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">before=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>), <span class="at">after=</span><span class="fu">c</span>(<span class="dv">1</span>))</span>
<span id="cb305-4"><a href="caso-de-estudio.html#cb305-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-5"><a href="caso-de-estudio.html#cb305-5" aria-hidden="true" tabindex="-1"></a>sdcCombined <span class="ot">&lt;-</span> <span class="fu">groupAndRename</span>(sdcCombined, <span class="at">var=</span><span class="st">&quot;rph_pertenencia_indigena&quot;</span>,</span>
<span id="cb305-6"><a href="caso-de-estudio.html#cb305-6" aria-hidden="true" tabindex="-1"></a>                              <span class="at">before=</span><span class="fu">c</span>(<span class="dv">11</span>), <span class="at">after=</span><span class="fu">c</span>(<span class="dv">2</span>))</span>
<span id="cb305-7"><a href="caso-de-estudio.html#cb305-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-8"><a href="caso-de-estudio.html#cb305-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Recodificamos nacionalidad</span></span>
<span id="cb305-9"><a href="caso-de-estudio.html#cb305-9" aria-hidden="true" tabindex="-1"></a>sdcCombined <span class="ot">&lt;-</span> <span class="fu">groupAndRename</span>(sdcCombined, <span class="at">var=</span><span class="st">&quot;rph_nacionalidad&quot;</span>,</span>
<span id="cb305-10"><a href="caso-de-estudio.html#cb305-10" aria-hidden="true" tabindex="-1"></a>                              <span class="at">before=</span><span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">9</span>), <span class="at">after=</span><span class="fu">c</span>(<span class="dv">2</span>))</span>
<span id="cb305-11"><a href="caso-de-estudio.html#cb305-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-12"><a href="caso-de-estudio.html#cb305-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Recodificamos situacion_ocupacional</span></span>
<span id="cb305-13"><a href="caso-de-estudio.html#cb305-13" aria-hidden="true" tabindex="-1"></a>sdcCombined <span class="ot">&lt;-</span> <span class="fu">groupAndRename</span>(sdcCombined, <span class="at">var=</span><span class="st">&quot;rph_situacion_ocupacional&quot;</span>,</span>
<span id="cb305-14"><a href="caso-de-estudio.html#cb305-14" aria-hidden="true" tabindex="-1"></a>                              <span class="at">before=</span><span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>), <span class="at">after=</span><span class="fu">c</span>(<span class="dv">3</span>))</span></code></pre></div>
<p>Luego, se aplica supresión local en las variables de menor prioridad. Se seleccionan estas variables cuidadosamente, dado que se aplicará un método drástico como es la supresión local, teniendo como criterio las propiedades estadísticas que se buscan preservar en la base de datos.</p>
<p>Por otro lado, los umbrales que se entregan como argumento a esta función en el parámetro <code>threshold</code> dependen de la data y se debe probar iterativamente hasta lograr los umbrales deseados. Se debe introducir en los argumentos umbrales de riesgo no tan bajos, evitando sobre-anonimizar, dado que esto nos llevaría a perder más utilidad de la necesaria. En este caso, se indican umbrales de 0.1, es decir, del 10% de riesgo individual como objetivo.</p>
<div class="example">
<p><span id="exm:bloque65nbm" class="example"><strong>Bloque 11.64  </strong></span>Supresión local</p>
</div>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="caso-de-estudio.html#cb306-1" aria-hidden="true" tabindex="-1"></a><span class="co"># supresión local para riesgos globales e individuales</span></span>
<span id="cb306-2"><a href="caso-de-estudio.html#cb306-2" aria-hidden="true" tabindex="-1"></a>sdcCombined <span class="ot">&lt;-</span> <span class="fu">localSupp</span>(sdcCombined, <span class="at">keyVar=</span><span class="st">&#39;rph_idgen&#39;</span>, <span class="at">threshold=</span><span class="fl">0.01</span>)</span>
<span id="cb306-3"><a href="caso-de-estudio.html#cb306-3" aria-hidden="true" tabindex="-1"></a>sdcCombined <span class="ot">&lt;-</span> <span class="fu">localSupp</span>(sdcCombined, <span class="at">keyVar=</span><span class="st">&#39;rph_pertenencia_indigena&#39;</span>, <span class="at">threshold=</span><span class="fl">0.01</span>)</span>
<span id="cb306-4"><a href="caso-de-estudio.html#cb306-4" aria-hidden="true" tabindex="-1"></a>sdcCombined <span class="ot">&lt;-</span> <span class="fu">localSupp</span>(sdcCombined, <span class="at">keyVar=</span><span class="st">&#39;rph_nacionalidad&#39;</span>, <span class="at">threshold=</span><span class="fl">0.01</span>)</span>
<span id="cb306-5"><a href="caso-de-estudio.html#cb306-5" aria-hidden="true" tabindex="-1"></a>sdcCombined <span class="ot">&lt;-</span> <span class="fu">localSupp</span>(sdcCombined, <span class="at">keyVar=</span><span class="st">&#39;rph_situacion_ocupacional&#39;</span>, <span class="at">threshold=</span><span class="fl">0.01</span>)</span>
<span id="cb306-6"><a href="caso-de-estudio.html#cb306-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb306-7"><a href="caso-de-estudio.html#cb306-7" aria-hidden="true" tabindex="-1"></a>sdcCombined <span class="ot">&lt;-</span> <span class="fu">localSuppression</span>(sdcCombined,<span class="at">importance =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>, <span class="at">k =</span> <span class="dv">2</span>)</span></code></pre></div>
<p>Como veremos en el siguiente paso,los métodos aplicados en esta tercera iteración logran alcanzar los umbrales requeridos. Con esto, podemos pasar al Paso Cinco y evaluar de forma completa el proceso SDC, consirando tanto la evaluación del riesgo como de la utilidad.</p>
</div>
</div>
<div id="paso-cinco-evaluar-proceso-sdc" class="section level2 hasAnchor" number="11.5">
<h2><span class="header-section-number">11.5</span> Paso Cinco: Evaluar proceso SDC<a href="caso-de-estudio.html#paso-cinco-evaluar-proceso-sdc" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="re-medición-del-riesgo" class="section level3 hasAnchor" number="11.5.1">
<h3><span class="header-section-number">11.5.1</span> Re-medición del riesgo<a href="caso-de-estudio.html#re-medición-del-riesgo" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Primero, revisamos las medidas globales de riesgo. Se observa, valores mucho menores de riesgo global, aun cuando esto ya cumplía previamente con los niveles esperados.</p>
<div class="example">
<p><span id="exm:bloque66nbm" class="example"><strong>Bloque 11.65  </strong></span>Riesgo global</p>
</div>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="caso-de-estudio.html#cb307-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sdcCombined, <span class="st">&quot;risk&quot;</span>)</span></code></pre></div>
<pre><code>## Risk measures:
## 
## Number of observations with higher risk than the main part of the data: 
##   in modified data: 0
##   in original data: 2471
## Expected number of re-identifications: 
##   in modified data: 25.14 (0.05 %)
##   in original data: 1683.54 (3.56 %)
## 
## Information on hierarchical risk:
## Expected number of re-identifications: 
##   in modified data: 73.90 (0.16 %)
##   in original data: 4524.60 (9.56 %)
## ----------------------------------------------------------------------</code></pre>
<p>Ahora medimos el riesgo de manera individual. Se observa que no hay casos que excedan estos niveles de riesgo luego de los últimos tratamientos a los datos.</p>
<div class="example">
<p><span id="exm:bloque67nbm" class="example"><strong>Bloque 11.66  </strong></span>Riesgo individual</p>
</div>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="caso-de-estudio.html#cb309-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Observaciones con riesgo individual superior al 1%:</span></span>
<span id="cb309-2"><a href="caso-de-estudio.html#cb309-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(fileCombined[sdcCombined<span class="sc">@</span>risk<span class="sc">$</span>individual[, <span class="st">&quot;risk&quot;</span>] <span class="sc">&gt;</span> <span class="fl">0.01</span>,])</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="caso-de-estudio.html#cb311-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Observaciones con riesgo individual superior al 5%:</span></span>
<span id="cb311-2"><a href="caso-de-estudio.html#cb311-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(fileCombined[sdcCombined<span class="sc">@</span>risk<span class="sc">$</span>individual[, <span class="st">&quot;risk&quot;</span>] <span class="sc">&gt;</span> <span class="fl">0.05</span>,])</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="caso-de-estudio.html#cb313-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Observaciones con riesgo individual superior al 25%:</span></span>
<span id="cb313-2"><a href="caso-de-estudio.html#cb313-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(fileCombined[sdcCombined<span class="sc">@</span>risk<span class="sc">$</span>individual[, <span class="st">&quot;risk&quot;</span>] <span class="sc">&gt;</span> <span class="fl">0.25</span>,])</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="caso-de-estudio.html#cb315-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Observaciones con riesgo individual superior al 50%:</span></span>
<span id="cb315-2"><a href="caso-de-estudio.html#cb315-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(fileCombined[sdcCombined<span class="sc">@</span>risk<span class="sc">$</span>individual[, <span class="st">&quot;risk&quot;</span>] <span class="sc">&gt;</span> <span class="fl">0.5</span>,])</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<p>Revisamos el k-anonimato para los casos ponderados. Ahora, no hay casos que violen ningún nivel de 2-anonimato y una cantidad aceptable de casos que incumplen el 3-anonimato y 5-anonimato, por lo que se cumpliría de buena forma lo planteado para estos umbrales.</p>
<div class="example">
<p><span id="exm:bloque68nbm" class="example"><strong>Bloque 11.67  </strong></span>K-anonimato</p>
</div>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="caso-de-estudio.html#cb317-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sdcCombined)</span></code></pre></div>
<pre><code>## Infos on 2/3-Anonymity:
## 
## Number of observations violating
##   - 2-anonymity: 0 (0.000%) | in original data: 36576 (77.256%)
##   - 3-anonymity: 1169 (2.469%) | in original data: 44316 (93.604%)
##   - 5-anonymity: 5373 (11.349%) | in original data: 47047 (99.373%)
## 
## ----------------------------------------------------------------------</code></pre>
<p>Luego medimos el <em>l-diversity</em>. Se observa que los valores de promedio y mediana de <em>l-diversity</em> son levemente superiores, lo que indican un menor nivel de riesgo de que el intruso logre acertar a los valores de las variables sensibles. Dado que se obtienen buenos resultados, se decide no proseguir con métodos SDC para no perder más utilidad de los datos.</p>
<div class="example">
<p><span id="exm:bloque69nbm" class="example"><strong>Bloque 11.68  </strong></span>L-diversity</p>
</div>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="caso-de-estudio.html#cb319-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generamos el objeto de l-diversity</span></span>
<span id="cb319-2"><a href="caso-de-estudio.html#cb319-2" aria-hidden="true" tabindex="-1"></a>med_riesgo <span class="ot">&lt;-</span> <span class="fu">ldiversity</span>(sdcCombined, <span class="at">ldiv_index =</span> sensibles,</span>
<span id="cb319-3"><a href="caso-de-estudio.html#cb319-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">l_recurs_c =</span> <span class="dv">2</span>, <span class="at">missing =</span> <span class="cn">NA</span>)</span>
<span id="cb319-4"><a href="caso-de-estudio.html#cb319-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb319-5"><a href="caso-de-estudio.html#cb319-5" aria-hidden="true" tabindex="-1"></a><span class="co"># revisamos las medidas de riesgo de l-diversity</span></span>
<span id="cb319-6"><a href="caso-de-estudio.html#cb319-6" aria-hidden="true" tabindex="-1"></a>med_riesgo<span class="sc">@</span>risk<span class="sc">$</span>ldiversity</span></code></pre></div>
<pre><code>## --------------------------</code></pre>
<pre><code>## L-Diversity Measures</code></pre>
<pre><code>## --------------------------</code></pre>
<pre><code>##  P17_Distinct_Ldiversity P24_Distinct_Ldiversity DEN_AGREG_Distinct_Ldiversity
##  Min.   : 1.00           Min.   : 1.00           Min.   : 1.00                
##  1st Qu.: 2.00           1st Qu.: 2.00           1st Qu.: 2.00                
##  Median : 7.00           Median : 8.00           Median : 8.00                
##  Mean   :11.12           Mean   :11.67           Mean   :11.48                
##  3rd Qu.:17.00           3rd Qu.:17.00           3rd Qu.:17.00                
##  Max.   :80.00           Max.   :81.00           Max.   :81.00</code></pre>
<p>Los resultados aquí expuestos cumplen con los umbrales, por lo que ahora corresponde volver a medir la utilidad.</p>
</div>
<div id="evaluar-proceso-sdc---volver-a-medir-utilidad" class="section level3 hasAnchor" number="11.5.2">
<h3><span class="header-section-number">11.5.2</span> Evaluar proceso SDC - Volver a medir utilidad<a href="caso-de-estudio.html#evaluar-proceso-sdc---volver-a-medir-utilidad" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="extracción-de-datos-tratados-y-medición-de-perdida-de-información." class="section level4 hasAnchor" number="11.5.2.1">
<h4><span class="header-section-number">11.5.2.1</span> Extracción de datos tratados y medición de perdida de información.<a href="caso-de-estudio.html#extracción-de-datos-tratados-y-medición-de-perdida-de-información." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Primero, extraemos la data tratada. Para ello se usa la función <code>extractManipData()</code>.</p>
<div class="example">
<p><span id="exm:bloque70nbm" class="example"><strong>Bloque 11.69  </strong></span>Extraer datos tratados</p>
</div>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="caso-de-estudio.html#cb324-1" aria-hidden="true" tabindex="-1"></a>fileTratada <span class="ot">&lt;-</span> <span class="fu">extractManipData</span>(sdcCombined)</span></code></pre></div>
<p>Luego evaluamos cuántos valores perdidos tenemos debido a la supresión local. Para ello, imprimimos el porcentaje de celdas perdidas pre y post anonimización.</p>
<p>Primero vemos que, por flujo algunas variables tienen celdas vacías. La comparación consiste en ver si luego estos porcentajes aumentan.</p>
<div class="example">
<p><span id="exm:bloque71nbm" class="example"><strong>Bloque 11.70  </strong></span>Celdas vacías previo a anomización</p>
</div>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="caso-de-estudio.html#cb325-1" aria-hidden="true" tabindex="-1"></a><span class="co"># % de celdas vacías pre-anonimización</span></span>
<span id="cb325-2"><a href="caso-de-estudio.html#cb325-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">names</span>(fileCombined))){</span>
<span id="cb325-3"><a href="caso-de-estudio.html#cb325-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">names</span>(fileCombined)[i])</span>
<span id="cb325-4"><a href="caso-de-estudio.html#cb325-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">sum</span>(<span class="fu">is.na</span>(fileCombined[[<span class="fu">names</span>(fileCombined)[i]]]))<span class="sc">/</span><span class="fu">nrow</span>(fileCombined)<span class="sc">*</span><span class="dv">100</span>)</span>
<span id="cb325-5"><a href="caso-de-estudio.html#cb325-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;enc_idr&quot;
## [1] 0
## [1] &quot;rph_ID&quot;
## [1] 0
## [1] &quot;enc_region&quot;
## [1] 0
## [1] &quot;rph_edad&quot;
## [1] 0
## [1] &quot;rph_sexo&quot;
## [1] 0
## [1] &quot;rph_idgen&quot;
## [1] 14.81075
## [1] &quot;rph_pertenencia_indigena&quot;
## [1] 0
## [1] &quot;rph_nacionalidad&quot;
## [1] 0
## [1] &quot;rph_situacion_ocupacional&quot;
## [1] 14.81075
## [1] &quot;Fact_Ind&quot;
## [1] 0
## [1] &quot;P17&quot;
## [1] 60.36245
## [1] &quot;P24&quot;
## [1] 60.36245
## [1] &quot;DEN_AGREG&quot;
## [1] 60.36245
## [1] &quot;IH_residencia_habitual&quot;
## [1] 0
## [1] &quot;Fact_Hog&quot;
## [1] 0</code></pre>
<p>Acá vemos los porcentajes de valores perdidos en los datos tratados. Vemos que en las variables de identidad de género (<code>rph_idgen</code>), pertenencia indígena (<code>rph_pertenencia_indigena</code>) y nacionalidad (<code>rph_nacionalidad</code>), hay un leve aumento de celdas en blanco. Esto es muy marginal, siendo menos de 2% de celdas vacías adicionales en identidad de género y menos de 1% adicional de celdas vacías en las otras dos variables. Además, se observa que para el caso de situación ocupacional (<code>rph_situacion_ocupacional</code>), el algoritmo de supresión local no eliminó valores, dado que los umbrales ya se habían cumplido.</p>
<div class="example">
<p><span id="exm:bloque72nbm" class="example"><strong>Bloque 11.71  </strong></span>Celdas vacías después de anomización</p>
</div>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="caso-de-estudio.html#cb327-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">names</span>(fileTratada))){</span>
<span id="cb327-2"><a href="caso-de-estudio.html#cb327-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">names</span>(fileTratada)[i])</span>
<span id="cb327-3"><a href="caso-de-estudio.html#cb327-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">sum</span>(<span class="fu">is.na</span>(fileTratada[[<span class="fu">names</span>(fileTratada)[i]]]))<span class="sc">/</span><span class="fu">nrow</span>(fileTratada)<span class="sc">*</span><span class="dv">100</span>)</span>
<span id="cb327-4"><a href="caso-de-estudio.html#cb327-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;enc_idr&quot;
## [1] 0
## [1] &quot;rph_ID&quot;
## [1] 0
## [1] &quot;enc_region&quot;
## [1] 0
## [1] &quot;rph_edad&quot;
## [1] 0
## [1] &quot;rph_sexo&quot;
## [1] 0
## [1] &quot;rph_idgen&quot;
## [1] 19.36254
## [1] &quot;rph_pertenencia_indigena&quot;
## [1] 1.341247
## [1] &quot;rph_nacionalidad&quot;
## [1] 0.3569618
## [1] &quot;rph_situacion_ocupacional&quot;
## [1] 14.91424
## [1] &quot;Fact_Ind&quot;
## [1] 0
## [1] &quot;P17&quot;
## [1] 60.36245
## [1] &quot;P24&quot;
## [1] 60.36245
## [1] &quot;DEN_AGREG&quot;
## [1] 60.36245
## [1] &quot;IH_residencia_habitual&quot;
## [1] 0
## [1] &quot;Fact_Hog&quot;
## [1] 0</code></pre>
<p>En el resto de las variables, no hay pérdida de información.</p>
</div>
<div id="propiedades-estadísticas-priorizadas" class="section level4 hasAnchor" number="11.5.2.2">
<h4><span class="header-section-number">11.5.2.2</span> Propiedades estadísticas priorizadas<a href="caso-de-estudio.html#propiedades-estadísticas-priorizadas" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Ahora, se procede a evaluar si se mantienen las propiedades estadísticas priorizadas de los datos.</p>
<p>Primero, se genera una variable de edad a partir de la marca de clase de los tramos etarios, para evaluar si se mantiene la relación con los indicadores principales. Esto no se evaluará inmediatamente, pero se genera para uso posterior. Es importante aclarar que esta recodificación se realiza solo con fines analíticos para determinar la utilidad de los datos anonimizados, no siendo utilizada para los datos a liberar (en estos se mantienen los tramos etarios).</p>
<div class="example">
<p><span id="exm:bloque73nbm" class="example"><strong>Bloque 11.72  </strong></span>Generar variable de marcas de clase de edad</p>
</div>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="caso-de-estudio.html#cb329-1" aria-hidden="true" tabindex="-1"></a>fileTratada<span class="sc">$</span>rph_edad_mc <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb329-2"><a href="caso-de-estudio.html#cb329-2" aria-hidden="true" tabindex="-1"></a>  fileTratada<span class="sc">$</span>rph_edad <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="fl">7.5</span>,</span>
<span id="cb329-3"><a href="caso-de-estudio.html#cb329-3" aria-hidden="true" tabindex="-1"></a>  fileTratada<span class="sc">$</span>rph_edad <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="dv">17</span>,</span>
<span id="cb329-4"><a href="caso-de-estudio.html#cb329-4" aria-hidden="true" tabindex="-1"></a>  fileTratada<span class="sc">$</span>rph_edad <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="dv">22</span>,</span>
<span id="cb329-5"><a href="caso-de-estudio.html#cb329-5" aria-hidden="true" tabindex="-1"></a>  fileTratada<span class="sc">$</span>rph_edad <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="dv">27</span>,</span>
<span id="cb329-6"><a href="caso-de-estudio.html#cb329-6" aria-hidden="true" tabindex="-1"></a>  fileTratada<span class="sc">$</span>rph_edad <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="fl">34.5</span>,</span>
<span id="cb329-7"><a href="caso-de-estudio.html#cb329-7" aria-hidden="true" tabindex="-1"></a>  fileTratada<span class="sc">$</span>rph_edad <span class="sc">==</span> <span class="dv">6</span> <span class="sc">~</span> <span class="fl">44.5</span>,</span>
<span id="cb329-8"><a href="caso-de-estudio.html#cb329-8" aria-hidden="true" tabindex="-1"></a>  fileTratada<span class="sc">$</span>rph_edad <span class="sc">==</span> <span class="dv">7</span> <span class="sc">~</span> <span class="fl">54.5</span>,</span>
<span id="cb329-9"><a href="caso-de-estudio.html#cb329-9" aria-hidden="true" tabindex="-1"></a>  fileTratada<span class="sc">$</span>rph_edad <span class="sc">==</span> <span class="dv">8</span> <span class="sc">~</span> <span class="fl">64.5</span>,</span>
<span id="cb329-10"><a href="caso-de-estudio.html#cb329-10" aria-hidden="true" tabindex="-1"></a>  fileTratada<span class="sc">$</span>rph_edad <span class="sc">==</span> <span class="dv">9</span> <span class="sc">~</span> <span class="fl">74.5</span>,</span>
<span id="cb329-11"><a href="caso-de-estudio.html#cb329-11" aria-hidden="true" tabindex="-1"></a>  fileTratada<span class="sc">$</span>rph_edad <span class="sc">==</span> <span class="dv">10</span> <span class="sc">~</span> <span class="fl">84.5</span>,</span>
<span id="cb329-12"><a href="caso-de-estudio.html#cb329-12" aria-hidden="true" tabindex="-1"></a>  fileTratada<span class="sc">$</span>rph_edad <span class="sc">==</span> <span class="dv">11</span> <span class="sc">~</span> <span class="dv">90</span></span>
<span id="cb329-13"><a href="caso-de-estudio.html#cb329-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb329-14"><a href="caso-de-estudio.html#cb329-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-15"><a href="caso-de-estudio.html#cb329-15" aria-hidden="true" tabindex="-1"></a>fileTratada<span class="sc">$</span>rph_edad_mc <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(fileTratada<span class="sc">$</span>rph_edad_mc)</span>
<span id="cb329-16"><a href="caso-de-estudio.html#cb329-16" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(fileTratada<span class="sc">$</span>rph_edad_mc)</span></code></pre></div>
<pre><code>## 
##  7.5   17   22   27 34.5 44.5 54.5 64.5 74.5 84.5   90 
## 7012 2216 2228 2114 4324 4282 4274 4304 4397 4348 7845</code></pre>
<p>Luego, se pegan las variables de diseño muestral e indicadores a evaluar, ya que no se encuentran dentro del conjunto de datos con que se trabajó durante el proceso de anonimización.</p>
<div class="example">
<p><span id="exm:bloque74nbm" class="example"><strong>Bloque 11.73  </strong></span>Añadir variables de diseño muestral</p>
</div>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="caso-de-estudio.html#cb331-1" aria-hidden="true" tabindex="-1"></a>fileTratada <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(fileTratada,</span>
<span id="cb331-2"><a href="caso-de-estudio.html#cb331-2" aria-hidden="true" tabindex="-1"></a>                                file[,<span class="fu">c</span>(<span class="st">&#39;rph_ID&#39;</span>,<span class="st">&#39;Fact_Pers&#39;</span>,<span class="st">&#39;Fact_Hog&#39;</span>,</span>
<span id="cb331-3"><a href="caso-de-estudio.html#cb331-3" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">&#39;Conglomerado&#39;</span>,<span class="st">&#39;VarStrat&#39;</span>,</span>
<span id="cb331-4"><a href="caso-de-estudio.html#cb331-4" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">&#39;VA_DC&#39;</span>,<span class="st">&#39;VP_DC&#39;</span>,<span class="st">&#39;Kish&#39;</span>)])</span></code></pre></div>
<pre><code>## Joining with `by = join_by(rph_ID, Fact_Hog)`</code></pre>
<p>A continuación, se comparan los resultados de los datos originales con los tratados en lo que refiere al cálculo de indicadores principales con desagregaciones.</p>
<p>Para ello, primero se establece el diseño complejo para personas y para hogares.</p>
<div class="example">
<p><span id="exm:bloque75nbm" class="example"><strong>Bloque 11.74  </strong></span>Declarar diseño complejo</p>
</div>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="caso-de-estudio.html#cb333-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generamos un conjunto de datos tratados donde solo tenemos las filas del informante Kish</span></span>
<span id="cb333-2"><a href="caso-de-estudio.html#cb333-2" aria-hidden="true" tabindex="-1"></a>fileTratada_kish <span class="ot">&lt;-</span> fileTratada[fileTratada<span class="sc">$</span>Kish  <span class="sc">%in%</span> <span class="dv">1</span>,]</span>
<span id="cb333-3"><a href="caso-de-estudio.html#cb333-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-4"><a href="caso-de-estudio.html#cb333-4" aria-hidden="true" tabindex="-1"></a><span class="co"># fijamos las opciones del diseño complejo</span></span>
<span id="cb333-5"><a href="caso-de-estudio.html#cb333-5" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">survey.lonely.psu =</span> <span class="st">&quot;certainty&quot;</span>)</span>
<span id="cb333-6"><a href="caso-de-estudio.html#cb333-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-7"><a href="caso-de-estudio.html#cb333-7" aria-hidden="true" tabindex="-1"></a><span class="co"># generamos el diseño complejo para el factor de expansión de personas</span></span>
<span id="cb333-8"><a href="caso-de-estudio.html#cb333-8" aria-hidden="true" tabindex="-1"></a>dc_pers_trat <span class="ot">&lt;-</span> <span class="fu">svydesign</span>(<span class="at">ids =</span> <span class="sc">~</span>Conglomerado, </span>
<span id="cb333-9"><a href="caso-de-estudio.html#cb333-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">strata =</span> <span class="sc">~</span>VarStrat, </span>
<span id="cb333-10"><a href="caso-de-estudio.html#cb333-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> fileTratada_kish,</span>
<span id="cb333-11"><a href="caso-de-estudio.html#cb333-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">weights =</span> <span class="sc">~</span>Fact_Pers)</span>
<span id="cb333-12"><a href="caso-de-estudio.html#cb333-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-13"><a href="caso-de-estudio.html#cb333-13" aria-hidden="true" tabindex="-1"></a><span class="co"># generamos el diseño complejo para el factor de expansión de hogares</span></span>
<span id="cb333-14"><a href="caso-de-estudio.html#cb333-14" aria-hidden="true" tabindex="-1"></a>dc_hog_trat <span class="ot">&lt;-</span> <span class="fu">svydesign</span>(<span class="at">ids =</span> <span class="sc">~</span>Conglomerado, </span>
<span id="cb333-15"><a href="caso-de-estudio.html#cb333-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">strata =</span> <span class="sc">~</span>VarStrat, </span>
<span id="cb333-16"><a href="caso-de-estudio.html#cb333-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> fileTratada_kish,</span>
<span id="cb333-17"><a href="caso-de-estudio.html#cb333-17" aria-hidden="true" tabindex="-1"></a>                    <span class="at">weights =</span> <span class="sc">~</span>Fact_Hog)</span></code></pre></div>
<p>Previamente, calculamos estas desagregaciones con los datos no tratados. A continuación, se recalculan con los datos tratados y se comparan los resultados calculando la diferencia. Esta se visualiza a través de la función <code>summary()</code>.</p>
<p>Victimización agregada de delitos consumados, desagregado por región:</p>
<div class="example">
<p><span id="exm:bloque76nbm" class="example"><strong>Bloque 11.75  </strong></span>Estimar Victimización Agregada a nivel regional, con estandar de calidad INE</p>
</div>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="caso-de-estudio.html#cb334-1" aria-hidden="true" tabindex="-1"></a>insumos_prop <span class="ot">&lt;-</span> <span class="fu">create_prop</span>(<span class="at">var =</span> <span class="st">&#39;VA_DC&#39;</span>, </span>
<span id="cb334-2"><a href="caso-de-estudio.html#cb334-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">domains =</span> <span class="st">&#39;enc_region&#39;</span>, </span>
<span id="cb334-3"><a href="caso-de-estudio.html#cb334-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">design =</span>  dc_hog_trat)</span>
<span id="cb334-4"><a href="caso-de-estudio.html#cb334-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb334-5"><a href="caso-de-estudio.html#cb334-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb334-6"><a href="caso-de-estudio.html#cb334-6" aria-hidden="true" tabindex="-1"></a>VA_DC_REG_TRAT <span class="ot">&lt;-</span> <span class="fu">assess</span>(insumos_prop)</span>
<span id="cb334-7"><a href="caso-de-estudio.html#cb334-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb334-8"><a href="caso-de-estudio.html#cb334-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(VA_DC_REG_PRE<span class="sc">$</span>objetivo <span class="sc">-</span> VA_DC_REG_TRAT<span class="sc">$</span>objetivo)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
## </code></pre>
<p>Victimización personal de delitos consumados, desagregado por sexo:</p>
<div class="example">
<p><span id="exm:bloque77nbm" class="example"><strong>Bloque 11.76  </strong></span>Estimar Victimización Personal según sexo, con estandar de calidad INE</p>
</div>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="caso-de-estudio.html#cb336-1" aria-hidden="true" tabindex="-1"></a>insumos_prop <span class="ot">&lt;-</span> <span class="fu">create_prop</span>(<span class="at">var =</span> <span class="st">&#39;VP_DC&#39;</span>, </span>
<span id="cb336-2"><a href="caso-de-estudio.html#cb336-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">domains =</span> <span class="st">&#39;rph_sexo&#39;</span>, </span>
<span id="cb336-3"><a href="caso-de-estudio.html#cb336-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">design =</span>  dc_pers_trat)</span>
<span id="cb336-4"><a href="caso-de-estudio.html#cb336-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb336-5"><a href="caso-de-estudio.html#cb336-5" aria-hidden="true" tabindex="-1"></a>VP_DC_SEXO_TRAT <span class="ot">&lt;-</span> <span class="fu">assess</span>(insumos_prop)</span>
<span id="cb336-6"><a href="caso-de-estudio.html#cb336-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb336-7"><a href="caso-de-estudio.html#cb336-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(VP_DC_SEXO_PRE<span class="sc">$</span>objetivo <span class="sc">-</span> VP_DC_SEXO_TRAT<span class="sc">$</span>objetivo)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
## </code></pre>
<p>Victimización personal de delitos consumados, desagregado por región:</p>
<div class="example">
<p><span id="exm:bloque78nbm" class="example"><strong>Bloque 11.77  </strong></span>Estimar Victimización Personal a nivel regional, con estandar de calidad INE</p>
</div>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="caso-de-estudio.html#cb338-1" aria-hidden="true" tabindex="-1"></a>insumos_prop <span class="ot">&lt;-</span> <span class="fu">create_prop</span>(<span class="at">var =</span> <span class="st">&#39;VP_DC&#39;</span>, </span>
<span id="cb338-2"><a href="caso-de-estudio.html#cb338-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">domains =</span> <span class="st">&#39;enc_region&#39;</span>, </span>
<span id="cb338-3"><a href="caso-de-estudio.html#cb338-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">design =</span>  dc_pers_trat)</span>
<span id="cb338-4"><a href="caso-de-estudio.html#cb338-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb338-5"><a href="caso-de-estudio.html#cb338-5" aria-hidden="true" tabindex="-1"></a>VP_DC_REG_TRAT <span class="ot">&lt;-</span> <span class="fu">assess</span>(insumos_prop)</span>
<span id="cb338-6"><a href="caso-de-estudio.html#cb338-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb338-7"><a href="caso-de-estudio.html#cb338-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(VP_DC_REG_PRE<span class="sc">$</span>objetivo <span class="sc">-</span> VP_DC_REG_TRAT<span class="sc">$</span>objetivo)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
## </code></pre>
<p>Victimización personal de delitos consumados, desagregado por sexo y región:</p>
<div class="example">
<p><span id="exm:bloque79nbm" class="example"><strong>Bloque 11.78  </strong></span>Estimar Victimización Personal a nivel regional y según sexo, con estandar de calidad INE</p>
</div>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="caso-de-estudio.html#cb340-1" aria-hidden="true" tabindex="-1"></a>insumos_prop <span class="ot">&lt;-</span> <span class="fu">create_prop</span>(<span class="at">var =</span> <span class="st">&#39;VP_DC&#39;</span>, </span>
<span id="cb340-2"><a href="caso-de-estudio.html#cb340-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">domains =</span> <span class="st">&#39;rph_sexo+enc_region&#39;</span>, </span>
<span id="cb340-3"><a href="caso-de-estudio.html#cb340-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">design =</span>  dc_pers_trat)</span>
<span id="cb340-4"><a href="caso-de-estudio.html#cb340-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb340-5"><a href="caso-de-estudio.html#cb340-5" aria-hidden="true" tabindex="-1"></a>VP_DC_REG_SEXO_TRAT <span class="ot">&lt;-</span> <span class="fu">assess</span>(insumos_prop)</span>
<span id="cb340-6"><a href="caso-de-estudio.html#cb340-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb340-7"><a href="caso-de-estudio.html#cb340-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(VP_DC_REG_SEXO_PRE<span class="sc">$</span>objetivo <span class="sc">-</span> VP_DC_REG_SEXO_TRAT<span class="sc">$</span>objetivo)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
## </code></pre>
<p>En resumen, se cumple para todos los casos que no hay diferencias en las estimaciones al calcular con los datos originales y los tratados.</p>
<p>Por último, se evalúa si se mantiene la relación entre la variable de edad y el indicador de Victimización Personal, utilizando las marcas de clase de los tramos etarios presentes en los datos tratados.</p>
<p>Si bien, los modelos obtenidos no son buenos predictores de la victimización, ya que es un fenómeno influenciado por múltiples factores y acá solo se está considerando la edad, si se aprecia que los resultados son similares a los de los datos sin tratar. En particular el coeficiente beta de la variable de edad en el modelo <em>logit</em> de victimización personal es prácticamente el mismo que en los datos no tratados.</p>
<p><strong>Se genera un <code>dataframe</code> “data” para trabajar con el modelo</strong></p>
<p>Primero, se cargan los datos, y se filtran dejando solo al informante Kish.</p>
<div class="example">
<p><span id="exm:bloque80nbm" class="example"><strong>Bloque 11.79  </strong></span>Generar dataframe para modelo</p>
</div>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="caso-de-estudio.html#cb342-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> fileTratada_kish</span></code></pre></div>
<p><strong>Dividir datos en <code>_training_</code> and <code>_testing_</code> sets</strong></p>
<p>Luego, se dividen los datos en sets de training y testing.</p>
<div class="example">
<p><span id="exm:bloque81nbm" class="example"><strong>Bloque 11.80  </strong></span>Dividir datos en <em>training</em> y <em>testing</em> sets</p>
</div>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="caso-de-estudio.html#cb343-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caTools)</span>
<span id="cb343-2"><a href="caso-de-estudio.html#cb343-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2022</span>)</span>
<span id="cb343-3"><a href="caso-de-estudio.html#cb343-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb343-4"><a href="caso-de-estudio.html#cb343-4" aria-hidden="true" tabindex="-1"></a>ids_train <span class="ot">&lt;-</span> <span class="fu">sample</span>(data<span class="sc">$</span>rph_ID, <span class="fu">nrow</span>(data)<span class="sc">/</span><span class="dv">3</span><span class="sc">*</span><span class="dv">2</span>)</span>
<span id="cb343-5"><a href="caso-de-estudio.html#cb343-5" aria-hidden="true" tabindex="-1"></a>training<span class="ot">&lt;-</span> sjlabelled<span class="sc">::</span><span class="fu">remove_all_labels</span>(data[data<span class="sc">$</span>rph_ID <span class="sc">%in%</span> ids_train,])</span>
<span id="cb343-6"><a href="caso-de-estudio.html#cb343-6" aria-hidden="true" tabindex="-1"></a>testing<span class="ot">&lt;-</span> sjlabelled<span class="sc">::</span><span class="fu">remove_all_labels</span>(data[<span class="sc">!</span>data<span class="sc">$</span>rph_ID <span class="sc">%in%</span> ids_train,])</span></code></pre></div>
<p><strong>Construir modelo</strong></p>
<p>Luego, construimos el modelo utilizando la función <code>glm()</code>.</p>
<div class="example">
<p><span id="exm:bloque82nbm" class="example"><strong>Bloque 11.81  </strong></span>Construir modelo</p>
</div>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="caso-de-estudio.html#cb344-1" aria-hidden="true" tabindex="-1"></a>modelo<span class="ot">&lt;-</span><span class="fu">glm</span>(VP_DC<span class="sc">~</span>rph_edad_mc, </span>
<span id="cb344-2"><a href="caso-de-estudio.html#cb344-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">data=</span>training, </span>
<span id="cb344-3"><a href="caso-de-estudio.html#cb344-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb344-4"><a href="caso-de-estudio.html#cb344-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = VP_DC ~ rph_edad_mc, family = &quot;binomial&quot;, data = training)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -0.7857  -0.7670  -0.7317  -0.7004   1.7468  
## 
## Coefficients:
##               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -1.3416201  0.0556848 -24.093  &lt; 2e-16 ***
## rph_edad_mc  0.0036047  0.0008517   4.232 2.31e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 13933  on 12509  degrees of freedom
## Residual deviance: 13915  on 12508  degrees of freedom
## AIC: 13919
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p><strong>Validación de modelo</strong></p>
<p>Luego aplicamos el test de Hosmer Lemeshow para validar el modelo.</p>
<div class="example">
<p><span id="exm:bloque83nbm" class="example"><strong>Bloque 11.82  </strong></span>Validación de modelo</p>
</div>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="caso-de-estudio.html#cb346-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ResourceSelection)</span>
<span id="cb346-2"><a href="caso-de-estudio.html#cb346-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hoslem.test</span>(modelo<span class="sc">$</span>y,<span class="fu">fitted</span>(modelo),<span class="at">g=</span><span class="dv">10</span>) <span class="co"># Test de Hosmer Lemeshow</span></span></code></pre></div>
<pre><code>## 
##  Hosmer and Lemeshow goodness of fit (GOF) test
## 
## data:  modelo$y, fitted(modelo)
## X-squared = 156.47, df = 6, p-value &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="caso-de-estudio.html#cb348-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb348-2"><a href="caso-de-estudio.html#cb348-2" aria-hidden="true" tabindex="-1"></a>indiceC.trainig<span class="ot">&lt;-</span><span class="fu">roc</span>(modelo<span class="sc">$</span>y,<span class="fu">fitted</span>(modelo))     <span class="co"># Curva ROC</span></span></code></pre></div>
<pre><code>## Setting levels: control = 0, case = 1</code></pre>
<pre><code>## Setting direction: controls &lt; cases</code></pre>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="caso-de-estudio.html#cb351-1" aria-hidden="true" tabindex="-1"></a>indiceC.trainig</span></code></pre></div>
<pre><code>## 
## Call:
## roc.default(response = modelo$y, predictor = fitted(modelo))
## 
## Data: fitted(modelo) in 9444 controls (modelo$y 0) &lt; 3066 cases (modelo$y 1).
## Area under the curve: 0.5302</code></pre>
<p><strong>Punto de corte óptimo</strong></p>
<p>Se calcula el punto de corte óptimo utilizando la función <code>coords()</code>.</p>
<div class="example">
<p><span id="exm:bloque84nbm" class="example"><strong>Bloque 11.83  </strong></span>Calcular punto de corte óptimo</p>
</div>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="caso-de-estudio.html#cb353-1" aria-hidden="true" tabindex="-1"></a>ptocorteop.training<span class="ot">&lt;-</span><span class="fu">coords</span>(indiceC.trainig,<span class="at">x=</span><span class="st">&quot;best&quot;</span>,</span>
<span id="cb353-2"><a href="caso-de-estudio.html#cb353-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">input=</span><span class="st">&quot;threshold&quot;</span>,</span>
<span id="cb353-3"><a href="caso-de-estudio.html#cb353-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">best.method=</span><span class="st">&quot;youden&quot;</span>)</span>
<span id="cb353-4"><a href="caso-de-estudio.html#cb353-4" aria-hidden="true" tabindex="-1"></a>ptocorteop.training</span></code></pre></div>
<pre><code>##   threshold specificity sensitivity
## 1 0.2636494   0.8235917   0.2524462</code></pre>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="caso-de-estudio.html#cb355-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ROCR)</span>
<span id="cb355-2"><a href="caso-de-estudio.html#cb355-2" aria-hidden="true" tabindex="-1"></a>ROC.training<span class="ot">&lt;-</span><span class="fu">performance</span>(<span class="at">prediction.obj =</span> <span class="fu">prediction</span>(<span class="at">predictions =</span> <span class="fu">fitted</span>(modelo),</span>
<span id="cb355-3"><a href="caso-de-estudio.html#cb355-3" aria-hidden="true" tabindex="-1"></a>                                                      <span class="at">labels =</span> <span class="fu">as.factor</span>(modelo<span class="sc">$</span>y)),</span>
<span id="cb355-4"><a href="caso-de-estudio.html#cb355-4" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;tpr&quot;</span>,</span>
<span id="cb355-5"><a href="caso-de-estudio.html#cb355-5" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;fpr&quot;</span>)</span></code></pre></div>
<p>Luego, visualizamos el punto de corte óptimo utilizando la función <code>plot()</code>.</p>
<div class="example">
<p><span id="exm:bloque85nbm" class="example"><strong>Bloque 11.84  </strong></span>Visualizar punto de corte óptimo</p>
</div>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="caso-de-estudio.html#cb356-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ROC.training, <span class="at">colorize=</span><span class="cn">TRUE</span>, <span class="at">print.cutoffs.at=</span><span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="at">by=</span><span class="fl">0.1</span>))</span>
<span id="cb356-2"><a href="caso-de-estudio.html#cb356-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span><span class="dv">0</span>,<span class="at">b=</span><span class="dv">1</span>)</span>
<span id="cb356-3"><a href="caso-de-estudio.html#cb356-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>ptocorteop.training<span class="sc">$</span>threshold,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-160"></span>
<img src="bookdown-demo_files/figure-html/unnamed-chunk-160-1.png" alt="Punto de corte óptimo con datos tratados" width="90%" />
<p class="caption">
Figura 11.3: Punto de corte óptimo con datos tratados
</p>
</div>
<p><strong>Predicciones y matriz de confusión</strong></p>
<p>Se realizan predicciones y se genera una matriz de confusión.</p>
<div class="example">
<p><span id="exm:bloque86nbm" class="example"><strong>Bloque 11.85  </strong></span>Predicciones y matriz de confusión</p>
</div>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="caso-de-estudio.html#cb357-1" aria-hidden="true" tabindex="-1"></a>pred.training<span class="ot">&lt;-</span><span class="fu">predict</span>(modelo, <span class="at">data=</span>training, <span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span>
<span id="cb357-2"><a href="caso-de-estudio.html#cb357-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="at">ActualValue=</span>training<span class="sc">$</span>VP_DC, </span>
<span id="cb357-3"><a href="caso-de-estudio.html#cb357-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">PredictValue=</span>pred.training<span class="sc">&gt;</span>ptocorteop.training<span class="sc">$</span>threshold)</span></code></pre></div>
<pre><code>##            PredictValue
## ActualValue FALSE TRUE
##           0  7778 1666
##           1  2292  774</code></pre>
<p>A continuación, se continua la evaluación del modelo con datos de prueba.</p>
<p><strong>Validación de modelo (con datos de prueba)</strong></p>
<p>Aplicamos nuevamente la validación con el test de Hosmer Lemeshow, esta vez con los datos de prueba.</p>
<div class="example">
<p><span id="exm:bloque87nbm" class="example"><strong>Bloque 11.86  </strong></span>Validación de modelo con datos de prueba</p>
</div>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="caso-de-estudio.html#cb359-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hoslem.test</span>(testing<span class="sc">$</span>VP_DC,<span class="fu">predict</span>(modelo,<span class="at">newdata=</span>testing,<span class="at">type=</span><span class="st">&quot;response&quot;</span>),<span class="at">g=</span><span class="dv">5</span>)   <span class="co"># Test de Hosmer Lemeshow</span></span></code></pre></div>
<pre><code>## 
##  Hosmer and Lemeshow goodness of fit (GOF) test
## 
## data:  testing$VP_DC, predict(modelo, newdata = testing, type = &quot;response&quot;)
## X-squared = 66.467, df = 3, p-value = 2.431e-14</code></pre>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="caso-de-estudio.html#cb361-1" aria-hidden="true" tabindex="-1"></a>indiceC.testing<span class="ot">=</span><span class="fu">roc</span>(testing<span class="sc">$</span>VP_DC,<span class="fu">predict</span>(modelo,<span class="at">newdata=</span>testing,<span class="at">type=</span><span class="st">&quot;response&quot;</span>)) <span class="co"># Curva ROC</span></span></code></pre></div>
<pre><code>## Setting levels: control = 0, case = 1</code></pre>
<pre><code>## Setting direction: controls &lt; cases</code></pre>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="caso-de-estudio.html#cb364-1" aria-hidden="true" tabindex="-1"></a>indiceC.testing</span></code></pre></div>
<pre><code>## 
## Call:
## roc.default(response = testing$VP_DC, predictor = predict(modelo,     newdata = testing, type = &quot;response&quot;))
## 
## Data: predict(modelo, newdata = testing, type = &quot;response&quot;) in 4666 controls (testing$VP_DC 0) &lt; 1590 cases (testing$VP_DC 1).
## Area under the curve: 0.5243</code></pre>
<p><strong>Punto de corte óptimo (con datos de prueba)</strong></p>
<p>Se calcula el punto de corte óptimo utilizando la función <code>coords()</code>.</p>
<div class="example">
<p><span id="exm:bloque88nbm" class="example"><strong>Bloque 11.87  </strong></span>Calcular de corte óptimo con datos de prueba</p>
</div>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="caso-de-estudio.html#cb366-1" aria-hidden="true" tabindex="-1"></a>ptocorteop.testing<span class="ot">&lt;-</span><span class="fu">coords</span>(indiceC.testing,<span class="at">x=</span><span class="st">&quot;best&quot;</span>,<span class="at">input=</span><span class="st">&quot;threshold&quot;</span>,<span class="at">best.method=</span><span class="st">&quot;youden&quot;</span>)</span>
<span id="cb366-2"><a href="caso-de-estudio.html#cb366-2" aria-hidden="true" tabindex="-1"></a>ptocorteop.testing</span></code></pre></div>
<pre><code>##   threshold specificity sensitivity
## 1 0.2636494   0.8317617   0.2440252</code></pre>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="caso-de-estudio.html#cb368-1" aria-hidden="true" tabindex="-1"></a>ROC.testing<span class="ot">&lt;-</span><span class="fu">performance</span>(<span class="fu">prediction</span>(<span class="fu">predict</span>(modelo,<span class="at">newdata=</span>testing,<span class="at">type=</span><span class="st">&quot;response&quot;</span>),</span>
<span id="cb368-2"><a href="caso-de-estudio.html#cb368-2" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">as.factor</span>(testing<span class="sc">$</span>VP_DC)),<span class="st">&quot;tpr&quot;</span>,<span class="st">&quot;fpr&quot;</span>)</span></code></pre></div>
<p>Luego, visualizamos el punto de corte óptimo utilizando la función <code>plot()</code>.</p>
<div class="example">
<p><span id="exm:bloque89nbm" class="example"><strong>Bloque 11.88  </strong></span>Visualizar de corte óptimo con datos de prueba</p>
</div>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="caso-de-estudio.html#cb369-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ROC.testing, <span class="at">colorize=</span><span class="cn">TRUE</span>, <span class="at">print.cutoffs.at=</span><span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="at">by=</span><span class="fl">0.1</span>))</span>
<span id="cb369-2"><a href="caso-de-estudio.html#cb369-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span><span class="dv">0</span>,<span class="at">b=</span><span class="dv">1</span>)</span>
<span id="cb369-3"><a href="caso-de-estudio.html#cb369-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>ptocorteop.testing<span class="sc">$</span>threshold,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-164"></span>
<img src="bookdown-demo_files/figure-html/unnamed-chunk-164-1.png" alt="Punto de corte óptimo con datos de prueba a partir de datos tratados" width="90%" />
<p class="caption">
Figura 11.4: Punto de corte óptimo con datos de prueba a partir de datos tratados
</p>
</div>
<p><strong>Predicciones y matriz de confusión (con datos de prueba)</strong></p>
<p>Se realizan predicciones y se genera una matriz de confusión.</p>
<div class="example">
<p><span id="exm:bloque90nbm" class="example"><strong>Bloque 11.89  </strong></span>Predicciones y matriz de confusión con datos de prueba</p>
</div>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="caso-de-estudio.html#cb370-1" aria-hidden="true" tabindex="-1"></a>pred.testing<span class="ot">&lt;-</span><span class="fu">predict</span>(modelo, testing, <span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span>
<span id="cb370-2"><a href="caso-de-estudio.html#cb370-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="at">ActualValue=</span>testing<span class="sc">$</span>VP_DC, <span class="at">PredictValue=</span>pred.testing<span class="sc">&gt;</span>ptocorteop.testing<span class="sc">$</span>threshold)</span></code></pre></div>
<pre><code>##            PredictValue
## ActualValue FALSE TRUE
##           0  3881  785
##           1  1202  388</code></pre>
<p><strong>Compara área bajo la curva, umbral, sensibilidad y especificidad</strong></p>
<p>Finalmente, comparamos el área bajo la curva, umbral, sensibilidad y especificidad, a partir de los resultados del modelo con los datos de entrenamiento y con los datos de prueba.</p>
<div class="example">
<p><span id="exm:bloque91nbm" class="example"><strong>Bloque 11.90  </strong></span>Comparar área bajo la curva, umbral, sensibilidad y especificidad</p>
</div>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb372-1"><a href="caso-de-estudio.html#cb372-1" aria-hidden="true" tabindex="-1"></a>auc    <span class="ot">&lt;-</span>indiceC.trainig<span class="sc">$</span>auc              <span class="sc">-</span> indiceC.testing<span class="sc">$</span>auc</span>
<span id="cb372-2"><a href="caso-de-estudio.html#cb372-2" aria-hidden="true" tabindex="-1"></a>corte  <span class="ot">&lt;-</span>ptocorteop.training<span class="sc">$</span>threshold    <span class="sc">-</span> ptocorteop.testing<span class="sc">$</span>threshold</span>
<span id="cb372-3"><a href="caso-de-estudio.html#cb372-3" aria-hidden="true" tabindex="-1"></a>sens   <span class="ot">&lt;-</span> ptocorteop.training<span class="sc">$</span>sensitivity <span class="sc">-</span> ptocorteop.testing<span class="sc">$</span>sensitivity</span>
<span id="cb372-4"><a href="caso-de-estudio.html#cb372-4" aria-hidden="true" tabindex="-1"></a>spe    <span class="ot">&lt;-</span> ptocorteop.training<span class="sc">$</span>specificity <span class="sc">-</span> ptocorteop.testing<span class="sc">$</span>specificity</span></code></pre></div>
<p>La siguiente tabla muestra las estimaciones del coeficiente beta de la variable independiente de edad en los modelos, para los datos originales y los datos tratados. Se observa que ambas estimaciones son equivalentes, sin diferencias estadísticamente significativas a partir de su intervalo de confianza:</p>
<table>
<thead>
<tr class="header">
<th>Datos</th>
<th>Estimación</th>
<th>Lim. Inf.</th>
<th>Lim. Sup.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Originales</td>
<td>0,0035</td>
<td>0,0020</td>
<td>0,0050</td>
</tr>
<tr class="even">
<td>Tratados</td>
<td>0,0036</td>
<td>0,0019</td>
<td>0,0053</td>
</tr>
</tbody>
</table>
<p>En suma, se observa que se mantienen las propiedades estadísticas priorizadas de la base de datos, por lo que cumple con las condiciones para su liberación.</p>
</div>
</div>
</div>
<div id="paso-seis-generar-reportes-y-liberar-datos" class="section level2 hasAnchor" number="11.6">
<h2><span class="header-section-number">11.6</span> Paso Seis: Generar Reportes y Liberar Datos<a href="caso-de-estudio.html#paso-seis-generar-reportes-y-liberar-datos" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="reportes" class="section level3 hasAnchor" number="11.6.1">
<h3><span class="header-section-number">11.6.1</span> Reportes<a href="caso-de-estudio.html#reportes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Al realizar un ejercicio de anonimización como el recién expuesto, se debe elaborar un reporte que documente el proceso de anonimización, con sus antecedentes y resultados. Para ello, debe basarse en el modelo de reporte de anonimización descrito en la guía de anonimización.</p>
</div>
<div id="liberación-de-datos" class="section level3 hasAnchor" number="11.6.2">
<h3><span class="header-section-number">11.6.2</span> Liberación de datos<a href="caso-de-estudio.html#liberación-de-datos" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A partir del objeto <code>file</code>, que son los datos originales, se genera un objeto <code>data.frame</code> para su exportación como archivo de datos que será liberado.</p>
<p>Primero se verifica que el orden de registros sea idéntico entra datos originales y tratados. Esto permite sobre-escribir columnas completas, sabiendo que los registros coincidirán bien. En este caso, es importante usar el folio que corresponde a persona, ya que cada fila es una persona (en contraposición al folio de viviendas que cubre varias filas dependiendo de las personas que las componen).</p>
<div class="example">
<p><span id="exm:bloque92nbm" class="example"><strong>Bloque 11.91  </strong></span>Verificar coincidencia de folios</p>
</div>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="caso-de-estudio.html#cb373-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Se espera que esta función regrese TRUE</span></span>
<span id="cb373-2"><a href="caso-de-estudio.html#cb373-2" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(file<span class="sc">$</span>rph_ID <span class="sc">==</span> fileTratada<span class="sc">$</span>rph_ID)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>Luego, se reemplazan variables tratadas en datos originales y se eliminan las variables que están de más. Estas son, comuna y razón de inactividad, ya que esta última permitiría deshacer la recodificación que se realizó en la variable consolidada de situación ocupacional.</p>
<div class="example">
<p><span id="exm:bloque93nbm" class="example"><strong>Bloque 11.92  </strong></span>Eliminar variables</p>
</div>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb375-1"><a href="caso-de-estudio.html#cb375-1" aria-hidden="true" tabindex="-1"></a>file<span class="sc">$</span>enc_rpc <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb375-2"><a href="caso-de-estudio.html#cb375-2" aria-hidden="true" tabindex="-1"></a>file<span class="sc">$</span>rph_p14 <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
<p>Luego, se reemplazan variables tratadas de edad, identidad de género, pertenencia indígena y nacionalidad.</p>
<div class="example">
<p><span id="exm:bloque94nbm" class="example"><strong>Bloque 11.93  </strong></span>Reemplazar variables originales por variables tratadas</p>
</div>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="caso-de-estudio.html#cb376-1" aria-hidden="true" tabindex="-1"></a>file<span class="sc">$</span>rph_edad <span class="ot">&lt;-</span> fileTratada<span class="sc">$</span>rph_edad</span>
<span id="cb376-2"><a href="caso-de-estudio.html#cb376-2" aria-hidden="true" tabindex="-1"></a>file<span class="sc">$</span>rph_idgen <span class="ot">&lt;-</span> fileTratada<span class="sc">$</span>rph_idgen</span>
<span id="cb376-3"><a href="caso-de-estudio.html#cb376-3" aria-hidden="true" tabindex="-1"></a>file<span class="sc">$</span>rph_pertenencia_indigena <span class="ot">&lt;-</span> fileTratada<span class="sc">$</span>rph_pertenencia_indigena</span>
<span id="cb376-4"><a href="caso-de-estudio.html#cb376-4" aria-hidden="true" tabindex="-1"></a>file<span class="sc">$</span>rph_nacionalidad <span class="ot">&lt;-</span> fileTratada<span class="sc">$</span>rph_nacionalidad</span></code></pre></div>
<p>Se eliminan los valores de rph_p9 a rph_p13 para los casos suprimidos en situación ocupacional</p>
<div class="example">
<p><span id="exm:bloque95nbm" class="example"><strong>Bloque 11.94  </strong></span>Suprimir valores</p>
</div>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb377-1"><a href="caso-de-estudio.html#cb377-1" aria-hidden="true" tabindex="-1"></a><span class="co"># se eliminan los valores que corresponden</span></span>
<span id="cb377-2"><a href="caso-de-estudio.html#cb377-2" aria-hidden="true" tabindex="-1"></a>file<span class="sc">$</span>rph_p9[<span class="fu">is.na</span>(fileTratada<span class="sc">$</span>rph_situacion_ocupacional)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb377-3"><a href="caso-de-estudio.html#cb377-3" aria-hidden="true" tabindex="-1"></a>file<span class="sc">$</span>rph_p10[<span class="fu">is.na</span>(fileTratada<span class="sc">$</span>rph_situacion_ocupacional)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb377-4"><a href="caso-de-estudio.html#cb377-4" aria-hidden="true" tabindex="-1"></a>file<span class="sc">$</span>rph_p11[<span class="fu">is.na</span>(fileTratada<span class="sc">$</span>rph_situacion_ocupacional)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb377-5"><a href="caso-de-estudio.html#cb377-5" aria-hidden="true" tabindex="-1"></a>file<span class="sc">$</span>rph_p12[<span class="fu">is.na</span>(fileTratada<span class="sc">$</span>rph_situacion_ocupacional)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb377-6"><a href="caso-de-estudio.html#cb377-6" aria-hidden="true" tabindex="-1"></a>file<span class="sc">$</span>rph_p13[<span class="fu">is.na</span>(fileTratada<span class="sc">$</span>rph_situacion_ocupacional)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb377-7"><a href="caso-de-estudio.html#cb377-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb377-8"><a href="caso-de-estudio.html#cb377-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Luego eliminamos situación ocupacional ya que no se usará más</span></span>
<span id="cb377-9"><a href="caso-de-estudio.html#cb377-9" aria-hidden="true" tabindex="-1"></a>file<span class="sc">$</span>rph_situacion_ocupacional <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
<p>Luego, se elimina los valores de rph_migración que son acompañados de un NA en nacionalidad, ya que sería un error de flujo de la encuesta mantenerlos.</p>
<div class="example">
<p><span id="exm:bloque96nbm" class="example"><strong>Bloque 11.95  </strong></span>Suprimir valores en nacionalidad</p>
</div>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="caso-de-estudio.html#cb378-1" aria-hidden="true" tabindex="-1"></a>file<span class="sc">$</span>rph_migracion[<span class="fu">is.na</span>(file<span class="sc">$</span>rph_nacionalidad)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span></code></pre></div>
<p>Por último, se exporta archivo de datos ocupando la librería <code>haven</code>.</p>
<div class="example">
<p><span id="exm:bloque97nbm" class="example"><strong>Bloque 11.96  </strong></span>Ejemplo de código para exportar datos anonimizados</p>
</div>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb379-1"><a href="caso-de-estudio.html#cb379-1" aria-hidden="true" tabindex="-1"></a><span class="co">#haven::write_sav(file, &#39;ENUSC2020_anonimizada.sav&#39;)</span></span></code></pre></div>
</div>
<div id="anexo-tablas-de-indicadores-con-desagregaciones" class="section level3 hasAnchor" number="11.6.3">
<h3><span class="header-section-number">11.6.3</span> Anexo : Tablas de indicadores con desagregaciones<a href="caso-de-estudio.html#anexo-tablas-de-indicadores-con-desagregaciones" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Se deja como anexo los tabulados con datos tratados y no tratados por si se considera necesario compararlos de forma manual.</p>
<div class="example">
<p><span id="exm:bloque98nbm" class="example"><strong>Bloque 11.97  </strong></span>Ejemplo de código para exportar datos de indicadores con datos tratados y no tratados</p>
</div>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="caso-de-estudio.html#cb380-1" aria-hidden="true" tabindex="-1"></a><span class="co">#anexo &lt;- list(&#39;P1 Regional Original&#39; = P1_REG_PRE,</span></span>
<span id="cb380-2"><a href="caso-de-estudio.html#cb380-2" aria-hidden="true" tabindex="-1"></a><span class="co">#              &#39;P1 Regional Tratado&#39; = P1_REG_TRAT,</span></span>
<span id="cb380-3"><a href="caso-de-estudio.html#cb380-3" aria-hidden="true" tabindex="-1"></a><span class="co">#              &#39;P1 Sexo Original&#39; = P1_SEXO_PRE,</span></span>
<span id="cb380-4"><a href="caso-de-estudio.html#cb380-4" aria-hidden="true" tabindex="-1"></a><span class="co">#              &#39;P1 Sexo Tratado&#39; = P1_SEXO_TRAT,</span></span>
<span id="cb380-5"><a href="caso-de-estudio.html#cb380-5" aria-hidden="true" tabindex="-1"></a><span class="co">#              &#39;P1 Regional Sexo Original&#39; = P1_REG_SEXO_PRE,</span></span>
<span id="cb380-6"><a href="caso-de-estudio.html#cb380-6" aria-hidden="true" tabindex="-1"></a><span class="co">#              &#39;P1 Regional Sexo Tratado&#39; = P1_REG_SEXO_TRAT,</span></span>
<span id="cb380-7"><a href="caso-de-estudio.html#cb380-7" aria-hidden="true" tabindex="-1"></a><span class="co">#              &#39;Vict. Pers. Regional Original&#39; = VP_DC_REG_PRE,</span></span>
<span id="cb380-8"><a href="caso-de-estudio.html#cb380-8" aria-hidden="true" tabindex="-1"></a><span class="co">#              &#39;Vict. Pers. Regional Tratado&#39; = VP_DC_REG_TRAT,</span></span>
<span id="cb380-9"><a href="caso-de-estudio.html#cb380-9" aria-hidden="true" tabindex="-1"></a><span class="co">#              &#39;Vict. Pers. Sexo Original&#39; = VP_DC_SEXO_PRE,</span></span>
<span id="cb380-10"><a href="caso-de-estudio.html#cb380-10" aria-hidden="true" tabindex="-1"></a><span class="co">#              &#39;Vict. Pers. Sexo Tratado&#39; = VP_DC_SEXO_TRAT,</span></span>
<span id="cb380-11"><a href="caso-de-estudio.html#cb380-11" aria-hidden="true" tabindex="-1"></a><span class="co">#              &#39;Vict. Pers. Regional Sexo Original&#39; = VP_DC_REG_SEXO_PRE,</span></span>
<span id="cb380-12"><a href="caso-de-estudio.html#cb380-12" aria-hidden="true" tabindex="-1"></a><span class="co">#              &#39;Vict. Pers. Regional Sexo Tratado&#39; = VP_DC_REG_SEXO_TRAT,</span></span>
<span id="cb380-13"><a href="caso-de-estudio.html#cb380-13" aria-hidden="true" tabindex="-1"></a><span class="co">#              &#39;Vict. Agr. Regional Original&#39; = VA_DC_REG_PRE,</span></span>
<span id="cb380-14"><a href="caso-de-estudio.html#cb380-14" aria-hidden="true" tabindex="-1"></a><span class="co">#              &#39;Vict. Agr. Regional Tratado&#39; = VA_DC_REG_TRAT)</span></span>
<span id="cb380-15"><a href="caso-de-estudio.html#cb380-15" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb380-16"><a href="caso-de-estudio.html#cb380-16" aria-hidden="true" tabindex="-1"></a><span class="co">#openxlsx::write.xlsx(anexo, &quot;Anexo_Medicion_Utilidad.xlsx&quot;)</span></span></code></pre></div>
</div>
</div>
</div>
<h3>Referencias<a href="referencias-1.html#referencias-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-manualbdenusc" class="csl-entry">
Instituto Nacional de Estadísticas de Chile. 2021a. <span>“17° Encuesta Nacional Urbana de Seguridad Ciudadana 2020. Manual de Usuario de la Base de Datos.”</span> <a href="https://www.ine.gob.cl/docs/default-source/seguridad-ciudadana/manuales/2020/manual-de-usuario-bbdd-enusc-17-2020.pdf">https://www.ine.gob.cl/docs/default-source/seguridad-ciudadana/manuales/2020/manual-de-usuario-bbdd-enusc-17-2020.pdf</a>.
</div>
<div id="ref-manualsdcine" class="csl-entry">
———. 2021b. <span>“Manual de Procedimiento Subproceso "Aplicar Control a la Divulgación".”</span> <a href="https://inechile.sharepoint.com/sites/Intranet/departamentodegestionestrategica/Mprocesos/DocumentosNegocio/Rex%20aprueba%20Manual%20de%20procedimiento%20Aplicar%20control%20a%20la%20divulgaci%C3%B3n.pdf">https://inechile.sharepoint.com/sites/Intranet/departamentodegestionestrategica/Mprocesos/DocumentosNegocio/Rex%20aprueba%20Manual%20de%20procedimiento%20Aplicar%20control%20a%20la%20divulgaci%C3%B3n.pdf</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="proceso-control-a-la-divulgación-estadística-sdc-ine-2021.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="taller-sdc-video.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/sdcchile/tallersdc/edit/main/07-caso_estudio.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/sdcchile/tallersdc/blob/main/07-caso_estudio.Rmd",
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
